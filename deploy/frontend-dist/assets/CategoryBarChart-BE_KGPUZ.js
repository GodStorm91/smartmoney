import{j as e}from"./vendor-tanstack-CNAyyoyW.js";import{r as t}from"./vendor-react-Bx4JnVfy.js";import{l as a,a0 as r,a8 as n,U as s,c as o}from"./index-CL4Qiyvp.js";import{u as i}from"./vendor-i18n-BrrOrGm_.js";import{R as l,g as c,X as d,Y as m,T as x,B as h,f as g,e as u}from"./vendor-recharts-BrNIwK9z.js";import{x as p,T as j,w as y}from"./vendor-icons-BP-EQ_TG.js";import"./vendor-date-BkGg5e1q.js";const f=["#4CAF50","#2196F3","#FF9800","#9C27B0","#F44336","#00BCD4","#FFEB3B","#795548","#607D8B"];function v({changePercent:t}){if(null==t)return null;const a=t>0,r=Math.abs(t)>=20;return 0===t?e.jsxs("span",{className:"inline-flex items-center gap-0.5 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx(p,{className:"w-3 h-3"}),e.jsx("span",{children:"0%"})]}):e.jsxs("span",{className:o("inline-flex items-center gap-0.5 text-xs font-medium",a?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400",r&&"font-bold"),children:[a?e.jsx(j,{className:"w-3 h-3"}):e.jsx(y,{className:"w-3 h-3"}),e.jsxs("span",{children:[a?"+":"",t.toFixed(0),"%"]})]})}function b({data:p}){const{t:j}=i("common"),{currency:y}=a(),{data:b}=r(),{resolvedTheme:k}=n(),w="dark"===k,[N,B]=t.useState(!1),C=w?"#1e1e2e":"#fff",F=w?"#45475a":"#E5E7EB",E=w?"#cdd6f4":"#374151",S=p.reduce((e,t)=>e+t.amount,0),A=[...p].sort((e,t)=>t.amount-e.amount),$=(()=>{if(A.length<=7||N)return A.map((e,t)=>({...e,percentage:S>0?e.amount/S*100:0,color:f[t%f.length]}));const e=A.slice(0,7),t=A.slice(7),a=t.reduce((e,t)=>e+t.amount,0),r=e.map((e,t)=>({...e,percentage:S>0?e.amount/S*100:0,color:f[t%f.length]}));return t.length>0&&r.push({category:`${j("analytics.otherCategories")} (${t.length})`,amount:a,percentage:S>0?a/S*100:0,color:"#9E9E9E",isOther:!0,otherCount:t.length}),r})(),z=A.length>7,D=Math.max(200,32*$.length);return e.jsxs("div",{className:"w-full",children:[e.jsx(l,{width:"100%",height:D,children:e.jsxs(c,{data:$,layout:"vertical",margin:{top:5,right:60,left:0,bottom:5},children:[e.jsx(d,{type:"number",hide:!0,domain:[0,100]}),e.jsx(m,{type:"category",dataKey:"category",width:100,tick:{fill:E,fontSize:12},axisLine:!1,tickLine:!1}),e.jsx(x,{contentStyle:{backgroundColor:C,border:`1px solid ${F}`,borderRadius:"8px",fontSize:"14px",color:E},content:({active:t,payload:a})=>{if(!t||!(null==a?void 0:a[0]))return null;const r=a[0].payload,n=null!==r.change_percent&&void 0!==r.change_percent;return e.jsxs("div",{className:"p-3 rounded-lg shadow-lg",style:{backgroundColor:C,border:`1px solid ${F}`},children:[e.jsx("p",{className:"font-medium mb-1",children:r.category}),e.jsx("p",{className:"text-sm",children:s(r.amount,y,(null==b?void 0:b.rates)||{},!1)}),n&&e.jsxs("div",{className:"mt-1 pt-1 border-t border-gray-200 dark:border-gray-600",children:[e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[j("analytics.vsPrevious"),": "]}),e.jsx(v,{changePercent:r.change_percent})]})]})}}),e.jsxs(h,{dataKey:"percentage",radius:[0,4,4,0],maxBarSize:24,isAnimationActive:!0,animationBegin:0,animationDuration:800,animationEasing:"ease-out",children:[$.map((t,a)=>e.jsx(g,{fill:t.color},`cell-${a}`)),e.jsx(u,{dataKey:"percentage",content:t=>{const{x:a,y:r,width:n,height:s,value:o}=t;return e.jsxs("text",{x:a+n+8,y:r+s/2,fill:E,textAnchor:"start",dominantBaseline:"middle",fontSize:12,children:[o.toFixed(1),"%"]})}})]})]})}),z&&e.jsx("button",{onClick:()=>B(!N),className:o("w-full mt-2 py-2 px-4 text-sm font-medium rounded-lg transition-colors","text-primary-600 dark:text-primary-400","hover:bg-primary-50 dark:hover:bg-primary-900/20"),children:N?j("analytics.showLessCategories"):j("analytics.showAllCategories",{count:A.length})})]})}export{b as CategoryBarChart};

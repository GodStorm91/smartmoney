import{l as te,H as A,u as B,J as ne,r as b,D as J,a4 as O,j as e,C as U,F as $,B as P,P as Ye,m as C,T as Pe,g as ce,X as Re,y as fe,I as Q,ai as Ve,aj as ue,ak as Xe,al as Ae,R as Je,am as Ie,an as Ze,ao as et,ap as tt,aq as at,ar as be,as as ve,at as R,t as we,au as st,W as rt,av as nt,aw as it,ax as lt,k as ot}from"./index-gSeqINVv.js";import{C as je,c as ct,d as dt,s as ut,a as gt,b as mt,e as X,f as ht,g as xt}from"./crypto-Bb-gUSvf.js";import{S as de}from"./Select-DZW-WlBP.js";import{P as yt,R as pt}from"./RecurringTransactionsList-DEJq0pc7.js";import{T as xe}from"./tag-CtIgllIE.js";import{u as ft,a as bt,b as vt,c as jt}from"./useCategories-DPKiiKcW.js";import{T as Ne}from"./triangle-alert-BOto8DUI.js";import{P as Nt}from"./pencil-Cwf4wOSi.js";import{S as kt}from"./Switch-x8oJcI-l.js";import{M as Ct}from"./mail-CtcSiN5r.js";import{C as wt}from"./crown-7VTr3FGg.js";import{Z as St,C as Et}from"./zap-BuUVvL3B.js";import{M as _t}from"./map-pin-CnLE3Rps.js";import{u as Mt,g as Pt}from"./benchmark-service-DpRSSaqe.js";import{D as Rt}from"./download-B12LRSXc.js";import"./chevron-down-CB3xEDcu.js";import"./recurring-service-D8RI4R0C.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],It=te("link-2",At);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],Tt=te("monitor",Ft);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Fe=te("palette",Lt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],Ot=te("repeat",Dt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],qt=te("save",zt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],ke=te("smartphone",Bt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],Qt=te("wand-sparkles",Kt);async function Ut(){return(await A.get("/api/category-rules/")).data.rules}async function Ht(t){return(await A.post("/api/category-rules/",t)).data}async function Wt(t){await A.delete(`/api/category-rules/${t}`)}async function $t(t=!0){return(await A.post("/api/category-rules/apply",{dry_run:t})).data}async function Gt(){return(await A.get("/api/category-rules/suggest")).data.suggestions}async function Yt(){return(await A.post("/api/category-rules/seed-defaults")).data}const Vt={contains:"categoryRules.contains",starts_with:"categoryRules.startsWith",exact:"categoryRules.exact"},Xt=["Food","Shopping","Transportation","Utilities","Entertainment","Healthcare","Education","Groceries","Dining","Cafe","Convenience","Transfer","Investment","Clothing","Other"];function Jt(){const{t}=B("common"),o=ne(),[n,d]=b.useState(null),[m,g]=b.useState(!1),[y,p]=b.useState(!1),[s,r]=b.useState(null),[a,l]=b.useState(""),[i,u]=b.useState("Other"),[c,x]=b.useState("contains"),{data:h,isLoading:E}=J({queryKey:["category-rules"],queryFn:Ut}),{data:k,isLoading:v}=J({queryKey:["category-rules-suggestions"],queryFn:Gt,enabled:y}),f=O({mutationFn:Wt,onSuccess:()=>{o.invalidateQueries({queryKey:["category-rules"]}),d(null)}}),_=O({mutationFn:Ht,onSuccess:()=>{o.invalidateQueries({queryKey:["category-rules"]}),l(""),u("Other"),x("contains"),g(!1)}}),I=O({mutationFn:Yt,onSuccess:()=>{o.invalidateQueries({queryKey:["category-rules"]})}}),z=O({mutationFn:j=>$t(j),onSuccess:(j,q)=>{q?r({count:j.affected_count,applied:!1}):(o.invalidateQueries({queryKey:["transactions"]}),o.invalidateQueries({queryKey:["analytics"]}),r({count:j.affected_count,applied:!0}))}}),F=j=>{confirm(t("confirmDelete"))&&(d(j),f.mutate(j))},H=()=>{a.trim()&&_.mutate({keyword:a.trim(),category:i,match_type:c,priority:10})},T=j=>{_.mutate({keyword:j.keyword,category:j.suggested_category,match_type:"contains",priority:10})};return E?e.jsxs(U,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"w-5 h-5 text-purple-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("categoryRules.title")})]}),e.jsx("div",{className:"flex justify-center py-8",children:e.jsx($,{size:"md"})})]}):e.jsxs(je,{title:t("categoryRules.title"),badge:(h==null?void 0:h.length)||0,children:[e.jsxs("div",{className:"flex items-center justify-end gap-2 mb-4",children:[(!h||h.length===0)&&e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>I.mutate(),disabled:I.isPending,children:[e.jsx(Qt,{className:"w-4 h-4 mr-1"}),I.isPending?t("loading"):t("categoryRules.seedDefaults")]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>g(!m),children:[e.jsx(Ye,{className:"w-4 h-4 mr-1"}),t("categoryRules.addRule")]})]}),m&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsx("input",{type:"text",placeholder:t("categoryRules.keyword"),value:a,onChange:j=>l(j.target.value),className:C("h-10 px-3 border rounded-lg text-sm","bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100","border-gray-300")}),e.jsx("select",{value:i,onChange:j=>u(j.target.value),className:C("h-10 px-3 border rounded-lg text-sm","bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100","border-gray-300"),children:Xt.map(j=>e.jsx("option",{value:j,children:j},j))}),e.jsxs("select",{value:c,onChange:j=>x(j.target.value),className:C("h-10 px-3 border rounded-lg text-sm","bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100","border-gray-300"),children:[e.jsx("option",{value:"contains",children:t("categoryRules.contains")}),e.jsx("option",{value:"starts_with",children:t("categoryRules.startsWith")}),e.jsx("option",{value:"exact",children:t("categoryRules.exact")})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>g(!1),children:t("cancel")}),e.jsx(P,{size:"sm",onClick:H,disabled:!a.trim()||_.isPending,children:_.isPending?t("saving"):t("save")})]})]}),h&&h.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2 mb-6",children:h.map(j=>e.jsxs("div",{className:C("flex items-center justify-between p-3 rounded-lg border",j.is_active?"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700":"bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-800 opacity-60"),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("code",{className:"px-2 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded text-sm truncate max-w-[150px]",children:j.keyword}),e.jsx("span",{className:"text-gray-400",children:"â†’"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100 font-medium",children:j.category}),e.jsxs("span",{className:"text-xs text-gray-400 dark:text-gray-500 hidden sm:inline",children:["(",t(Vt[j.match_type]),")"]})]}),e.jsx("button",{onClick:()=>F(j.id),disabled:n===j.id,className:"p-2 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/30 text-red-600 transition-colors",children:n===j.id?e.jsx($,{size:"sm"}):e.jsx(Pe,{className:"w-4 h-4"})})]},j.id))}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("categoryRules.applyDescription")}),s&&e.jsx("p",{className:C("text-sm mt-1",s.applied?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"),children:s.applied?t("categoryRules.appliedCount",{count:s.count}):t("categoryRules.previewCount",{count:s.count})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>z.mutate(!0),disabled:z.isPending,children:z.isPending?t("loading"):t("categoryRules.preview")}),e.jsxs(P,{size:"sm",onClick:()=>z.mutate(!1),disabled:z.isPending||(s==null?void 0:s.count)===0,children:[e.jsx(yt,{className:"w-4 h-4 mr-1"}),t("categoryRules.applyNow")]})]})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xe,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t("categoryRules.noRules")}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:t("categoryRules.noRulesDescription")})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[e.jsx("button",{onClick:()=>p(!y),className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:t(y?"categoryRules.hideSuggestions":"categoryRules.showSuggestions")}),y&&e.jsx("div",{className:"mt-4 space-y-2",children:v?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx($,{size:"sm"})}):k&&k.length>0?k.map((j,q)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("code",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded text-sm truncate max-w-[150px]",children:j.keyword}),e.jsx("span",{className:"text-gray-400",children:"â†’"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:j.suggested_category}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",j.count,"x)"]})]}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>T(j),disabled:_.isPending,children:e.jsx(ce,{className:"w-4 h-4"})})]},q)):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:t("categoryRules.noSuggestions")})})]})]})}const Zt=["ðŸ“","ðŸ ","ðŸ½ï¸","ðŸš—","ðŸ’¡","ðŸ“±","ðŸŽ¬","ðŸ›ï¸","ðŸ¥","ðŸ“¦","ðŸ’°","ðŸŽ","ðŸ“ˆ","ðŸ’¼","ðŸ”„","âœˆï¸","ðŸŽ“","ðŸ’³","ðŸ¦","ðŸŽ®","â˜•","ðŸ•","ðŸšŒ","â›½","ðŸ’Š","ðŸ‹ï¸","ðŸ•","ðŸ‘¶","ðŸ’…","ðŸ“š"];function ea({isOpen:t,onClose:o,defaultType:n="expense",onCreated:d}){const{t:m}=B("common"),g=ft(),[y,p]=b.useState(""),[s,r]=b.useState("ðŸ“"),[a,l]=b.useState(n),[i,u]=b.useState(""),c=async E=>{var v,f;E.preventDefault(),u("");const k=y.trim();if(!k){u(m("category.errors.nameRequired","Name is required"));return}try{const I=`custom_${(await g.mutateAsync({name:k,icon:s,type:a})).id}`;d==null||d(I),x()}catch(_){u(((f=(v=_.response)==null?void 0:v.data)==null?void 0:f.detail)||m("category.errors.createFailed","Failed to create category"))}},x=()=>{p(""),r("ðŸ“"),l(n),u(""),o()};if(!t)return null;const h=e.jsxs("div",{className:"fixed inset-0 z-[100001] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:x}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:m("category.createTitle","Create Category")}),e.jsx("button",{onClick:x,className:"p-2.5 -mr-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(Re,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("category.name","Category Name")}),e.jsx("input",{type:"text",value:y,onChange:E=>p(E.target.value),placeholder:m("category.namePlaceholder","e.g., Subscriptions"),maxLength:50,className:"w-full h-10 px-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-gray-100",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("category.icon","Icon")}),e.jsx("div",{className:"grid grid-cols-10 gap-1",children:Zt.map(E=>e.jsx("button",{type:"button",onClick:()=>r(E),className:C("w-8 h-8 text-lg rounded flex items-center justify-center",s===E?"bg-primary-100 dark:bg-primary-900 border-2 border-primary-500":"bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"),children:E},E))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("category.type","Type")}),e.jsxs("div",{className:"flex rounded-lg bg-gray-100 dark:bg-gray-700 p-1",children:[e.jsx("button",{type:"button",onClick:()=>l("expense"),className:C("flex-1 py-2 rounded-md text-sm font-medium transition-colors",a==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-gray-300"),children:m("transaction.expense","Expense")}),e.jsx("button",{type:"button",onClick:()=>l("income"),className:C("flex-1 py-2 rounded-md text-sm font-medium transition-colors",a==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-gray-300"),children:m("transaction.income","Income")})]})]}),i&&e.jsx("p",{className:"text-sm text-red-500",children:i}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:x,className:"flex-1 h-10 border border-gray-300 dark:border-gray-600 rounded-lg font-medium text-gray-700 dark:text-gray-300",children:m("cancel","Cancel")}),e.jsx("button",{type:"submit",disabled:g.isPending,className:"flex-1 h-10 bg-blue-500 text-white rounded-lg font-medium disabled:opacity-50",children:g.isPending?"...":m("create","Create")})]})]})]})]});return typeof document>"u"?null:fe.createPortal(h,document.body)}const ta=["ðŸ“","ðŸ ","ðŸ½ï¸","ðŸš—","ðŸ’¡","ðŸ“±","ðŸŽ¬","ðŸ›ï¸","ðŸ¥","ðŸ“¦","ðŸ’°","ðŸŽ","ðŸ“ˆ","ðŸ’¼","ðŸ”„","âœˆï¸","ðŸŽ“","ðŸ’³","ðŸ¦","ðŸŽ®","â˜•","ðŸ•","ðŸšŒ","â›½","ðŸ’Š","ðŸ‹ï¸","ðŸ•","ðŸ‘¶","ðŸ’…","ðŸ“š"];function aa({isOpen:t,onClose:o,category:n}){const{t:d}=B("common"),m=ne(),[g,y]=b.useState(""),[p,s]=b.useState("ðŸ“"),[r,a]=b.useState(""),[l,i]=b.useState(null);b.useEffect(()=>{n&&(y(n.name),s(n.icon),a(""),i(null))},[n]);const u=O({mutationFn:k=>bt(n.id,k),onSuccess:k=>{i(k.affected_transactions),m.invalidateQueries({queryKey:["categories"]}),m.invalidateQueries({queryKey:["transactions"]}),setTimeout(()=>{x()},1500)},onError:k=>{var f,_;a(((_=(f=k.response)==null?void 0:f.data)==null?void 0:_.detail)||d("category.errors.updateFailed","Failed to update category"))}}),c=async k=>{k.preventDefault(),a("");const v=g.trim();if(!v){a(d("category.errors.nameRequired","Name is required"));return}const f={};if(v!==(n==null?void 0:n.name)&&(f.name=v),p!==(n==null?void 0:n.icon)&&(f.icon=p),Object.keys(f).length===0){x();return}u.mutate(f)},x=()=>{y(""),s("ðŸ“"),a(""),i(null),o()};if(!t||!n)return null;const h=g.trim()!==n.name,E=e.jsxs("div",{className:"fixed inset-0 z-[100001] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:x}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:d("category.editTitle","Edit Category")}),e.jsx("button",{onClick:x,className:"p-2.5 -mr-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(Re,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),l!==null&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-800 dark:text-green-200",children:[d("category.updateSuccess","Category updated!"),l>0&&e.jsx("span",{className:"block mt-1 text-green-600 dark:text-green-300",children:d("category.transactionsUpdated","{{count}} transactions updated",{count:l})})]})}),e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("category.name","Category Name")}),e.jsx("input",{type:"text",value:g,onChange:k=>y(k.target.value),placeholder:d("category.namePlaceholder","e.g., Subscriptions"),maxLength:50,className:"w-full h-10 px-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-gray-100",autoFocus:!0})]}),h&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-800 rounded-lg",children:[e.jsx(Ne,{className:"w-4 h-4 text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:d("category.cascadeWarning","All transactions with this category will be updated to the new name.")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("category.icon","Icon")}),e.jsx("div",{className:"grid grid-cols-10 gap-1",children:ta.map(k=>e.jsx("button",{type:"button",onClick:()=>s(k),className:C("w-8 h-8 text-lg rounded flex items-center justify-center",p===k?"bg-primary-100 dark:bg-primary-900 border-2 border-primary-500":"bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"),children:k},k))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("category.type","Type")}),e.jsx("div",{className:C("h-10 px-3 flex items-center rounded-lg text-sm font-medium",n.type==="expense"?"bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-300":"bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300"),children:n.type==="expense"?d("transaction.expense","Expense"):d("transaction.income","Income")})]}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:x,className:"flex-1 h-10 border border-gray-300 dark:border-gray-600 rounded-lg font-medium text-gray-700 dark:text-gray-300",children:d("cancel","Cancel")}),e.jsx("button",{type:"submit",disabled:u.isPending||l!==null,className:"flex-1 h-10 bg-blue-500 text-white rounded-lg font-medium disabled:opacity-50",children:u.isPending?"...":d("save","Save")})]})]})]})]});return typeof document>"u"?null:fe.createPortal(E,document.body)}function sa(){const{t}=B("common"),{data:o=[],isLoading:n}=vt(),d=jt(),[m,g]=b.useState(!1),[y,p]=b.useState(null),[s,r]=b.useState(null),a=async u=>{try{await d.mutateAsync(u),r(null)}catch(c){console.error("Failed to delete category:",c)}},l=o.filter(u=>u.type==="expense"),i=o.filter(u=>u.type==="income");return e.jsxs(e.Fragment,{children:[e.jsxs(je,{title:t("settings.categoryManagement"),badge:o.length,children:[n?e.jsx("div",{className:"py-4 text-center text-gray-400",children:t("loading")}):o.length===0?e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-center py-4",children:t("settings.noCategories")}):e.jsxs("div",{className:"space-y-4",children:[l.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:t("transaction.expense","Expense")}),e.jsx("div",{className:"space-y-2",children:l.map(u=>e.jsx(Se,{category:u,onEdit:()=>p(u),onDelete:()=>r(u.id),isDeleting:d.isPending&&s===u.id,showDeleteConfirm:s===u.id,onConfirmDelete:()=>a(u.id),onCancelDelete:()=>r(null)},u.id))})]}),i.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:t("transaction.income","Income")}),e.jsx("div",{className:"space-y-2",children:i.map(u=>e.jsx(Se,{category:u,onEdit:()=>p(u),onDelete:()=>r(u.id),isDeleting:d.isPending&&s===u.id,showDeleteConfirm:s===u.id,onConfirmDelete:()=>a(u.id),onCancelDelete:()=>r(null)},u.id))})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(P,{variant:"outline",onClick:()=>g(!0),children:t("settings.addCategory")})})]}),e.jsx(ea,{isOpen:m,onClose:()=>g(!1)}),e.jsx(aa,{isOpen:!!y,onClose:()=>p(null),category:y})]})}function Se({category:t,onEdit:o,onDelete:n,isDeleting:d,showDeleteConfirm:m,onConfirmDelete:g,onCancelDelete:y}){const{t:p}=B("common");return m?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[e.jsx("span",{className:"text-sm text-red-800 dark:text-red-200",children:p("category.deleteConfirm","Delete this category?")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:y,className:"px-3 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:p("cancel")}),e.jsx("button",{onClick:g,disabled:d,className:"px-3 py-1 text-sm bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50",children:d?"...":p("delete")})]})]}):e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:t.icon}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:t.name})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:o,className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded",title:p("edit"),children:e.jsx(Nt,{size:16})}),e.jsx("button",{onClick:n,className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded",title:p("delete"),children:e.jsx(Pe,{size:16})})]})]})}const Ee=["eth","bsc","polygon"];function ra(){const{t}=B("common"),o=ne(),[n,d]=b.useState(!1),[m,g]=b.useState(""),[y,p]=b.useState(""),[s,r]=b.useState(["eth","bsc","polygon"]),[a,l]=b.useState(!1),[i,u]=b.useState("polygon"),[c,x]=b.useState(""),[h,E]=b.useState(""),[k,v]=b.useState(""),[f,_]=b.useState(null),{data:I,isLoading:z}=J({queryKey:["crypto-wallets"],queryFn:ht}),{data:F,isLoading:H}=J({queryKey:["reward-contracts"],queryFn:xt}),T=O({mutationFn:ct,onSuccess:()=>{o.invalidateQueries({queryKey:["crypto-wallets"]}),d(!1),D()}}),j=O({mutationFn:dt,onSuccess:()=>{o.invalidateQueries({queryKey:["crypto-wallets"]})}}),q=O({mutationFn:ut,onSuccess:()=>{o.invalidateQueries({queryKey:["crypto-wallets"]}),o.invalidateQueries({queryKey:["dashboard-summary"]}),_(null)},onError:()=>{_(null)}}),G=O({mutationFn:gt,onSuccess:()=>{o.invalidateQueries({queryKey:["reward-contracts"]}),l(!1),Y()}}),L=O({mutationFn:mt,onSuccess:()=>{o.invalidateQueries({queryKey:["reward-contracts"]})}}),D=()=>{g(""),p(""),r(["eth","bsc","polygon"])},Y=()=>{u("polygon"),x(""),E(""),v("")},W=()=>{if(!m||!m.match(/^0x[a-fA-F0-9]{40}$/)){alert(t("crypto.invalidAddress"));return}T.mutate({wallet_address:m,label:y||void 0,chains:s})},V=N=>{_(N),q.mutate(N)},ae=()=>{if(!c||!c.match(/^0x[a-fA-F0-9]{40}$/)){alert(t("crypto.invalidAddress"));return}G.mutate({chain_id:i,contract_address:c,label:h||void 0,token_symbol:k||void 0})},se=N=>{r(K=>K.includes(N)?K.filter(Z=>Z!==N):[...K,N])};return z||H?e.jsx(U,{children:e.jsx("div",{className:"flex justify-center py-8",children:e.jsx($,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(U,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("crypto.wallets")}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>d(!n),children:t(n?"cancel":"crypto.addWallet")})]}),n&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-4",children:[e.jsx(Q,{label:t("crypto.walletAddress"),placeholder:"0x...",value:m,onChange:N=>g(N.target.value)}),e.jsx(Q,{label:t("crypto.walletLabel"),placeholder:t("crypto.labelPlaceholder"),value:y,onChange:N=>p(N.target.value)}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t("crypto.chains")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Ee.map(N=>e.jsxs("button",{type:"button",onClick:()=>se(N),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${s.includes(N)?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:[X[N].icon," ",X[N].name]},N))})]}),e.jsx(P,{onClick:W,disabled:T.isPending,className:"w-full",children:T.isPending?t("loading"):t("crypto.addWallet")})]}),e.jsx("div",{className:"space-y-3",children:I&&I.length>0?I.map(N=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:N.label||t("crypto.unnamedWallet")}),e.jsx("div",{className:"flex gap-1",children:N.chains.map(K=>e.jsx("span",{title:X[K].name,children:X[K].icon},K))})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono truncate",children:N.wallet_address})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>V(N.id),disabled:f===N.id,children:f===N.id?e.jsx($,{size:"sm"}):t("crypto.sync")}),e.jsx("button",{onClick:()=>{confirm(t("crypto.confirmDeleteWallet"))&&j.mutate(N.id)},className:"text-red-600 hover:text-red-700 text-sm",children:t("delete")})]})]},N.id)):e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-center py-4",children:t("crypto.noWallets")})})]}),e.jsxs(U,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("crypto.rewardContracts")}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("crypto.rewardContractsDescription")})]}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>l(!a),children:t(a?"cancel":"crypto.addContract")})]}),a&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t("crypto.chain")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Ee.map(N=>e.jsxs("button",{type:"button",onClick:()=>u(N),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${i===N?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:[X[N].icon," ",X[N].name]},N))})]}),e.jsx(Q,{label:t("crypto.contractAddress"),placeholder:"0x...",value:c,onChange:N=>x(N.target.value)}),e.jsx(Q,{label:t("crypto.contractLabel"),placeholder:t("crypto.contractLabelPlaceholder"),value:h,onChange:N=>E(N.target.value)}),e.jsx(Q,{label:t("crypto.tokenSymbol"),placeholder:"STEER",value:k,onChange:N=>v(N.target.value)}),e.jsx(P,{onClick:ae,disabled:G.isPending,className:"w-full",children:G.isPending?t("loading"):t("crypto.addContract")})]}),e.jsx("div",{className:"space-y-3",children:F&&F.length>0?F.map(N=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{title:X[N.chain_id].name,children:X[N.chain_id].icon}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:N.label||t("crypto.unnamedContract")}),N.token_symbol&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 text-xs rounded",children:N.token_symbol})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono truncate",children:N.contract_address})]}),e.jsx("button",{onClick:()=>{confirm(t("crypto.confirmDeleteContract"))&&L.mutate(N.id)},className:"text-red-600 hover:text-red-700 text-sm ml-4",children:t("delete")})]},N.id)):e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-center py-4",children:t("crypto.noContracts")})})]})]})}function na(){const{t}=B("common"),o=ne(),{data:n,isLoading:d,error:m}=J({queryKey:["anomalyConfig"],queryFn:Xe}),g=O({mutationFn:i=>Ve(i),onSuccess:()=>{o.invalidateQueries({queryKey:["anomalyConfig"]})}}),[y,p]=b.useState({sensitivity:"medium",large_transaction_threshold:1e4,unusual_spending_percent:50,recurring_change_percent:20,duplicate_charge_hours:24,enabled_types:["large_transaction","category_shift","duplicate"]});b.useEffect(()=>{n&&p({sensitivity:n.sensitivity,large_transaction_threshold:n.large_transaction_threshold,unusual_spending_percent:n.unusual_spending_percent,recurring_change_percent:n.recurring_change_percent,duplicate_charge_hours:n.duplicate_charge_hours,enabled_types:n.enabled_types||["large_transaction","category_shift","duplicate"]})},[n]);const s=()=>{g.mutate(y)},r=i=>{p(u=>{const c=u.enabled_types||[],x=c.includes(i)?c.filter(h=>h!==i):[...c,i];return{...u,enabled_types:x}})},a=[{key:"large_transaction",label:t("anomaly.type.large_transaction")},{key:"category_shift",label:t("anomaly.type.category_shift")},{key:"duplicate",label:t("anomaly.type.duplicate")},{key:"recurring_change",label:t("anomaly.type.recurring_change")},{key:"ml_detected",label:t("anomaly.type.ml_detected")}],l=[{value:"low",label:t("anomaly.config.sensitivityOptions.low")},{value:"medium",label:t("anomaly.config.sensitivityOptions.medium")},{value:"high",label:t("anomaly.config.sensitivityOptions.high")}];return d?e.jsx(U,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/3"}),e.jsx("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded"})]})}):m?e.jsxs(U,{className:"p-6 text-center text-gray-500",children:[e.jsx(Ne,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:t("common.noData")})]}):e.jsxs(U,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(ue,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold",children:t("anomaly.config.title")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(de,{label:t("anomaly.config.sensitivity"),value:y.sensitivity,onChange:i=>p({...y,sensitivity:i.target.value}),options:l}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Q,{type:"number",label:t("anomaly.config.largeTransactionThreshold"),value:y.large_transaction_threshold,onChange:i=>p({...y,large_transaction_threshold:parseInt(i.target.value)||0})}),e.jsx(Q,{type:"number",label:t("anomaly.config.unusualSpendingPercent"),value:y.unusual_spending_percent,onChange:i=>p({...y,unusual_spending_percent:parseInt(i.target.value)||0})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Q,{type:"number",label:t("anomaly.config.recurringChangePercent"),value:y.recurring_change_percent,onChange:i=>p({...y,recurring_change_percent:parseInt(i.target.value)||0})}),e.jsx(Q,{type:"number",label:t("anomaly.config.duplicateChargeHours"),value:y.duplicate_charge_hours,onChange:i=>p({...y,duplicate_charge_hours:parseInt(i.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:t("anomaly.config.enabledTypes")}),e.jsx("div",{className:"space-y-3",children:a.map(i=>{const u=(y.enabled_types||[]).includes(i.key);return e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:i.label}),e.jsx(kt,{checked:u,onChange:()=>r(i.key)})]},i.key)})})]}),e.jsx(P,{onClick:s,disabled:g.isPending,className:"w-full",children:g.isPending?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"animate-spin",children:"â³"}),t("common.saving")]}):e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"}),t("anomaly.config.save")]})}),g.isSuccess&&e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 text-center",children:t("anomaly.config.saved")})]})]})}const he={async getNotifications(t){const o=new URLSearchParams;return t!=null&&t.unreadOnly&&o.append("unread_only","true"),t!=null&&t.limit&&o.append("limit",String(t.limit)),t!=null&&t.offset&&o.append("offset",String(t.offset)),t!=null&&t.type&&o.append("type",t.type),(await A.get(`/api/notifications?${o}`)).data},async getUnreadCount(){return(await A.get("/api/notifications/unread/count")).data},async markAsRead(t){return(await A.put(`/api/notifications/${t}/read`,{})).data},async markAllAsRead(){return(await A.put("/api/notifications/read-all",{})).data},async deleteNotification(t){return(await A.delete(`/api/notifications/${t}`)).data},async cleanupOldNotifications(t=30){return(await A.post("/api/notifications/cleanup",{days_old:t})).data},async getPreferences(){return(await A.get("/api/notifications/preferences")).data},async updatePreference(t,o,n){return(await A.put(`/api/notifications/preferences/${t}`,{enabled:o,settings:n})).data},async subscribePush(t){return(await A.post("/api/notifications/push/subscribe",t)).data},async unsubscribePush(){return(await A.post("/api/notifications/push/unsubscribe",{})).data}};function ia(){return typeof window>"u"?!1:"serviceWorker"in navigator&&"PushManager"in window}async function la(){return typeof window>"u"?"denied":await Notification.requestPermission()}function oa(){return""}function ca(){const{t}=B("common"),o=ne(),[n,d]=b.useState(!1),[m,g]=b.useState(!1),{data:y,isLoading:p}=J({queryKey:["notification-preferences"],queryFn:he.getPreferences}),s=O({mutationFn:({channel:c,enabled:x,settings:h})=>he.updatePreference(c,x,h),onSuccess:()=>{o.invalidateQueries({queryKey:["notification-preferences"]})}}),r=(y==null?void 0:y.preferences)||[];b.useEffect(()=>{(async()=>{if(ia()){const x=await Notification.permission;d(x==="granted")}})()},[]);const a=(c,x)=>{s.mutate({channel:c,enabled:!x})},l=async()=>{g(!0);try{if(await la()==="granted"&&(d(!0),"serviceWorker"in navigator&&"PushManager"in window)){const h=await(await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:oa()});await he.subscribePush(h.toJSON())}}catch(c){console.error("Failed to enable push notifications:",c)}finally{g(!1)}},i=c=>r.find(x=>x.channel===c),u=[{id:"push",icon:ke,label:t("notifications.channels.push"),description:t("notifications.channels.pushDescription"),getEnabled:()=>n,onToggle:l},{id:"email",icon:Ct,label:t("notifications.channels.email"),description:t("notifications.channels.emailDescription"),getEnabled:()=>{var c;return((c=i("email"))==null?void 0:c.enabled)??!0},onToggle:()=>{var c;return a("email",((c=i("email"))==null?void 0:c.enabled)??!0)}},{id:"in_app",icon:Ae,label:t("notifications.channels.inApp"),description:t("notifications.channels.inAppDescription"),getEnabled:()=>{var c;return((c=i("in_app"))==null?void 0:c.enabled)??!0},onToggle:()=>{var c;return a("in_app",((c=i("in_app"))==null?void 0:c.enabled)??!0)}}];return p?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx($,{size:"lg"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(U,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ue,{className:"w-5 h-5 text-primary-600 dark:text-primary-400"}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:t("notifications.channels.title")})]}),e.jsx("div",{className:"space-y-4",children:u.map(c=>{const x=c.icon,h=c.getEnabled();return e.jsxs("div",{className:C("flex items-center justify-between p-3 rounded-lg border transition-colors",h?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:C("p-2 rounded-lg",h?"bg-green-100 dark:bg-green-900/50":"bg-gray-200 dark:bg-gray-600"),children:e.jsx(x,{className:C("w-5 h-5",h?"text-green-600 dark:text-green-400":"text-gray-500 dark:text-gray-400")})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:c.label}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:c.description})]})]}),e.jsx("button",{onClick:c.onToggle,disabled:c.id==="push"&&m,className:C("relative inline-flex h-7 w-12 items-center rounded-full transition-colors flex-shrink-0",h?"bg-green-500":"bg-gray-300 dark:bg-gray-600"),children:e.jsx("span",{className:C("inline-block h-5 w-5 transform rounded-full bg-white transition-transform shadow-sm",h?"translate-x-6":"translate-x-1")})})]},c.id)})})]}),e.jsxs(U,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:t("notifications.types.title")}),e.jsx("div",{className:"space-y-3",children:[{key:"budget_alert",label:t("notifications.types.budget")},{key:"bill_reminder",label:t("notifications.types.bills")},{key:"anomaly_detected",label:t("notifications.types.anomalies")},{key:"goal_milestone",label:t("notifications.types.goals")},{key:"savings_tip",label:t("notifications.types.savings")},{key:"burn_rate_warning",label:t("notifications.types.burnRate")}].map(c=>{const x=i(c.key),h=(x==null?void 0:x.enabled)??!0;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:c.label}),e.jsx("button",{onClick:()=>a(c.key,!h),className:C("relative inline-flex h-6 w-11 items-center rounded-full transition-colors",h?"bg-primary-600":"bg-gray-300 dark:bg-gray-600"),children:e.jsx("span",{className:C("inline-block h-4 w-4 transform rounded-full bg-white transition-transform",h?"translate-x-6":"translate-x-1")})})]},c.key)})})]}),e.jsxs(U,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:t("notifications.quietHours.title")}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("notifications.quietHours.description")})}),e.jsxs(P,{variant:"outline",size:"sm",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),t("notifications.quietHours.configure")]})]})]})]})}const da={default:"appearance.themes.default","catppuccin-latte":"appearance.themes.catppuccinLatte","catppuccin-frappe":"appearance.themes.catppuccinFrappe","catppuccin-macchiato":"appearance.themes.catppuccinMacchiato","catppuccin-mocha":"appearance.themes.catppuccinMocha",dracula:"appearance.themes.dracula","dracula-light":"appearance.themes.draculaLight"},ua={default:"Default","catppuccin-latte":"Catppuccin Latte","catppuccin-frappe":"Catppuccin Frappe","catppuccin-macchiato":"Catppuccin Macchiato","catppuccin-mocha":"Catppuccin Mocha",dracula:"Dracula","dracula-light":"Dracula Light"};function ga(){const{t}=B("common"),{colorTheme:o,setColorTheme:n}=Ie();return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:Ze.map(d=>{const m=o===d.id,{base:g,surface:y,text:p,primary:s}=d.preview;return e.jsxs("button",{onClick:()=>n(d.id),className:C("relative flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all",m?"border-primary-500 ring-2 ring-primary-500/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"),children:[e.jsx("div",{className:"w-full aspect-[4/3] rounded-lg overflow-hidden border border-black/10",style:{backgroundColor:g},children:e.jsxs("div",{className:"p-2 h-full flex flex-col gap-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:s}}),e.jsx("div",{className:"h-1.5 rounded-full flex-1",style:{backgroundColor:p,opacity:.3}})]}),e.jsx("div",{className:"flex-1 rounded",style:{backgroundColor:y},children:e.jsxs("div",{className:"p-1.5 flex flex-col gap-1",children:[e.jsx("div",{className:"h-1 rounded-full w-3/4",style:{backgroundColor:p,opacity:.5}}),e.jsx("div",{className:"h-1 rounded-full w-1/2",style:{backgroundColor:p,opacity:.3}}),e.jsx("div",{className:"h-1.5 rounded-full w-2/5 mt-0.5",style:{backgroundColor:s}})]})})]})}),e.jsx("span",{className:C("text-xs font-medium truncate w-full text-center",m?"text-primary-700 dark:text-primary-300":"text-gray-600 dark:text-gray-400"),children:t(da[d.id],ua[d.id])}),m&&e.jsx("div",{className:"absolute top-1.5 right-1.5 w-5 h-5 rounded-full bg-primary-500 flex items-center justify-center",children:e.jsx(ce,{className:"w-3 h-3 text-white"})})]},d.id)})})}function ma(){const{t}=B("common"),{theme:o,setTheme:n,accentColor:d,setAccentColor:m,colorTheme:g,tier:y,setTier:p}=Ie(),s=[{id:"light",icon:et,label:t("appearance.light","Light")},{id:"dark",icon:tt,label:t("appearance.dark","Dark")},{id:"system",icon:Tt,label:t("appearance.system","System")}],r=[{id:"pro",icon:wt,label:t("appearance.pro","Pro"),desc:t("appearance.proDesc","Full access, all items visible")},{id:"lite",icon:St,label:t("appearance.lite","Lite"),desc:t("appearance.liteDesc","Simplified view, fewer items per page")}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:t("appearance.themeMode","Theme Mode")}),g!=="default"?e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 italic",children:t("appearance.themeControlled","Controlled by theme")}):e.jsx("div",{className:"grid grid-cols-3 gap-2",children:s.map(({id:a,icon:l,label:i})=>e.jsxs("button",{onClick:()=>n(a),className:C("flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all",o===a?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"),children:[e.jsx(l,{className:C("w-5 h-5",o===a?"text-primary-600 dark:text-primary-400":"text-gray-500 dark:text-gray-400")}),e.jsx("span",{className:C("text-xs font-medium",o===a?"text-primary-700 dark:text-primary-300":"text-gray-600 dark:text-gray-400"),children:i})]},a))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:t("appearance.colorTheme","Color Theme")}),e.jsx(ga,{})]}),g==="default"&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:t("appearance.accentColor","Accent Color")}),e.jsx("div",{className:"flex flex-wrap gap-3",children:at.map(a=>e.jsxs("button",{onClick:()=>m(a.id),className:"group flex flex-col items-center gap-1.5",title:a.label,children:[e.jsx("div",{className:C("w-10 h-10 rounded-full transition-all ring-offset-2 ring-offset-white dark:ring-offset-gray-900",d===a.id?"ring-2 ring-gray-900 dark:ring-white scale-110":"ring-1 ring-gray-200 dark:ring-gray-700 group-hover:scale-105"),style:{backgroundColor:a.preview}}),e.jsx("span",{className:C("text-[10px] font-medium",d===a.id?"text-gray-900 dark:text-gray-100":"text-gray-500 dark:text-gray-500"),children:a.label})]},a.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:t("appearance.displayMode","Display Mode")}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:r.map(({id:a,icon:l,label:i,desc:u})=>e.jsxs("button",{onClick:()=>p(a),className:C("flex flex-col items-start gap-2 p-4 rounded-xl border-2 transition-all text-left",y===a?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{className:C("w-4 h-4",y===a?"text-primary-600 dark:text-primary-400":"text-gray-500")}),e.jsx("span",{className:C("text-sm font-semibold",y===a?"text-primary-700 dark:text-primary-300":"text-gray-700 dark:text-gray-300"),children:i})]}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:u})]},a))})]})]})}const ha=[{value:"01",label:"åŒ—æµ·é“"},{value:"02",label:"é’æ£®çœŒ"},{value:"03",label:"å²©æ‰‹çœŒ"},{value:"04",label:"å®®åŸŽçœŒ"},{value:"05",label:"ç§‹ç”°çœŒ"},{value:"06",label:"å±±å½¢çœŒ"},{value:"07",label:"ç¦å³¶çœŒ"},{value:"08",label:"èŒ¨åŸŽçœŒ"},{value:"09",label:"æ ƒæœ¨çœŒ"},{value:"10",label:"ç¾¤é¦¬çœŒ"},{value:"11",label:"åŸ¼çŽ‰çœŒ"},{value:"12",label:"åƒè‘‰çœŒ"},{value:"13",label:"æ±äº¬éƒ½"},{value:"14",label:"ç¥žå¥ˆå·çœŒ"},{value:"15",label:"æ–°æ½ŸçœŒ"},{value:"16",label:"å¯Œå±±çœŒ"},{value:"17",label:"çŸ³å·çœŒ"},{value:"18",label:"ç¦äº•çœŒ"},{value:"19",label:"å±±æ¢¨çœŒ"},{value:"20",label:"é•·é‡ŽçœŒ"},{value:"21",label:"å²é˜œçœŒ"},{value:"22",label:"é™å²¡çœŒ"},{value:"23",label:"æ„›çŸ¥çœŒ"},{value:"24",label:"ä¸‰é‡çœŒ"},{value:"25",label:"æ»‹è³€çœŒ"},{value:"26",label:"äº¬éƒ½åºœ"},{value:"27",label:"å¤§é˜ªåºœ"},{value:"28",label:"å…µåº«çœŒ"},{value:"29",label:"å¥ˆè‰¯çœŒ"},{value:"30",label:"å’Œæ­Œå±±çœŒ"},{value:"31",label:"é³¥å–çœŒ"},{value:"32",label:"å³¶æ ¹çœŒ"},{value:"33",label:"å²¡å±±çœŒ"},{value:"34",label:"åºƒå³¶çœŒ"},{value:"35",label:"å±±å£çœŒ"},{value:"36",label:"å¾³å³¶çœŒ"},{value:"37",label:"é¦™å·çœŒ"},{value:"38",label:"æ„›åª›çœŒ"},{value:"39",label:"é«˜çŸ¥çœŒ"},{value:"40",label:"ç¦å²¡çœŒ"},{value:"41",label:"ä½è³€çœŒ"},{value:"42",label:"é•·å´ŽçœŒ"},{value:"43",label:"ç†Šæœ¬çœŒ"},{value:"44",label:"å¤§åˆ†çœŒ"},{value:"45",label:"å®®å´ŽçœŒ"},{value:"46",label:"é¹¿å…å³¶çœŒ"},{value:"47",label:"æ²–ç¸„çœŒ"}],xa=[{value:"1",label:"~300ä¸‡å††"},{value:"2",label:"300~500ä¸‡å††"},{value:"3",label:"500~700ä¸‡å††"},{value:"4",label:"700~1000ä¸‡å††"},{value:"5",label:"1000ä¸‡å††~"}],ya=[{value:"1",label:"1äºº"},{value:"2",label:"2äºº"},{value:"3",label:"3äºº"},{value:"4",label:"4äºº"},{value:"5",label:"5äººä»¥ä¸Š"}];function pa({profile:t,onSave:o,isLoading:n}){const{t:d}=B("common"),[m,g]=b.useState("2"),[y,p]=b.useState("13"),[s,r]=b.useState("3");b.useEffect(()=>{t&&(g(String(t.family_size)),p(t.prefecture),r(t.annual_income_bracket))},[t]);const a=i=>{i.preventDefault(),o({family_size:parseInt(m),prefecture:y,annual_income_bracket:s})},l=t?m!==String(t.family_size)||y!==t.prefecture||s!==t.annual_income_bracket:!0;return e.jsxs("form",{onSubmit:a,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(be,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"}),d("benchmark.familySize","Family size")]}),e.jsx(de,{value:m,onChange:i=>g(i.target.value),options:ya,disabled:n})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(_t,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"}),d("benchmark.prefecture","Prefecture")]}),e.jsx(de,{value:y,onChange:i=>p(i.target.value),options:ha,disabled:n})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(ve,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"}),d("benchmark.annualIncome","Annual income bracket")]}),e.jsx(de,{value:s,onChange:i=>r(i.target.value),options:xa,disabled:n})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsx(P,{type:"submit",disabled:!l||n,className:C("min-w-[120px]",!l&&"opacity-50 cursor-not-allowed"),children:n?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),d("common.saving","Saving...")]}):d("common.save","Save")})})]})}async function fa(){return(await A.post("/api/export/ios/link")).data}async function ba(){const t=await A.get("/api/export/ios",{responseType:"blob"}),o=t.headers["content-disposition"];let n=`smartmoney-export-${new Date().toISOString().slice(0,10)}.json`;if(o){const y=o.match(/filename="?([^";\n]+)"?/);y!=null&&y[1]&&(n=y[1])}const d=new Blob([t.data],{type:"application/json"}),m=window.URL.createObjectURL(d),g=document.createElement("a");g.href=m,g.download=n,document.body.appendChild(g),g.click(),document.body.removeChild(g),window.URL.revokeObjectURL(m)}var va=Object.defineProperty,me=Object.getOwnPropertySymbols,Te=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable,_e=(t,o,n)=>o in t?va(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,ye=(t,o)=>{for(var n in o||(o={}))Te.call(o,n)&&_e(t,n,o[n]);if(me)for(var n of me(o))Le.call(o,n)&&_e(t,n,o[n]);return t},pe=(t,o)=>{var n={};for(var d in t)Te.call(t,d)&&o.indexOf(d)<0&&(n[d]=t[d]);if(t!=null&&me)for(var d of me(t))o.indexOf(d)<0&&Le.call(t,d)&&(n[d]=t[d]);return n};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var ee;(t=>{const o=class w{constructor(s,r,a,l){if(this.version=s,this.errorCorrectionLevel=r,this.modules=[],this.isFunction=[],s<w.MIN_VERSION||s>w.MAX_VERSION)throw new RangeError("Version value out of range");if(l<-1||l>7)throw new RangeError("Mask value out of range");this.size=s*4+17;let i=[];for(let c=0;c<this.size;c++)i.push(!1);for(let c=0;c<this.size;c++)this.modules.push(i.slice()),this.isFunction.push(i.slice());this.drawFunctionPatterns();const u=this.addEccAndInterleave(a);if(this.drawCodewords(u),l==-1){let c=1e9;for(let x=0;x<8;x++){this.applyMask(x),this.drawFormatBits(x);const h=this.getPenaltyScore();h<c&&(l=x,c=h),this.applyMask(x)}}m(0<=l&&l<=7),this.mask=l,this.applyMask(l),this.drawFormatBits(l),this.isFunction=[]}static encodeText(s,r){const a=t.QrSegment.makeSegments(s);return w.encodeSegments(a,r)}static encodeBinary(s,r){const a=t.QrSegment.makeBytes(s);return w.encodeSegments([a],r)}static encodeSegments(s,r,a=1,l=40,i=-1,u=!0){if(!(w.MIN_VERSION<=a&&a<=l&&l<=w.MAX_VERSION)||i<-1||i>7)throw new RangeError("Invalid value");let c,x;for(c=a;;c++){const v=w.getNumDataCodewords(c,r)*8,f=y.getTotalBits(s,c);if(f<=v){x=f;break}if(c>=l)throw new RangeError("Data too long")}for(const v of[w.Ecc.MEDIUM,w.Ecc.QUARTILE,w.Ecc.HIGH])u&&x<=w.getNumDataCodewords(c,v)*8&&(r=v);let h=[];for(const v of s){n(v.mode.modeBits,4,h),n(v.numChars,v.mode.numCharCountBits(c),h);for(const f of v.getData())h.push(f)}m(h.length==x);const E=w.getNumDataCodewords(c,r)*8;m(h.length<=E),n(0,Math.min(4,E-h.length),h),n(0,(8-h.length%8)%8,h),m(h.length%8==0);for(let v=236;h.length<E;v^=253)n(v,8,h);let k=[];for(;k.length*8<h.length;)k.push(0);return h.forEach((v,f)=>k[f>>>3]|=v<<7-(f&7)),new w(c,r,k,i)}getModule(s,r){return 0<=s&&s<this.size&&0<=r&&r<this.size&&this.modules[r][s]}getModules(){return this.modules}drawFunctionPatterns(){for(let a=0;a<this.size;a++)this.setFunctionModule(6,a,a%2==0),this.setFunctionModule(a,6,a%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const s=this.getAlignmentPatternPositions(),r=s.length;for(let a=0;a<r;a++)for(let l=0;l<r;l++)a==0&&l==0||a==0&&l==r-1||a==r-1&&l==0||this.drawAlignmentPattern(s[a],s[l]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(s){const r=this.errorCorrectionLevel.formatBits<<3|s;let a=r;for(let i=0;i<10;i++)a=a<<1^(a>>>9)*1335;const l=(r<<10|a)^21522;m(l>>>15==0);for(let i=0;i<=5;i++)this.setFunctionModule(8,i,d(l,i));this.setFunctionModule(8,7,d(l,6)),this.setFunctionModule(8,8,d(l,7)),this.setFunctionModule(7,8,d(l,8));for(let i=9;i<15;i++)this.setFunctionModule(14-i,8,d(l,i));for(let i=0;i<8;i++)this.setFunctionModule(this.size-1-i,8,d(l,i));for(let i=8;i<15;i++)this.setFunctionModule(8,this.size-15+i,d(l,i));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let s=this.version;for(let a=0;a<12;a++)s=s<<1^(s>>>11)*7973;const r=this.version<<12|s;m(r>>>18==0);for(let a=0;a<18;a++){const l=d(r,a),i=this.size-11+a%3,u=Math.floor(a/3);this.setFunctionModule(i,u,l),this.setFunctionModule(u,i,l)}}drawFinderPattern(s,r){for(let a=-4;a<=4;a++)for(let l=-4;l<=4;l++){const i=Math.max(Math.abs(l),Math.abs(a)),u=s+l,c=r+a;0<=u&&u<this.size&&0<=c&&c<this.size&&this.setFunctionModule(u,c,i!=2&&i!=4)}}drawAlignmentPattern(s,r){for(let a=-2;a<=2;a++)for(let l=-2;l<=2;l++)this.setFunctionModule(s+l,r+a,Math.max(Math.abs(l),Math.abs(a))!=1)}setFunctionModule(s,r,a){this.modules[r][s]=a,this.isFunction[r][s]=!0}addEccAndInterleave(s){const r=this.version,a=this.errorCorrectionLevel;if(s.length!=w.getNumDataCodewords(r,a))throw new RangeError("Invalid argument");const l=w.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][r],i=w.ECC_CODEWORDS_PER_BLOCK[a.ordinal][r],u=Math.floor(w.getNumRawDataModules(r)/8),c=l-u%l,x=Math.floor(u/l);let h=[];const E=w.reedSolomonComputeDivisor(i);for(let v=0,f=0;v<l;v++){let _=s.slice(f,f+x-i+(v<c?0:1));f+=_.length;const I=w.reedSolomonComputeRemainder(_,E);v<c&&_.push(0),h.push(_.concat(I))}let k=[];for(let v=0;v<h[0].length;v++)h.forEach((f,_)=>{(v!=x-i||_>=c)&&k.push(f[v])});return m(k.length==u),k}drawCodewords(s){if(s.length!=Math.floor(w.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let r=0;for(let a=this.size-1;a>=1;a-=2){a==6&&(a=5);for(let l=0;l<this.size;l++)for(let i=0;i<2;i++){const u=a-i,x=(a+1&2)==0?this.size-1-l:l;!this.isFunction[x][u]&&r<s.length*8&&(this.modules[x][u]=d(s[r>>>3],7-(r&7)),r++)}}m(r==s.length*8)}applyMask(s){if(s<0||s>7)throw new RangeError("Mask value out of range");for(let r=0;r<this.size;r++)for(let a=0;a<this.size;a++){let l;switch(s){case 0:l=(a+r)%2==0;break;case 1:l=r%2==0;break;case 2:l=a%3==0;break;case 3:l=(a+r)%3==0;break;case 4:l=(Math.floor(a/3)+Math.floor(r/2))%2==0;break;case 5:l=a*r%2+a*r%3==0;break;case 6:l=(a*r%2+a*r%3)%2==0;break;case 7:l=((a+r)%2+a*r%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[r][a]&&l&&(this.modules[r][a]=!this.modules[r][a])}}getPenaltyScore(){let s=0;for(let i=0;i<this.size;i++){let u=!1,c=0,x=[0,0,0,0,0,0,0];for(let h=0;h<this.size;h++)this.modules[i][h]==u?(c++,c==5?s+=w.PENALTY_N1:c>5&&s++):(this.finderPenaltyAddHistory(c,x),u||(s+=this.finderPenaltyCountPatterns(x)*w.PENALTY_N3),u=this.modules[i][h],c=1);s+=this.finderPenaltyTerminateAndCount(u,c,x)*w.PENALTY_N3}for(let i=0;i<this.size;i++){let u=!1,c=0,x=[0,0,0,0,0,0,0];for(let h=0;h<this.size;h++)this.modules[h][i]==u?(c++,c==5?s+=w.PENALTY_N1:c>5&&s++):(this.finderPenaltyAddHistory(c,x),u||(s+=this.finderPenaltyCountPatterns(x)*w.PENALTY_N3),u=this.modules[h][i],c=1);s+=this.finderPenaltyTerminateAndCount(u,c,x)*w.PENALTY_N3}for(let i=0;i<this.size-1;i++)for(let u=0;u<this.size-1;u++){const c=this.modules[i][u];c==this.modules[i][u+1]&&c==this.modules[i+1][u]&&c==this.modules[i+1][u+1]&&(s+=w.PENALTY_N2)}let r=0;for(const i of this.modules)r=i.reduce((u,c)=>u+(c?1:0),r);const a=this.size*this.size,l=Math.ceil(Math.abs(r*20-a*10)/a)-1;return m(0<=l&&l<=9),s+=l*w.PENALTY_N4,m(0<=s&&s<=2568888),s}getAlignmentPatternPositions(){if(this.version==1)return[];{const s=Math.floor(this.version/7)+2,r=this.version==32?26:Math.ceil((this.version*4+4)/(s*2-2))*2;let a=[6];for(let l=this.size-7;a.length<s;l-=r)a.splice(1,0,l);return a}}static getNumRawDataModules(s){if(s<w.MIN_VERSION||s>w.MAX_VERSION)throw new RangeError("Version number out of range");let r=(16*s+128)*s+64;if(s>=2){const a=Math.floor(s/7)+2;r-=(25*a-10)*a-55,s>=7&&(r-=36)}return m(208<=r&&r<=29648),r}static getNumDataCodewords(s,r){return Math.floor(w.getNumRawDataModules(s)/8)-w.ECC_CODEWORDS_PER_BLOCK[r.ordinal][s]*w.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][s]}static reedSolomonComputeDivisor(s){if(s<1||s>255)throw new RangeError("Degree out of range");let r=[];for(let l=0;l<s-1;l++)r.push(0);r.push(1);let a=1;for(let l=0;l<s;l++){for(let i=0;i<r.length;i++)r[i]=w.reedSolomonMultiply(r[i],a),i+1<r.length&&(r[i]^=r[i+1]);a=w.reedSolomonMultiply(a,2)}return r}static reedSolomonComputeRemainder(s,r){let a=r.map(l=>0);for(const l of s){const i=l^a.shift();a.push(0),r.forEach((u,c)=>a[c]^=w.reedSolomonMultiply(u,i))}return a}static reedSolomonMultiply(s,r){if(s>>>8||r>>>8)throw new RangeError("Byte out of range");let a=0;for(let l=7;l>=0;l--)a=a<<1^(a>>>7)*285,a^=(r>>>l&1)*s;return m(a>>>8==0),a}finderPenaltyCountPatterns(s){const r=s[1];m(r<=this.size*3);const a=r>0&&s[2]==r&&s[3]==r*3&&s[4]==r&&s[5]==r;return(a&&s[0]>=r*4&&s[6]>=r?1:0)+(a&&s[6]>=r*4&&s[0]>=r?1:0)}finderPenaltyTerminateAndCount(s,r,a){return s&&(this.finderPenaltyAddHistory(r,a),r=0),r+=this.size,this.finderPenaltyAddHistory(r,a),this.finderPenaltyCountPatterns(a)}finderPenaltyAddHistory(s,r){r[0]==0&&(s+=this.size),r.pop(),r.unshift(s)}};o.MIN_VERSION=1,o.MAX_VERSION=40,o.PENALTY_N1=3,o.PENALTY_N2=3,o.PENALTY_N3=40,o.PENALTY_N4=10,o.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],o.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=o;function n(p,s,r){if(s<0||s>31||p>>>s)throw new RangeError("Value out of range");for(let a=s-1;a>=0;a--)r.push(p>>>a&1)}function d(p,s){return(p>>>s&1)!=0}function m(p){if(!p)throw new Error("Assertion error")}const g=class M{constructor(s,r,a){if(this.mode=s,this.numChars=r,this.bitData=a,r<0)throw new RangeError("Invalid argument");this.bitData=a.slice()}static makeBytes(s){let r=[];for(const a of s)n(a,8,r);return new M(M.Mode.BYTE,s.length,r)}static makeNumeric(s){if(!M.isNumeric(s))throw new RangeError("String contains non-numeric characters");let r=[];for(let a=0;a<s.length;){const l=Math.min(s.length-a,3);n(parseInt(s.substring(a,a+l),10),l*3+1,r),a+=l}return new M(M.Mode.NUMERIC,s.length,r)}static makeAlphanumeric(s){if(!M.isAlphanumeric(s))throw new RangeError("String contains unencodable characters in alphanumeric mode");let r=[],a;for(a=0;a+2<=s.length;a+=2){let l=M.ALPHANUMERIC_CHARSET.indexOf(s.charAt(a))*45;l+=M.ALPHANUMERIC_CHARSET.indexOf(s.charAt(a+1)),n(l,11,r)}return a<s.length&&n(M.ALPHANUMERIC_CHARSET.indexOf(s.charAt(a)),6,r),new M(M.Mode.ALPHANUMERIC,s.length,r)}static makeSegments(s){return s==""?[]:M.isNumeric(s)?[M.makeNumeric(s)]:M.isAlphanumeric(s)?[M.makeAlphanumeric(s)]:[M.makeBytes(M.toUtf8ByteArray(s))]}static makeEci(s){let r=[];if(s<0)throw new RangeError("ECI assignment value out of range");if(s<128)n(s,8,r);else if(s<16384)n(2,2,r),n(s,14,r);else if(s<1e6)n(6,3,r),n(s,21,r);else throw new RangeError("ECI assignment value out of range");return new M(M.Mode.ECI,0,r)}static isNumeric(s){return M.NUMERIC_REGEX.test(s)}static isAlphanumeric(s){return M.ALPHANUMERIC_REGEX.test(s)}getData(){return this.bitData.slice()}static getTotalBits(s,r){let a=0;for(const l of s){const i=l.mode.numCharCountBits(r);if(l.numChars>=1<<i)return 1/0;a+=4+i+l.bitData.length}return a}static toUtf8ByteArray(s){s=encodeURI(s);let r=[];for(let a=0;a<s.length;a++)s.charAt(a)!="%"?r.push(s.charCodeAt(a)):(r.push(parseInt(s.substring(a+1,a+3),16)),a+=2);return r}};g.NUMERIC_REGEX=/^[0-9]*$/,g.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,g.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let y=g;t.QrSegment=g})(ee||(ee={}));(t=>{(o=>{const n=class{constructor(m,g){this.ordinal=m,this.formatBits=g}};n.LOW=new n(0,1),n.MEDIUM=new n(1,0),n.QUARTILE=new n(2,3),n.HIGH=new n(3,2),o.Ecc=n})(t.QrCode||(t.QrCode={}))})(ee||(ee={}));(t=>{(o=>{const n=class{constructor(m,g){this.modeBits=m,this.numBitsCharCount=g}numCharCountBits(m){return this.numBitsCharCount[Math.floor((m+7)/17)]}};n.NUMERIC=new n(1,[10,12,14]),n.ALPHANUMERIC=new n(2,[9,11,13]),n.BYTE=new n(4,[8,16,16]),n.KANJI=new n(8,[8,10,12]),n.ECI=new n(7,[0,0,0]),o.Mode=n})(t.QrSegment||(t.QrSegment={}))})(ee||(ee={}));var re=ee;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var ja={L:re.QrCode.Ecc.LOW,M:re.QrCode.Ecc.MEDIUM,Q:re.QrCode.Ecc.QUARTILE,H:re.QrCode.Ecc.HIGH},De=128,Oe="L",ze="#FFFFFF",qe="#000000",Be=!1,Ke=1,Na=4,ka=0,Ca=.1;function Qe(t,o=0){const n=[];return t.forEach(function(d,m){let g=null;d.forEach(function(y,p){if(!y&&g!==null){n.push(`M${g+o} ${m+o}h${p-g}v1H${g+o}z`),g=null;return}if(p===d.length-1){if(!y)return;g===null?n.push(`M${p+o},${m+o} h1v1H${p+o}z`):n.push(`M${g+o},${m+o} h${p+1-g}v1H${g+o}z`);return}y&&g===null&&(g=p)})}),n.join("")}function Ue(t,o){return t.slice().map((n,d)=>d<o.y||d>=o.y+o.h?n:n.map((m,g)=>g<o.x||g>=o.x+o.w?m:!1))}function wa(t,o,n,d){if(d==null)return null;const m=t.length+n*2,g=Math.floor(o*Ca),y=m/o,p=(d.width||g)*y,s=(d.height||g)*y,r=d.x==null?t.length/2-p/2:d.x*y,a=d.y==null?t.length/2-s/2:d.y*y,l=d.opacity==null?1:d.opacity;let i=null;if(d.excavate){let c=Math.floor(r),x=Math.floor(a),h=Math.ceil(p+r-c),E=Math.ceil(s+a-x);i={x:c,y:x,w:h,h:E}}const u=d.crossOrigin;return{x:r,y:a,h:s,w:p,excavation:i,opacity:l,crossOrigin:u}}function Sa(t,o){return o!=null?Math.max(Math.floor(o),0):t?Na:ka}function He({value:t,level:o,minVersion:n,includeMargin:d,marginSize:m,imageSettings:g,size:y,boostLevel:p}){let s=R.useMemo(()=>{const c=(Array.isArray(t)?t:[t]).reduce((x,h)=>(x.push(...re.QrSegment.makeSegments(h)),x),[]);return re.QrCode.encodeSegments(c,ja[o],n,void 0,void 0,p)},[t,o,n,p]);const{cells:r,margin:a,numCells:l,calculatedImageSettings:i}=R.useMemo(()=>{let u=s.getModules();const c=Sa(d,m),x=u.length+c*2,h=wa(u,y,c,g);return{cells:u,margin:c,numCells:x,calculatedImageSettings:h}},[s,y,g,d,m]);return{qrcode:s,margin:a,cells:r,numCells:l,calculatedImageSettings:i}}var Ea=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),_a=R.forwardRef(function(o,n){const d=o,{value:m,size:g=De,level:y=Oe,bgColor:p=ze,fgColor:s=qe,includeMargin:r=Be,minVersion:a=Ke,boostLevel:l,marginSize:i,imageSettings:u}=d,x=pe(d,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:h}=x,E=pe(x,["style"]),k=u==null?void 0:u.src,v=R.useRef(null),f=R.useRef(null),_=R.useCallback(L=>{v.current=L,typeof n=="function"?n(L):n&&(n.current=L)},[n]),[I,z]=R.useState(!1),{margin:F,cells:H,numCells:T,calculatedImageSettings:j}=He({value:m,level:y,minVersion:a,boostLevel:l,includeMargin:r,marginSize:i,imageSettings:u,size:g});R.useEffect(()=>{if(v.current!=null){const L=v.current,D=L.getContext("2d");if(!D)return;let Y=H;const W=f.current,V=j!=null&&W!==null&&W.complete&&W.naturalHeight!==0&&W.naturalWidth!==0;V&&j.excavation!=null&&(Y=Ue(H,j.excavation));const ae=window.devicePixelRatio||1;L.height=L.width=g*ae;const se=g/T*ae;D.scale(se,se),D.fillStyle=p,D.fillRect(0,0,T,T),D.fillStyle=s,Ea?D.fill(new Path2D(Qe(Y,F))):H.forEach(function(N,K){N.forEach(function(Z,ge){Z&&D.fillRect(ge+F,K+F,1,1)})}),j&&(D.globalAlpha=j.opacity),V&&D.drawImage(W,j.x+F,j.y+F,j.w,j.h)}}),R.useEffect(()=>{z(!1)},[k]);const q=ye({height:g,width:g},h);let G=null;return k!=null&&(G=R.createElement("img",{src:k,key:k,style:{display:"none"},onLoad:()=>{z(!0)},ref:f,crossOrigin:j==null?void 0:j.crossOrigin})),R.createElement(R.Fragment,null,R.createElement("canvas",ye({style:q,height:g,width:g,ref:_,role:"img"},E)),G)});_a.displayName="QRCodeCanvas";var We=R.forwardRef(function(o,n){const d=o,{value:m,size:g=De,level:y=Oe,bgColor:p=ze,fgColor:s=qe,includeMargin:r=Be,minVersion:a=Ke,boostLevel:l,title:i,marginSize:u,imageSettings:c}=d,x=pe(d,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:h,cells:E,numCells:k,calculatedImageSettings:v}=He({value:m,level:y,minVersion:a,boostLevel:l,includeMargin:r,marginSize:u,imageSettings:c,size:g});let f=E,_=null;c!=null&&v!=null&&(v.excavation!=null&&(f=Ue(E,v.excavation)),_=R.createElement("image",{href:c.src,height:v.h,width:v.w,x:v.x+h,y:v.y+h,preserveAspectRatio:"none",opacity:v.opacity,crossOrigin:v.crossOrigin}));const I=Qe(f,h);return R.createElement("svg",ye({height:g,width:g,viewBox:`0 0 ${k} ${k}`,ref:n,role:"img"},x),!!i&&R.createElement("title",null,i),R.createElement("path",{fill:p,d:`M0,0 h${k}v${k}H0z`,shapeRendering:"crispEdges"}),R.createElement("path",{fill:s,d:I,shapeRendering:"crispEdges"}),_)});We.displayName="QRCodeSVG";const Ma=[{id:"appearance",labelKey:"settings.sections.appearance",icon:Fe},{id:"general",labelKey:"settings.sections.general",icon:ue},{id:"household",labelKey:"settings.sections.household",icon:be},{id:"budget",labelKey:"settings.sections.budget",icon:ve},{id:"categories",labelKey:"settings.sections.categories",icon:xe},{id:"sources",labelKey:"settings.sections.sources",icon:rt},{id:"recurring",labelKey:"settings.sections.recurring",icon:Ot},{id:"notifications",labelKey:"settings.sections.notifications",icon:Ae},{id:"crypto",labelKey:"settings.sections.crypto",icon:nt},{id:"anomaly",labelKey:"anomaly.title",icon:Ne},{id:"export",labelKey:"settings.sections.export",icon:ke}];function Pa(){var ge,Ce;const{t}=B("common"),o=ne(),[n,d]=b.useState("appearance"),[m,g]=b.useState(!1),[y,p]=b.useState(!1),[s,r]=b.useState(!1),[a,l]=b.useState(null),[i,u]=b.useState(null),[c,x]=b.useState(!1),[h,E]=b.useState(!1),[k,v]=b.useState(""),{data:f,isLoading:_}=J({queryKey:["settings"],queryFn:lt}),{data:I}=J({queryKey:["household-profile"],queryFn:Pt}),z=O({mutationFn:Mt,onSuccess:()=>{o.invalidateQueries({queryKey:["household-profile"]}),o.invalidateQueries({queryKey:["benchmark-comparison"]}),we.success(t("settings.profileSaved","Household profile saved successfully"))},onError:S=>{console.error("Failed to save household profile:",S),we.error(t("settings.profileSaveError","Failed to save household profile"))}}),[F,H]=b.useState("JPY"),[T,j]=b.useState(25),[q,G]=b.useState(!1),[L,D]=b.useState(!0),[Y,W]=b.useState(1e6);b.useEffect(()=>{f&&(H(f.currency),j(f.base_date),G(f.budget_carry_over),D(f.budget_email_alerts),W(f.large_transaction_threshold))},[f]),b.useEffect(()=>{if(f){const S=F!==f.currency||T!==f.base_date||q!==f.budget_carry_over||L!==f.budget_email_alerts||Y!==f.large_transaction_threshold;g(S)}},[F,T,q,L,Y,f]);const V=O({mutationFn:st,onSuccess:()=>{o.invalidateQueries({queryKey:["settings"]}),o.invalidateQueries({queryKey:["dashboard-summary"]}),o.invalidateQueries({queryKey:["transactions"]}),o.invalidateQueries({queryKey:["analytics"]}),g(!1)},onError:S=>{console.error("Failed to save settings:",S)}}),ae=()=>{V.mutate({currency:F,base_date:T,budget_carry_over:q,budget_email_alerts:L,large_transaction_threshold:Y})},se=async()=>{p(!0),r(!1);try{await ba(),r(!0),setTimeout(()=>r(!1),3e3)}catch(S){console.error("Export failed:",S)}finally{p(!1)}},N=async()=>{x(!0),l(null),E(!1);try{const S=await fa();l(S.url),u(new Date(S.expiresAt))}catch(S){console.error("Generate link failed:",S)}finally{x(!1)}},K=async()=>{if(a)try{await navigator.clipboard.writeText(a),E(!0),setTimeout(()=>E(!1),2e3)}catch{console.error("Failed to copy link")}};if(b.useEffect(()=>{if(!i)return;const S=setInterval(()=>{const ie=new Date,le=i.getTime()-ie.getTime();if(le<=0){v(""),l(null),u(null),clearInterval(S);return}const $e=Math.floor(le/6e4),Ge=Math.floor(le%6e4/1e3);v(t("settings.export.linkExpires",{minutes:$e,seconds:Ge}))},1e3);return()=>clearInterval(S)},[i,t]),_)return e.jsx("div",{className:"flex justify-center py-12",children:e.jsx($,{size:"lg"})});const Z={JPY:t("settings.currencyJPY"),USD:t("settings.currencyUSD"),VND:t("settings.currencyVND")};return e.jsxs("div",{className:"min-h-screen pb-32",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-4",children:[e.jsxs("h1",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(ue,{className:"w-5 h-5 text-primary-600"}),t("settings.title")]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:t("settings.subtitle")})]}),e.jsx("div",{className:"border-t border-gray-100 dark:border-gray-800",children:e.jsx("div",{className:"max-w-2xl mx-auto px-4",children:e.jsx("div",{className:"flex gap-1 overflow-x-auto py-2 scrollbar-hide -mb-2",children:Ma.map(S=>{const ie=S.icon,le=n===S.id;return e.jsxs("button",{onClick:()=>d(S.id),className:C("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-all",le?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"),children:[e.jsx(ie,{className:"w-3.5 h-3.5"}),t(S.labelKey)]},S.id)})})})})]}),e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-4 space-y-4",children:[e.jsx("div",{className:C("space-y-4",n!=="appearance"&&"hidden"),children:e.jsx(oe,{icon:Fe,title:t("appearance.title","Appearance"),description:t("appearance.subtitle","Theme, colors, and display preferences"),children:e.jsx(ma,{})})}),e.jsx("div",{className:C("space-y-4",n!=="general"&&"hidden"),children:e.jsx(oe,{icon:ue,title:t("settings.general"),description:"Currency and basic preferences",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(de,{label:t("settings.currency"),value:F,onChange:S=>H(S.target.value),options:[{value:"JPY",label:Z.JPY},{value:"USD",label:Z.USD},{value:"VND",label:Z.VND}]}),e.jsx(Q,{type:"number",label:t("settings.payday"),value:T,onChange:S=>j(parseInt(S.target.value,10)),min:1,max:31}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 -mt-2",children:t("settings.paydayDescription")})]})})}),e.jsx("div",{className:C("space-y-4",n!=="household"&&"hidden"),children:e.jsx(oe,{icon:be,title:t("settings.householdProfile","Household Profile"),description:t("settings.householdProfileDescription","Family size, prefecture, and income bracket for spending benchmarks"),children:e.jsx(pa,{profile:I||null,onSave:S=>z.mutate(S),isLoading:z.isPending})})}),e.jsx("div",{className:C("space-y-4",n!=="budget"&&"hidden"),children:e.jsx(oe,{icon:ve,title:t("settings.budgetSettings"),description:"Budget behavior and alerts",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Me,{label:t("settings.budgetCarryOver"),description:t("settings.budgetCarryOverDescription"),checked:q,onChange:G}),e.jsx(Me,{label:t("settings.budgetEmailAlerts"),description:t("settings.budgetEmailAlertsDescription"),checked:L,onChange:D}),e.jsxs("div",{className:"pt-2",children:[e.jsx("label",{className:"font-medium text-gray-900 dark:text-white block mb-2",children:t("settings.largeTransactionThreshold")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:t("settings.largeTransactionThresholdDescription")}),e.jsx(Q,{type:"number",value:Y,onChange:S=>W(parseInt(S.target.value,10)||0),min:0,step:1e5}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:t("settings.largeTransactionThresholdHint")})]})]})})}),e.jsx("div",{className:C("space-y-4",n!=="categories"&&"hidden"),children:e.jsx(sa,{})}),e.jsx("div",{className:C("space-y-4",n!=="sources"&&"hidden"),children:e.jsxs(je,{title:t("settings.paymentSourceManagement"),badge:((ge=f==null?void 0:f.sources)==null?void 0:ge.length)||0,children:[e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:((Ce=f==null?void 0:f.sources)==null?void 0:Ce.map((S,ie)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:S}),e.jsx("button",{className:"text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 text-sm",children:t("settings.delete")})]},ie)))||e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-center py-4",children:t("settings.noSources")})}),e.jsx("div",{className:"mt-4",children:e.jsx(P,{variant:"outline",children:t("settings.addSource")})})]})}),e.jsx("div",{className:C("space-y-4",n!=="recurring"&&"hidden"),children:e.jsx(pt,{})}),e.jsx("div",{className:C("space-y-4",n!=="notifications"&&"hidden"),children:e.jsx(ca,{})}),e.jsx("div",{className:C("space-y-4",n!=="crypto"&&"hidden"),children:e.jsx(ra,{})}),e.jsx("div",{className:C("space-y-4",n!=="anomaly"&&"hidden"),children:e.jsx(na,{})}),e.jsx("div",{className:C("space-y-4",n!=="export"&&"hidden"),children:e.jsx(oe,{icon:ke,title:t("settings.export.title"),description:t("settings.export.description"),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("settings.export.instructions")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{onClick:se,disabled:y,className:"flex-1",size:"lg",children:y?e.jsxs(e.Fragment,{children:[e.jsx($,{size:"sm",className:"mr-2"}),t("settings.export.exporting")]}):e.jsxs(e.Fragment,{children:[e.jsx(Rt,{className:"w-4 h-4 mr-2"}),t("settings.export.button")]})}),e.jsx(P,{onClick:N,disabled:c,variant:"outline",className:"flex-1",size:"lg",children:c?e.jsxs(e.Fragment,{children:[e.jsx($,{size:"sm",className:"mr-2"}),t("settings.export.generatingLink")]}):e.jsxs(e.Fragment,{children:[e.jsx(It,{className:"w-4 h-4 mr-2"}),t("settings.export.generateLink")]})})]}),s&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[e.jsx(ce,{className:"w-4 h-4"}),t("settings.export.success")]}),a&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-green-600 dark:text-green-400",children:[e.jsx(it,{className:"w-4 h-4"}),t("settings.export.linkGenerated")]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:a,className:"flex-1 px-3 py-2 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-gray-100 select-all",onClick:S=>S.target.select()}),e.jsx(P,{onClick:K,variant:"outline",size:"sm",children:h?e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-4 h-4 mr-1"}),t("settings.export.linkCopied")]}):e.jsxs(e.Fragment,{children:[e.jsx(Et,{className:"w-4 h-4 mr-1"}),t("settings.export.copyLink")]})})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"p-3 bg-white rounded-lg",children:e.jsx(We,{value:a,size:180})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t("settings.export.scanQR")})]}),k&&e.jsx("p",{className:"text-xs text-center text-amber-600 dark:text-amber-400",children:k}),!i&&!k&&e.jsx("p",{className:"text-xs text-center text-red-600 dark:text-red-400",children:t("settings.export.linkExpired")})]})]})})}),e.jsx(Jt,{})]}),m&&typeof document<"u"&&fe.createPortal(e.jsx("div",{className:"fixed bottom-20 left-0 right-0 p-4 bg-white/90 dark:bg-gray-900/90 backdrop-blur-lg border-t border-gray-200 dark:border-gray-700 z-40",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(P,{onClick:ae,disabled:V.isPending,className:"w-full",size:"lg",children:V.isPending?e.jsxs(e.Fragment,{children:[e.jsx($,{size:"sm",className:"mr-2"}),t("saving")]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),t("settings.saveSettings")]})})})}),document.body)]})}function oe({icon:t,title:o,description:n,children:d,className:m}){return e.jsxs(U,{className:C("",m),children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-primary-100 dark:bg-primary-900/30 rounded-lg",children:e.jsx(t,{className:"w-5 h-5 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:o}),n&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:n})]})]}),d]})}function Me({label:t,description:o,checked:n,onChange:d}){return e.jsxs("div",{className:"flex items-start justify-between py-1",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("label",{className:"font-medium text-gray-900 dark:text-white block",children:t}),o&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-0.5",children:o})]}),e.jsx("button",{onClick:()=>d(!n),className:C("relative inline-flex h-7 w-12 items-center rounded-full transition-colors flex-shrink-0",n?"bg-primary-600":"bg-gray-300 dark:bg-gray-600"),children:e.jsx("span",{className:C("inline-block h-5 w-5 transform rounded-full bg-white transition-transform shadow-sm",n?"translate-x-6":"translate-x-1")})})]})}const Va=ot("/settings")({component:Pa});export{Va as Route};

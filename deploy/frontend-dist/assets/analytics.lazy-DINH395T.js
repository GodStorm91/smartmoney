import{j as t,a as Pt,f as Ot,e as Rt}from"./vendor-router-DONIM_LE.js";import{r as M}from"./vendor-react-Cwh1aMWO.js";import{u as me,b as zt,c as Re}from"./vendor-query-B0NEAgzV.js";import{C as O,v as fe,M as ut,A as mt,aN as D,b9 as ft,B as J,j as R,aM as Bt,ba as xt,m as $t,L as Vt,g as gt,ao as qt,n as ht,aQ as Ht,a7 as ze,aC as Kt,bb as Gt,t as pt,S as Ee,R as Ut,al as Yt,aq as yt,bc as Qt,bd as Jt,be as Xt,b8 as Zt,bf as Wt,bg as ye,N as en,bh as tn,ar as nn}from"./index-8QQOl6s4.js";import{IncomeExpenseBarChart as bt}from"./IncomeExpenseBarChart-Dmq1ZIYG.js";import{CategoryBarChart as jt}from"./CategoryBarChart-3SeiRIgJ.js";import{TrendLineChart as sn}from"./TrendLineChart-BSw_Z91Z.js";import{CashFlowSummary as rn}from"./CashFlowSummary-Di3qOs_8.js";import{ZoomableChart as Oe}from"./ZoomableChart-Dmt_lPgt.js";import{u as z}from"./vendor-i18n-CNDlYvyf.js";import{c as st,a as rt,A as an,b as on}from"./ai-categorization-service-nsgEVAt3.js";import{a as at,s as Ie,e as cn,b as _e}from"./subMonths-CTyB0oZK.js";import{D as ln}from"./download-BM16G5XZ.js";import{M as dn}from"./mail-CjZANIxp.js";import{c as un}from"./vendor-charts-BwEA5mzu.js";import"./minus-FWrj25id.js";const mn={spike:"ðŸ“ˆ",trend:"ðŸ“Š",unusual:"ðŸ”",budget:"ðŸ’°",saving:"âœ¨"},fn={info:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",warning:"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800",success:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800"},xn={info:"text-blue-700 dark:text-blue-300",warning:"text-amber-700 dark:text-amber-300",success:"text-green-700 dark:text-green-300"};function gn({insight:e}){const{currency:n}=ut(),{data:s}=mt();return t.jsx("div",{className:`p-4 rounded-lg border ${fn[e.severity]} transition-all hover:shadow-sm`,children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("span",{className:"text-2xl",children:mn[e.type]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:`font-medium ${xn[e.severity]}`,children:e.title}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.message}),e.amount&&t.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mt-2",children:D(e.amount,n,(s==null?void 0:s.rates)||{},!1)})]}),e.percentage_change!==void 0&&t.jsxs("span",{className:`text-sm font-medium px-2 py-1 rounded ${e.percentage_change>0?"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400":"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400"}`,children:[e.percentage_change>0?"+":"",e.percentage_change.toFixed(0),"%"]})]})})}function hn(){const{t:e}=z("common"),{data:n,isLoading:s,error:a}=me({queryKey:["spending-insights"],queryFn:ft,staleTime:5*60*1e3});if(s)return t.jsxs(O,{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:e("analytics.spendingInsights","Spending Insights")}),t.jsx("div",{className:"flex justify-center py-8",children:t.jsx(fe,{size:"md"})})]});if(a)return t.jsxs(O,{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:e("analytics.spendingInsights","Spending Insights")}),t.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:e("error","Failed to load insights")})]});const o=(n==null?void 0:n.insights)||[];return t.jsxs(O,{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:e("analytics.spendingInsights","Spending Insights")}),o.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("span",{className:"text-4xl mb-3 block",children:"ðŸŽ‰"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e("analytics.noInsights","No notable spending patterns detected")}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:e("analytics.insightsHint","Keep tracking to see personalized insights")})]}):t.jsx("div",{className:"space-y-3",children:o.map((i,r)=>t.jsx(gn,{insight:i},`${i.type}-${i.category}-${r}`))})]})}const Ce=50,pn=.5;function yn({suggestion:e,isSelected:n,onToggle:s}){const{currency:a}=ut(),{data:o}=mt(),{t:i}=z("common"),r=e.confidence>=.8?"text-green-600 dark:text-green-400":e.confidence>=.6?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400";return t.jsxs("div",{className:`p-3 rounded-lg border transition-colors cursor-pointer ${n?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,onClick:()=>s(e.transaction_id,e.suggested_category),children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:e.description}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:D(e.amount,a,(o==null?void 0:o.rates)||{},!1)})]}),t.jsxs("div",{className:"text-right flex-shrink-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[e.is_new_category&&t.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded",children:i("ai.newCategory")}),t.jsx("span",{className:"text-sm font-medium text-primary-600 dark:text-primary-400",children:e.suggested_category})]}),t.jsxs("p",{className:`text-xs mt-1 ${r}`,children:[Math.round(e.confidence*100),"% ",i("ai.confidence")]})]})]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 italic",children:e.reason})]})}function bn(){const{t:e,i18n:n}=z("common"),s=zt(),[a,o]=M.useState(null),[i,r]=M.useState(new Map),[l,c]=M.useState(!0),[d,h]=M.useState(0),[f,u]=M.useState(null),b=M.useRef(!1),m=Re({mutationFn:()=>st(Ce,n.language),onSuccess:y=>{o(y),h(y.total_other_count);const k=new Map;y.suggestions.forEach(w=>{w.confidence>=.7&&k.set(w.transaction_id,w.suggested_category)}),r(k)}}),g=Re({mutationFn:()=>rt({approved:Array.from(i.entries()).map(([y,k])=>({transaction_id:y,category:k})),create_rules:l}),onSuccess:()=>{s.invalidateQueries({queryKey:["analytics"]}),s.invalidateQueries({queryKey:["transactions"]});const y=d-i.size;y>0?(h(y),o(null),r(new Map),setTimeout(()=>m.mutate(),500)):(o(null),r(new Map),h(0))}}),p=M.useCallback(async()=>{b.current=!1;const y=Math.ceil(d/Ce);let k=0;u({isRunning:!0,processed:0,total:d,currentBatch:0,totalBatches:y});for(let w=0;w<y&&!b.current;w++){u(C=>C?{...C,currentBatch:w+1}:null);try{const C=await st(Ce,n.language);if(C.suggestions.length===0||b.current)break;const E=C.suggestions.filter(A=>A.confidence>=.7).map(A=>({transaction_id:A.transaction_id,category:A.suggested_category}));E.length>0&&(await rt({approved:E,create_rules:l}),k+=E.length),u(A=>A?{...A,processed:k}:null),await new Promise(A=>setTimeout(A,300))}catch{break}}u(null),s.invalidateQueries({queryKey:["analytics"]}),s.invalidateQueries({queryKey:["transactions"]}),o(null),h(0)},[d,n.language,l,s]),x=()=>{b.current=!0,u(null)},j=(y,k)=>{r(w=>{const C=new Map(w);return C.has(y)?C.delete(y):C.set(y,k),C})},N=()=>{if(!a)return;const y=new Map;a.suggestions.forEach(k=>{y.set(k.transaction_id,k.suggested_category)}),r(y)},S=()=>{r(new Map)};if(f!=null&&f.isRunning){const y=f.total>0?Math.round(f.processed/f.total*100):0;return t.jsx(O,{children:t.jsxs("div",{className:"py-8",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 text-center mb-4",children:e("ai.processingAll")}),t.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 mb-2",children:t.jsx("div",{className:"bg-primary-500 h-4 rounded-full transition-[width] duration-300",style:{width:`${y}%`}})}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center mb-4",children:e("ai.processProgress",{processed:f.processed,total:f.total,batch:f.currentBatch,totalBatches:f.totalBatches})}),t.jsx("div",{className:"text-center",children:t.jsx(J,{variant:"outline",onClick:x,children:e("cancel")})})]})})}if(!a){const y=d,k=y>250,w=Math.ceil(y/Ce)*pn;return t.jsxs(O,{children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:e("ai.categoryCleanup")}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e("ai.categoryCleanupDesc")}),y>0&&t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:e("ai.remainingOther",{count:y})})]}),t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.jsx(J,{onClick:()=>m.mutate(),disabled:m.isPending,children:m.isPending?t.jsxs(t.Fragment,{children:[t.jsx(fe,{size:"sm",className:"mr-2"}),e("ai.analyzing")]}):e("ai.analyzeOther")}),k&&t.jsx(J,{variant:"outline",onClick:p,disabled:m.isPending,title:e("ai.analyzeAllCredits",{credits:w.toFixed(1)}),children:e("ai.analyzeAll",{count:y})})]})]}),m.isError&&t.jsx("div",{className:"text-sm text-red-600 dark:text-red-400",children:e("ai.analyzeError")})]})}if(a.suggestions.length===0)return t.jsx(O,{children:t.jsxs("div",{className:"text-center py-8",children:[t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:e("ai.noSuggestions")}),t.jsx(J,{variant:"outline",onClick:()=>o(null),className:"mt-4",children:e("close")})]})});const I=d-a.suggestions.length,_=I>250;return t.jsxs(O,{children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:e("ai.categoryCleanup")}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e("ai.foundSuggestions",{count:a.suggestions.length,total:d})})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(J,{variant:"outline",size:"sm",onClick:N,children:e("ai.selectAll")}),t.jsx(J,{variant:"outline",size:"sm",onClick:S,children:e("ai.deselectAll")})]})]}),a.new_categories_suggested.length>0&&t.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:t.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e("ai.newCategoriesSuggested"),": ",a.new_categories_suggested.join(", ")]})}),t.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:a.suggestions.map(y=>t.jsx(yn,{suggestion:y,isSelected:i.has(y.transaction_id),onToggle:j},y.transaction_id))}),t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[t.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("input",{type:"checkbox",checked:l,onChange:y=>c(y.target.checked),className:"rounded border-gray-300 dark:border-gray-600"}),e("ai.createRulesAuto")]}),t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.jsx(J,{variant:"outline",onClick:()=>o(null),children:e("cancel")}),_&&t.jsx(J,{variant:"outline",onClick:p,disabled:g.isPending,children:e("ai.analyzeAll",{count:I})}),t.jsx(J,{onClick:()=>g.mutate(),disabled:i.size===0||g.isPending,children:g.isPending?t.jsxs(t.Fragment,{children:[t.jsx(fe,{size:"sm",className:"mr-2"}),e("ai.applying")]}):e("ai.applySelected",{count:i.size})})]})]}),g.isError&&t.jsx("div",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:e("ai.applyError")})]})]})}function re({label:e,value:n,change:s,trend:a="neutral",subtitle:o,className:i,hero:r=!1}){const{t:l}=z("common"),c=()=>a==="positive"?"text-income-600 dark:text-income-300":a==="negative"?"text-expense-600 dark:text-expense-300":"text-gray-500 dark:text-gray-400",d=()=>s==null?null:s>0?"â†‘":s<0?"â†“":"â†’";return t.jsxs("div",{className:R("bg-white dark:bg-gray-800 rounded-xl p-4 shadow-card","border border-gray-100 dark:border-gray-700",i),children:[t.jsx("p",{className:"text-[11px] font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400 mb-1.5",children:e}),t.jsx("p",{className:R("font-extrabold tracking-tight text-gray-900 dark:text-gray-100 font-numbers truncate",r?"text-3xl sm:text-4xl tracking-tighter":"text-2xl"),children:n}),s!=null&&t.jsxs("div",{className:R("flex items-center gap-1.5 mt-1.5",c()),children:[t.jsxs("span",{className:"text-sm font-semibold",children:[d()," ",Math.abs(s).toFixed(1),"%"]}),t.jsx("span",{className:"text-xs text-gray-400",children:l("analytics.vsLastPeriod")})]}),o&&t.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mt-1.5 truncate",children:o})]})}function jn({analytics:e,displayCurrency:n="JPY"}){const{t:s}=z("common"),{total_income:a,total_expense:o,net_cashflow:i,comparison:r,top_category:l}=e,c=()=>r!=null&&r.income_change?r.income_change>0?"positive":"negative":"neutral",d=()=>r!=null&&r.expense_change?r.expense_change<0?"positive":"negative":"neutral",h=()=>r!=null&&r.net_change?r.net_change>0?"positive":"negative":"neutral";return t.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[t.jsx(re,{label:s("analytics.heroNet"),value:D(i,n),change:r==null?void 0:r.net_change,trend:h(),hero:!0,className:"col-span-2 bg-hero-gradient"}),t.jsx(re,{label:s("analytics.heroIncome"),value:D(a,n),change:r==null?void 0:r.income_change,trend:c(),className:"bg-income-50/50 dark:bg-income-900/10 border-income-100 dark:border-income-900/20"}),t.jsx(re,{label:s("analytics.heroExpense"),value:D(o,n),change:r==null?void 0:r.expense_change,trend:d(),className:"bg-expense-50/50 dark:bg-expense-900/10 border-expense-100 dark:border-expense-900/20"}),t.jsx(re,{label:s("analytics.heroTopCategory"),value:(l==null?void 0:l.name)||"-",subtitle:l?`${D(l.amount,n)} (${l.percentage}%)`:void 0,className:"col-span-2"})]})}function vn(e){return Object.prototype.toString.call(e)==="[object Object]"}function ot(e){return vn(e)||Array.isArray(e)}function Nn(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function qe(e,n){const s=Object.keys(e),a=Object.keys(n);if(s.length!==a.length)return!1;const o=JSON.stringify(Object.keys(e.breakpoints||{})),i=JSON.stringify(Object.keys(n.breakpoints||{}));return o!==i?!1:s.every(r=>{const l=e[r],c=n[r];return typeof l=="function"?`${l}`==`${c}`:!ot(l)||!ot(c)?l===c:qe(l,c)})}function ct(e){return e.concat().sort((n,s)=>n.name>s.name?1:-1).map(n=>n.options)}function kn(e,n){if(e.length!==n.length)return!1;const s=ct(e),a=ct(n);return s.every((o,i)=>{const r=a[i];return qe(o,r)})}function He(e){return typeof e=="number"}function Be(e){return typeof e=="string"}function Te(e){return typeof e=="boolean"}function it(e){return Object.prototype.toString.call(e)==="[object Object]"}function F(e){return Math.abs(e)}function Ke(e){return Math.sign(e)}function je(e,n){return F(e-n)}function wn(e,n){if(e===0||n===0||F(e)<=F(n))return 0;const s=je(F(e),F(n));return F(s/e)}function Sn(e){return Math.round(e*100)/100}function ve(e){return Ne(e).map(Number)}function H(e){return e[we(e)]}function we(e){return Math.max(0,e.length-1)}function Ge(e,n){return n===we(e)}function lt(e,n=0){return Array.from(Array(e),(s,a)=>n+a)}function Ne(e){return Object.keys(e)}function vt(e,n){return[e,n].reduce((s,a)=>(Ne(a).forEach(o=>{const i=s[o],r=a[o],l=it(i)&&it(r);s[o]=l?vt(i,r):r}),s),{})}function $e(e,n){return typeof n.MouseEvent<"u"&&e instanceof n.MouseEvent}function _n(e,n){const s={start:a,center:o,end:i};function a(){return 0}function o(c){return i(c)/2}function i(c){return n-c}function r(c,d){return Be(e)?s[e](c):e(n,c,d)}return{measure:r}}function ke(){let e=[];function n(o,i,r,l={passive:!0}){let c;if("addEventListener"in o)o.addEventListener(i,r,l),c=()=>o.removeEventListener(i,r,l);else{const d=o;d.addListener(r),c=()=>d.removeListener(r)}return e.push(c),a}function s(){e=e.filter(o=>o())}const a={add:n,clear:s};return a}function Cn(e,n,s,a){const o=ke(),i=1e3/60;let r=null,l=0,c=0;function d(){o.add(e,"visibilitychange",()=>{e.hidden&&m()})}function h(){b(),o.clear()}function f(p){if(!c)return;r||(r=p,s(),s());const x=p-r;for(r=p,l+=x;l>=i;)s(),l-=i;const j=l/i;a(j),c&&(c=n.requestAnimationFrame(f))}function u(){c||(c=n.requestAnimationFrame(f))}function b(){n.cancelAnimationFrame(c),r=null,l=0,c=0}function m(){r=null,l=0}return{init:d,destroy:h,start:u,stop:b,update:s,render:a}}function En(e,n){const s=n==="rtl",a=e==="y",o=a?"y":"x",i=a?"x":"y",r=!a&&s?-1:1,l=h(),c=f();function d(m){const{height:g,width:p}=m;return a?g:p}function h(){return a?"top":s?"right":"left"}function f(){return a?"bottom":s?"left":"right"}function u(m){return m*r}return{scroll:o,cross:i,startEdge:l,endEdge:c,measureSize:d,direction:u}}function ie(e=0,n=0){const s=F(e-n);function a(d){return d<e}function o(d){return d>n}function i(d){return a(d)||o(d)}function r(d){return i(d)?a(d)?e:n:d}function l(d){return s?d-s*Math.ceil((d-n)/s):d}return{length:s,max:n,min:e,constrain:r,reachedAny:i,reachedMax:o,reachedMin:a,removeOffset:l}}function Nt(e,n,s){const{constrain:a}=ie(0,e),o=e+1;let i=r(n);function r(u){return s?F((o+u)%o):a(u)}function l(){return i}function c(u){return i=r(u),f}function d(u){return h().set(l()+u)}function h(){return Nt(e,l(),s)}const f={get:l,set:c,add:d,clone:h};return f}function In(e,n,s,a,o,i,r,l,c,d,h,f,u,b,m,g,p,x,j){const{cross:N,direction:S}=e,I=["INPUT","SELECT","TEXTAREA"],_={passive:!1},y=ke(),k=ke(),w=ie(50,225).constrain(b.measure(20)),C={mouse:300,touch:400},E={mouse:500,touch:600},A=m?43:25;let K=!1,G=0,U=0,ae=!1,ne=!1,X=!1,Z=!1;function xe(v){if(!j)return;function T($){(Te(j)||j(v,$))&&he($)}const P=n;y.add(P,"dragstart",$=>$.preventDefault(),_).add(P,"touchmove",()=>{},_).add(P,"touchend",()=>{}).add(P,"touchstart",T).add(P,"mousedown",T).add(P,"touchcancel",B).add(P,"contextmenu",B).add(P,"click",ee,!0)}function Y(){y.clear(),k.clear()}function le(){const v=Z?s:n;k.add(v,"touchmove",V,_).add(v,"touchend",B).add(v,"mousemove",V,_).add(v,"mouseup",B)}function de(v){const T=v.nodeName||"";return I.includes(T)}function W(){return(m?E:C)[Z?"mouse":"touch"]}function ge(v,T){const P=f.add(Ke(v)*-1),$=h.byDistance(v,!m).distance;return m||F(v)<w?$:p&&T?$*.5:h.byIndex(P.get(),0).distance}function he(v){const T=$e(v,a);Z=T,X=m&&T&&!v.buttons&&K,K=je(o.get(),r.get())>=2,!(T&&v.button!==0)&&(de(v.target)||(ae=!0,i.pointerDown(v),d.useFriction(0).useDuration(0),o.set(r),le(),G=i.readPoint(v),U=i.readPoint(v,N),u.emit("pointerDown")))}function V(v){if(!$e(v,a)&&v.touches.length>=2)return B(v);const P=i.readPoint(v),$=i.readPoint(v,N),Q=je(P,G),te=je($,U);if(!ne&&!Z&&(!v.cancelable||(ne=Q>te,!ne)))return B(v);const oe=i.pointerMove(v);Q>g&&(X=!0),d.useFriction(.3).useDuration(.75),l.start(),o.add(S(oe)),v.preventDefault()}function B(v){const P=h.byDistance(0,!1).index!==f.get(),$=i.pointerUp(v)*W(),Q=ge(S($),P),te=wn($,Q),oe=A-10*te,se=x+te/50;ne=!1,ae=!1,k.clear(),d.useDuration(oe).useFriction(se),c.distance(Q,!m),Z=!1,u.emit("pointerUp")}function ee(v){X&&(v.stopPropagation(),v.preventDefault(),X=!1)}function q(){return ae}return{init:xe,destroy:Y,pointerDown:q}}function Mn(e,n){let a,o;function i(f){return f.timeStamp}function r(f,u){const m=`client${(u||e.scroll)==="x"?"X":"Y"}`;return($e(f,n)?f:f.touches[0])[m]}function l(f){return a=f,o=f,r(f)}function c(f){const u=r(f)-r(o),b=i(f)-i(a)>170;return o=f,b&&(a=f),u}function d(f){if(!a||!o)return 0;const u=r(o)-r(a),b=i(f)-i(a),m=i(f)-i(o)>170,g=u/b;return b&&!m&&F(g)>.1?g:0}return{pointerDown:l,pointerMove:c,pointerUp:d,readPoint:r}}function Tn(){function e(s){const{offsetTop:a,offsetLeft:o,offsetWidth:i,offsetHeight:r}=s;return{top:a,right:o+i,bottom:a+r,left:o,width:i,height:r}}return{measure:e}}function An(e){function n(a){return e*(a/100)}return{measure:n}}function Ln(e,n,s,a,o,i,r){const l=[e].concat(a);let c,d,h=[],f=!1;function u(p){return o.measureSize(r.measure(p))}function b(p){if(!i)return;d=u(e),h=a.map(u);function x(j){for(const N of j){if(f)return;const S=N.target===e,I=a.indexOf(N.target),_=S?d:h[I],y=u(S?e:a[I]);if(F(y-_)>=.5){p.reInit(),n.emit("resize");break}}}c=new ResizeObserver(j=>{(Te(i)||i(p,j))&&x(j)}),s.requestAnimationFrame(()=>{l.forEach(j=>c.observe(j))})}function m(){f=!0,c&&c.disconnect()}return{init:b,destroy:m}}function Fn(e,n,s,a,o,i){let r=0,l=0,c=o,d=i,h=e.get(),f=0;function u(){const _=a.get()-e.get(),y=!c;let k=0;return y?(r=0,s.set(a),e.set(a),k=_):(s.set(e),r+=_/c,r*=d,h+=r,e.add(r),k=h-f),l=Ke(k),f=h,I}function b(){const _=a.get()-n.get();return F(_)<.001}function m(){return c}function g(){return l}function p(){return r}function x(){return N(o)}function j(){return S(i)}function N(_){return c=_,I}function S(_){return d=_,I}const I={direction:g,duration:m,velocity:p,seek:u,settled:b,useBaseFriction:j,useBaseDuration:x,useFriction:S,useDuration:N};return I}function Dn(e,n,s,a,o){const i=o.measure(10),r=o.measure(50),l=ie(.1,.99);let c=!1;function d(){return!(c||!e.reachedAny(s.get())||!e.reachedAny(n.get()))}function h(b){if(!d())return;const m=e.reachedMin(n.get())?"min":"max",g=F(e[m]-n.get()),p=s.get()-n.get(),x=l.constrain(g/r);s.subtract(p*x),!b&&F(p)<i&&(s.set(e.constrain(s.get())),a.useDuration(25).useBaseFriction())}function f(b){c=!b}return{shouldConstrain:d,constrain:h,toggleActive:f}}function Pn(e,n,s,a,o){const i=ie(-n+e,0),r=f(),l=h(),c=u();function d(m,g){return je(m,g)<=1}function h(){const m=r[0],g=H(r),p=r.lastIndexOf(m),x=r.indexOf(g)+1;return ie(p,x)}function f(){return s.map((m,g)=>{const{min:p,max:x}=i,j=i.constrain(m),N=!g,S=Ge(s,g);return N?x:S||d(p,j)?p:d(x,j)?x:j}).map(m=>parseFloat(m.toFixed(3)))}function u(){if(n<=e+o)return[i.max];if(a==="keepSnaps")return r;const{min:m,max:g}=l;return r.slice(m,g)}return{snapsContained:c,scrollContainLimit:l}}function On(e,n,s){const a=n[0],o=s?a-e:H(n);return{limit:ie(o,a)}}function Rn(e,n,s,a){const i=n.min+.1,r=n.max+.1,{reachedMin:l,reachedMax:c}=ie(i,r);function d(u){return u===1?c(s.get()):u===-1?l(s.get()):!1}function h(u){if(!d(u))return;const b=e*(u*-1);a.forEach(m=>m.add(b))}return{loop:h}}function zn(e){const{max:n,length:s}=e;function a(i){const r=i-n;return s?r/-s:0}return{get:a}}function Bn(e,n,s,a,o){const{startEdge:i,endEdge:r}=e,{groupSlides:l}=o,c=f().map(n.measure),d=u(),h=b();function f(){return l(a).map(g=>H(g)[r]-g[0][i]).map(F)}function u(){return a.map(g=>s[i]-g[i]).map(g=>-F(g))}function b(){return l(d).map(g=>g[0]).map((g,p)=>g+c[p])}return{snaps:d,snapsAligned:h}}function $n(e,n,s,a,o,i){const{groupSlides:r}=o,{min:l,max:c}=a,d=h();function h(){const u=r(i),b=!e||n==="keepSnaps";return s.length===1?[i]:b?u:u.slice(l,c).map((m,g,p)=>{const x=!g,j=Ge(p,g);if(x){const N=H(p[0])+1;return lt(N)}if(j){const N=we(i)-H(p)[0]+1;return lt(N,H(p)[0])}return m})}return{slideRegistry:d}}function Vn(e,n,s,a,o){const{reachedAny:i,removeOffset:r,constrain:l}=a;function c(m){return m.concat().sort((g,p)=>F(g)-F(p))[0]}function d(m){const g=e?r(m):l(m),p=n.map((j,N)=>({diff:h(j-g,0),index:N})).sort((j,N)=>F(j.diff)-F(N.diff)),{index:x}=p[0];return{index:x,distance:g}}function h(m,g){const p=[m,m+s,m-s];if(!e)return m;if(!g)return c(p);const x=p.filter(j=>Ke(j)===g);return x.length?c(x):H(p)-s}function f(m,g){const p=n[m]-o.get(),x=h(p,g);return{index:m,distance:x}}function u(m,g){const p=o.get()+m,{index:x,distance:j}=d(p),N=!e&&i(p);if(!g||N)return{index:x,distance:m};const S=n[x]-j,I=m+h(S,0);return{index:x,distance:I}}return{byDistance:u,byIndex:f,shortcut:h}}function qn(e,n,s,a,o,i,r){function l(f){const u=f.distance,b=f.index!==n.get();i.add(u),u&&(a.duration()?e.start():(e.update(),e.render(1),e.update())),b&&(s.set(n.get()),n.set(f.index),r.emit("select"))}function c(f,u){const b=o.byDistance(f,u);l(b)}function d(f,u){const b=n.clone().set(f),m=o.byIndex(b.get(),u);l(m)}return{distance:c,index:d}}function Hn(e,n,s,a,o,i,r,l){const c={passive:!0,capture:!0};let d=0;function h(b){if(!l)return;function m(g){if(new Date().getTime()-d>10)return;r.emit("slideFocusStart"),e.scrollLeft=0;const j=s.findIndex(N=>N.includes(g));He(j)&&(o.useDuration(0),a.index(j,0),r.emit("slideFocus"))}i.add(document,"keydown",f,!1),n.forEach((g,p)=>{i.add(g,"focus",x=>{(Te(l)||l(b,x))&&m(p)},c)})}function f(b){b.code==="Tab"&&(d=new Date().getTime())}return{init:h}}function be(e){let n=e;function s(){return n}function a(c){n=r(c)}function o(c){n+=r(c)}function i(c){n-=r(c)}function r(c){return He(c)?c:c.get()}return{get:s,set:a,add:o,subtract:i}}function kt(e,n){const s=e.scroll==="x"?r:l,a=n.style;let o=null,i=!1;function r(u){return`translate3d(${u}px,0px,0px)`}function l(u){return`translate3d(0px,${u}px,0px)`}function c(u){if(i)return;const b=Sn(e.direction(u));b!==o&&(a.transform=s(b),o=b)}function d(u){i=!u}function h(){i||(a.transform="",n.getAttribute("style")||n.removeAttribute("style"))}return{clear:h,to:c,toggleActive:d}}function Kn(e,n,s,a,o,i,r,l,c){const h=ve(o),f=ve(o).reverse(),u=x().concat(j());function b(y,k){return y.reduce((w,C)=>w-o[C],k)}function m(y,k){return y.reduce((w,C)=>b(w,k)>0?w.concat([C]):w,[])}function g(y){return i.map((k,w)=>({start:k-a[w]+.5+y,end:k+n-.5+y}))}function p(y,k,w){const C=g(k);return y.map(E=>{const A=w?0:-s,K=w?s:0,G=w?"end":"start",U=C[E][G];return{index:E,loopPoint:U,slideLocation:be(-1),translate:kt(e,c[E]),target:()=>l.get()>U?A:K}})}function x(){const y=r[0],k=m(f,y);return p(k,s,!1)}function j(){const y=n-r[0]-1,k=m(h,y);return p(k,-s,!0)}function N(){return u.every(({index:y})=>{const k=h.filter(w=>w!==y);return b(k,n)<=.1})}function S(){u.forEach(y=>{const{target:k,translate:w,slideLocation:C}=y,E=k();E!==C.get()&&(w.to(E),C.set(E))})}function I(){u.forEach(y=>y.translate.clear())}return{canLoop:N,clear:I,loop:S,loopPoints:u}}function Gn(e,n,s){let a,o=!1;function i(c){if(!s)return;function d(h){for(const f of h)if(f.type==="childList"){c.reInit(),n.emit("slidesChanged");break}}a=new MutationObserver(h=>{o||(Te(s)||s(c,h))&&d(h)}),a.observe(e,{childList:!0})}function r(){a&&a.disconnect(),o=!0}return{init:i,destroy:r}}function Un(e,n,s,a){const o={};let i=null,r=null,l,c=!1;function d(){l=new IntersectionObserver(m=>{c||(m.forEach(g=>{const p=n.indexOf(g.target);o[p]=g}),i=null,r=null,s.emit("slidesInView"))},{root:e.parentElement,threshold:a}),n.forEach(m=>l.observe(m))}function h(){l&&l.disconnect(),c=!0}function f(m){return Ne(o).reduce((g,p)=>{const x=parseInt(p),{isIntersecting:j}=o[x];return(m&&j||!m&&!j)&&g.push(x),g},[])}function u(m=!0){if(m&&i)return i;if(!m&&r)return r;const g=f(m);return m&&(i=g),m||(r=g),g}return{init:d,destroy:h,get:u}}function Yn(e,n,s,a,o,i){const{measureSize:r,startEdge:l,endEdge:c}=e,d=s[0]&&o,h=m(),f=g(),u=s.map(r),b=p();function m(){if(!d)return 0;const j=s[0];return F(n[l]-j[l])}function g(){if(!d)return 0;const j=i.getComputedStyle(H(a));return parseFloat(j.getPropertyValue(`margin-${c}`))}function p(){return s.map((j,N,S)=>{const I=!N,_=Ge(S,N);return I?u[N]+h:_?u[N]+f:S[N+1][l]-j[l]}).map(F)}return{slideSizes:u,slideSizesWithGaps:b,startGap:h,endGap:f}}function Qn(e,n,s,a,o,i,r,l,c){const{startEdge:d,endEdge:h,direction:f}=e,u=He(s);function b(x,j){return ve(x).filter(N=>N%j===0).map(N=>x.slice(N,N+j))}function m(x){return x.length?ve(x).reduce((j,N,S)=>{const I=H(j)||0,_=I===0,y=N===we(x),k=o[d]-i[I][d],w=o[d]-i[N][h],C=!a&&_?f(r):0,E=!a&&y?f(l):0,A=F(w-E-(k+C));return S&&A>n+c&&j.push(N),y&&j.push(x.length),j},[]).map((j,N,S)=>{const I=Math.max(S[N-1]||0);return x.slice(I,j)}):[]}function g(x){return u?b(x,s):m(x)}return{groupSlides:g}}function Jn(e,n,s,a,o,i,r){const{align:l,axis:c,direction:d,startIndex:h,loop:f,duration:u,dragFree:b,dragThreshold:m,inViewThreshold:g,slidesToScroll:p,skipSnaps:x,containScroll:j,watchResize:N,watchSlides:S,watchDrag:I,watchFocus:_}=i,y=2,k=Tn(),w=k.measure(n),C=s.map(k.measure),E=En(c,d),A=E.measureSize(w),K=An(A),G=_n(l,A),U=!f&&!!j,ae=f||!!j,{slideSizes:ne,slideSizesWithGaps:X,startGap:Z,endGap:xe}=Yn(E,w,C,s,ae,o),Y=Qn(E,A,p,f,w,C,Z,xe,y),{snaps:le,snapsAligned:de}=Bn(E,G,w,C,Y),W=-H(le)+H(X),{snapsContained:ge,scrollContainLimit:he}=Pn(A,W,de,j,y),V=U?ge:de,{limit:B}=On(W,V,f),ee=Nt(we(V),h,f),q=ee.clone(),L=ve(s),v=({dragHandler:ue,scrollBody:De,scrollBounds:Pe,options:{loop:Se}})=>{Se||Pe.constrain(ue.pointerDown()),De.seek()},T=({scrollBody:ue,translate:De,location:Pe,offsetLocation:Se,previousLocation:Et,scrollLooper:It,slideLooper:Mt,dragHandler:Tt,animation:At,eventHandler:Xe,scrollBounds:Lt,options:{loop:Ze}},We)=>{const et=ue.settled(),Ft=!Lt.shouldConstrain(),tt=Ze?et:et&&Ft,nt=tt&&!Tt.pointerDown();nt&&At.stop();const Dt=Pe.get()*We+Et.get()*(1-We);Se.set(Dt),Ze&&(It.loop(ue.direction()),Mt.loop()),De.to(Se.get()),nt&&Xe.emit("settle"),tt||Xe.emit("scroll")},P=Cn(a,o,()=>v(Fe),ue=>T(Fe,ue)),$=.68,Q=V[ee.get()],te=be(Q),oe=be(Q),se=be(Q),ce=be(Q),pe=Fn(te,se,oe,ce,u,$),Ae=Vn(f,V,W,B,ce),Le=qn(P,ee,q,pe,Ae,ce,r),Ye=zn(B),Qe=ke(),_t=Un(n,s,r,g),{slideRegistry:Je}=$n(U,j,V,he,Y,L),Ct=Hn(e,s,Je,Le,pe,Qe,r,_),Fe={ownerDocument:a,ownerWindow:o,eventHandler:r,containerRect:w,slideRects:C,animation:P,axis:E,dragHandler:In(E,e,a,o,ce,Mn(E,o),te,P,Le,pe,Ae,ee,r,K,b,m,x,$,I),eventStore:Qe,percentOfView:K,index:ee,indexPrevious:q,limit:B,location:te,offsetLocation:se,previousLocation:oe,options:i,resizeHandler:Ln(n,r,o,s,E,N,k),scrollBody:pe,scrollBounds:Dn(B,se,ce,pe,K),scrollLooper:Rn(W,B,se,[te,se,oe,ce]),scrollProgress:Ye,scrollSnapList:V.map(Ye.get),scrollSnaps:V,scrollTarget:Ae,scrollTo:Le,slideLooper:Kn(E,A,W,ne,X,le,V,se,s),slideFocus:Ct,slidesHandler:Gn(n,r,S),slidesInView:_t,slideIndexes:L,slideRegistry:Je,slidesToScroll:Y,target:ce,translate:kt(E,n)};return Fe}function Xn(){let e={},n;function s(d){n=d}function a(d){return e[d]||[]}function o(d){return a(d).forEach(h=>h(n,d)),c}function i(d,h){return e[d]=a(d).concat([h]),c}function r(d,h){return e[d]=a(d).filter(f=>f!==h),c}function l(){e={}}const c={init:s,emit:o,off:r,on:i,clear:l};return c}const Zn={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function Wn(e){function n(i,r){return vt(i,r||{})}function s(i){const r=i.breakpoints||{},l=Ne(r).filter(c=>e.matchMedia(c).matches).map(c=>r[c]).reduce((c,d)=>n(c,d),{});return n(i,l)}function a(i){return i.map(r=>Ne(r.breakpoints||{})).reduce((r,l)=>r.concat(l),[]).map(e.matchMedia)}return{mergeOptions:n,optionsAtMedia:s,optionsMediaQueries:a}}function es(e){let n=[];function s(i,r){return n=r.filter(({options:l})=>e.optionsAtMedia(l).active!==!1),n.forEach(l=>l.init(i,e)),r.reduce((l,c)=>Object.assign(l,{[c.name]:c}),{})}function a(){n=n.filter(i=>i.destroy())}return{init:s,destroy:a}}function Me(e,n,s){const a=e.ownerDocument,o=a.defaultView,i=Wn(o),r=es(i),l=ke(),c=Xn(),{mergeOptions:d,optionsAtMedia:h,optionsMediaQueries:f}=i,{on:u,off:b,emit:m}=c,g=E;let p=!1,x,j=d(Zn,Me.globalOptions),N=d(j),S=[],I,_,y;function k(){const{container:L,slides:v}=N;_=(Be(L)?e.querySelector(L):L)||e.children[0];const P=Be(v)?_.querySelectorAll(v):v;y=[].slice.call(P||_.children)}function w(L){const v=Jn(e,_,y,a,o,L,c);if(L.loop&&!v.slideLooper.canLoop()){const T=Object.assign({},L,{loop:!1});return w(T)}return v}function C(L,v){p||(j=d(j,L),N=h(j),S=v||S,k(),x=w(N),f([j,...S.map(({options:T})=>T)]).forEach(T=>l.add(T,"change",E)),N.active&&(x.translate.to(x.location.get()),x.animation.init(),x.slidesInView.init(),x.slideFocus.init(q),x.eventHandler.init(q),x.resizeHandler.init(q),x.slidesHandler.init(q),x.options.loop&&x.slideLooper.loop(),_.offsetParent&&y.length&&x.dragHandler.init(q),I=r.init(q,S)))}function E(L,v){const T=Y();A(),C(d({startIndex:T},L),v),c.emit("reInit")}function A(){x.dragHandler.destroy(),x.eventStore.clear(),x.translate.clear(),x.slideLooper.clear(),x.resizeHandler.destroy(),x.slidesHandler.destroy(),x.slidesInView.destroy(),x.animation.destroy(),r.destroy(),l.clear()}function K(){p||(p=!0,l.clear(),A(),c.emit("destroy"),c.clear())}function G(L,v,T){!N.active||p||(x.scrollBody.useBaseFriction().useDuration(v===!0?0:N.duration),x.scrollTo.index(L,T||0))}function U(L){const v=x.index.add(1).get();G(v,L,-1)}function ae(L){const v=x.index.add(-1).get();G(v,L,1)}function ne(){return x.index.add(1).get()!==Y()}function X(){return x.index.add(-1).get()!==Y()}function Z(){return x.scrollSnapList}function xe(){return x.scrollProgress.get(x.offsetLocation.get())}function Y(){return x.index.get()}function le(){return x.indexPrevious.get()}function de(){return x.slidesInView.get()}function W(){return x.slidesInView.get(!1)}function ge(){return I}function he(){return x}function V(){return e}function B(){return _}function ee(){return y}const q={canScrollNext:ne,canScrollPrev:X,containerNode:B,internalEngine:he,destroy:K,off:b,on:u,emit:m,plugins:ge,previousScrollSnap:le,reInit:g,rootNode:V,scrollNext:U,scrollPrev:ae,scrollProgress:xe,scrollSnapList:Z,scrollTo:G,selectedScrollSnap:Y,slideNodes:ee,slidesInView:de,slidesNotInView:W};return C(n,s),setTimeout(()=>c.emit("init"),0),q}Me.globalOptions=void 0;function Ue(e={},n=[]){const s=M.useRef(e),a=M.useRef(n),[o,i]=M.useState(),[r,l]=M.useState(),c=M.useCallback(()=>{o&&o.reInit(s.current,a.current)},[o]);return M.useEffect(()=>{qe(s.current,e)||(s.current=e,c())},[e,c]),M.useEffect(()=>{kn(a.current,n)||(a.current=n,c())},[n,c]),M.useEffect(()=>{if(Nn()&&r){Me.globalOptions=Ue.globalOptions;const d=Me(r,s.current,a.current);return i(d),()=>d.destroy()}else i(void 0)},[r,i]),[l,o]}Ue.globalOptions=void 0;const ts={spike:"âš ï¸",trend:"ðŸ“ˆ",unusual:"ðŸ“Š",budget:"ðŸ’°",saving:"ðŸŽ‰"},dt={warning:"border-l-amber-500 bg-amber-50 dark:bg-amber-900/20",success:"border-l-green-500 bg-green-50 dark:bg-green-900/20",info:"border-l-blue-500 bg-blue-50 dark:bg-blue-900/20"};function ns({insight:e,displayCurrency:n="JPY",onScrollToChart:s}){const{t:a}=z("common"),o=Pt(),i=()=>{e.category?o({to:"/transactions",search:{categories:e.category}}):(e.type==="trend"||e.type==="unusual")&&(s==null||s())},r=()=>e.category?a("analytics.viewTransactions",{category:e.category}):e.type==="trend"||e.type==="unusual"?a("analytics.viewBreakdown"):a("analytics.learnMore");return t.jsx("div",{className:R("rounded-xl p-4 border-l-4 min-w-0","bg-white dark:bg-gray-800","shadow-card",dt[e.severity]||dt.info),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("span",{className:"text-2xl flex-shrink-0",children:ts[e.type]||"ðŸ’¡"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-bold text-gray-900 dark:text-gray-100 truncate",children:e.title}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.message}),e.amount&&t.jsxs("p",{className:"text-base font-bold font-numbers text-gray-800 dark:text-gray-200 mt-1.5",children:[D(e.amount,n),e.percentage_change&&t.jsxs("span",{className:R("ml-2 text-sm font-semibold",e.percentage_change>0?"text-red-600":"text-green-600"),children:[e.percentage_change>0?"+":"",e.percentage_change,"%"]})]}),t.jsxs(J,{variant:"ghost",className:"mt-2 p-0 h-auto text-sm font-semibold text-primary-600 hover:text-primary-700",onClick:i,children:[r()," â†’"]})]})]})})}function ss({insights:e,displayCurrency:n="JPY",onScrollToChart:s}){const{t:a}=z("common"),[o,i]=M.useState(0),[r,l]=Ue({loop:!1,align:"start",containScroll:"trimSnaps"}),c=M.useCallback(()=>{l&&i(l.selectedScrollSnap())},[l]);return M.useEffect(()=>{if(l)return c(),l.on("select",c),()=>{l.off("select",c)}},[l,c]),!e||e.length===0?null:t.jsxs("div",{className:"relative",children:[e.length>1&&t.jsx("p",{className:"text-xs text-gray-400 text-center mb-2",children:a("analytics.swipeHint")}),t.jsx("div",{className:"overflow-hidden",ref:r,children:t.jsx("div",{className:"flex gap-3",children:e.map((d,h)=>t.jsx("div",{className:"flex-shrink-0 w-full min-w-0",children:t.jsx(ns,{insight:d,displayCurrency:n,onScrollToChart:s})},`${d.type}-${d.category||h}`))})}),e.length>1&&t.jsx("div",{className:"flex justify-center gap-1.5 mt-3",children:e.map((d,h)=>t.jsx("button",{"aria-label":`Go to insight ${h+1}`,className:R("h-2 rounded-full transition-[width,background-color] duration-200",h===o?"bg-primary-600 w-5":"bg-gray-300 dark:bg-gray-600 w-2"),onClick:()=>l==null?void 0:l.scrollTo(h)},h))})]})}function wt({selectedMonth:e,onChange:n,className:s}){const a=()=>{n(Ie(e,1))},o=()=>{const r=at(e,1);r<=new Date&&n(r)},i=at(e,1)>new Date;return t.jsxs("div",{className:R("flex items-center gap-2",s),children:[t.jsx("button",{onClick:a,className:R("p-2 rounded-lg text-gray-600 dark:text-gray-400","hover:bg-gray-100 dark:hover:bg-gray-700","transition-colors"),"aria-label":"Previous month",children:t.jsx(Bt,{className:"w-5 h-5"})}),t.jsx("span",{className:"min-w-[140px] text-center font-semibold text-gray-900 dark:text-gray-100",children:xt(e)}),t.jsx("button",{onClick:o,disabled:i,className:R("p-2 rounded-lg text-gray-600 dark:text-gray-400","hover:bg-gray-100 dark:hover:bg-gray-700","transition-colors",i&&"opacity-50 cursor-not-allowed"),"aria-label":"Next month",children:t.jsx($t,{className:"w-5 h-5"})})]})}const rs=[{value:"current-month",labelKey:"analytics.currentMonth"},{value:"3-months",labelKey:"analytics.3months"},{value:"6-months",labelKey:"analytics.6months"},{value:"1-year",labelKey:"analytics.1year"}];function as({selected:e,onChange:n,className:s}){const{t:a}=z("common");return t.jsx("div",{className:R("inline-flex rounded-lg bg-gray-100 dark:bg-gray-800 p-1",s),children:rs.map(({value:o,labelKey:i})=>t.jsx("button",{onClick:()=>n(o),className:R("px-3 py-1.5 text-sm font-semibold rounded-md transition-colors",o===e?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-md":"text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),children:a(i)},o))})}function os({year:e,month:n,onDownloadPDF:s,isDownloading:a}){const{t:o}=z("common"),i=xt(new Date(e,n-1));return t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white",children:o("report.title")}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:i})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:s,disabled:a,className:"p-2 rounded-lg text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors","aria-label":o(a?"report.downloading":"report.downloadPDF"),title:o(a?"report.downloading":"report.downloadPDF"),children:a?t.jsx(Vt,{size:18,className:"animate-spin"}):t.jsx(ln,{size:18})}),t.jsx("button",{disabled:!0,className:"p-2 rounded-lg text-gray-400 dark:text-gray-600 cursor-not-allowed","aria-label":o("report.sendEmail"),title:o("report.comingSoon"),children:t.jsx(dn,{size:18})})]})]})}function St({value:e,invertColor:n=!1,className:s}){const{t:a}=z("common");if(e==null)return t.jsx("span",{className:R("inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium","bg-gray-100 text-gray-500 dark:bg-gray-700 dark:text-gray-400",s),children:a("report.deltaNew")});if(e===0)return t.jsx("span",{className:R("inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium","bg-gray-100 text-gray-500 dark:bg-gray-700 dark:text-gray-400",s),children:"0%"});const o=e>0,i=n?!o:o,r=o?an:on;return t.jsxs("span",{className:R("inline-flex items-center gap-0.5 px-1.5 py-0.5 rounded-full text-xs font-medium",i?"bg-income-100 text-income-600 dark:bg-income-900/30 dark:text-income-300":"bg-expense-100 text-expense-600 dark:bg-expense-900/30 dark:text-expense-300",s),children:[t.jsx(r,{className:"w-3 h-3"}),Math.abs(e).toFixed(1),"%"]})}const Ve=({value:e,max:n=100,className:s})=>{const a=Math.min(100,Math.max(0,e/n*100));return t.jsx("div",{className:un("h-2.5 w-full overflow-hidden rounded-full bg-gray-200 dark:bg-gray-700",s),children:t.jsx("div",{className:"h-full bg-primary-600 animate-progress-fill rounded-full progress-glow",style:{width:`${a}%`}})})};function cs(e){switch(e){case"over_budget":return"error";case"threshold_80":return"warning";case"threshold_50":return"info";default:return"success"}}function is(e,n){switch(e){case"over_budget":return n("report.overBudget");case"threshold_80":return n("report.warning");case"threshold_50":return n("report.caution");default:return n("report.onTrack")}}function ls({data:e}){const{t:n}=z("common");return t.jsxs("div",{children:[t.jsxs("div",{className:"mb-4",children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1.5",children:[t.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[D(Math.abs(e.total_spent))," / ",D(e.total_budget)]}),t.jsxs("span",{className:R("font-medium",e.is_over_budget?"text-red-500":"text-gray-700 dark:text-gray-300"),children:[e.percentage_used.toFixed(1),"%"]})]}),t.jsx(Ve,{value:Math.min(e.percentage_used,100)})]}),t.jsx("div",{className:"space-y-3",children:e.category_status.map(s=>t.jsx("div",{className:"flex items-center justify-between gap-2",children:t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:"text-sm font-medium truncate text-gray-900 dark:text-gray-100",children:s.category}),t.jsx(St,{value:s.spending_change,invertColor:!0,className:"ml-1"}),t.jsx(gt,{variant:cs(s.status),className:"ml-1 text-[10px]",children:is(s.status,n)})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ve,{value:Math.min(s.percentage,100),className:"flex-1"}),t.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 w-16 text-right",children:[D(Math.abs(s.spent))," / ",D(s.budget_amount)]})]})]})},s.category))})]})}function ds({status:e}){switch(e){case"over_budget":return t.jsx(Kt,{className:"w-5 h-5 text-red-500 shrink-0"});case"threshold_80":return t.jsx(ze,{className:"w-5 h-5 text-amber-500 shrink-0"});case"threshold_50":return t.jsx(ze,{className:"w-5 h-5 text-yellow-500 shrink-0"});default:return t.jsx(Ht,{className:"w-5 h-5 text-green-500 shrink-0"})}}function us(e){switch(e){case"over_budget":return"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800";case"threshold_80":return"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800";case"threshold_50":return"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800";default:return"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800"}}function ms({focusAreas:e,budgetAdherence:n}){const{t:s}=z("common"),[a,o]=M.useState(!1),i=n.category_status.length;return e.length===0?t.jsx("div",{className:"text-center py-6 text-sm text-gray-500 dark:text-gray-400",children:s("report.noFocusAreas")}):t.jsxs("div",{className:"space-y-3",children:[e.map(r=>t.jsx("div",{className:R("rounded-lg border p-3",us(r.status)),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(ds,{status:r.status}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",children:r.category}),t.jsx(St,{value:r.spending_change,invertColor:!0})]}),t.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300 mb-1",children:[D(Math.abs(r.spent))," / ",D(r.budget_amount)]}),t.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:s(r.suggestion_key,r.suggestion_params)})]})]})},r.category)),i>e.length&&t.jsxs("button",{onClick:()=>o(!a),className:"flex items-center gap-1 text-sm font-medium text-primary-600 dark:text-primary-400 hover:underline w-full justify-center py-2",children:[a?s("report.hideAll"):s("report.seeAll",{count:i}),a?t.jsx(qt,{className:"w-4 h-4"}):t.jsx(ht,{className:"w-4 h-4"})]}),a&&t.jsx(ls,{data:n})]})}function fs(e){const n=e.summary;if(n.total_income===0&&n.total_expense===0)return null;const s=n.expense_change<0?`Expenses decreased by ${Math.abs(n.expense_change).toFixed(1)}%`:n.savings_rate>20?`Savings rate at ${n.savings_rate.toFixed(1)}%`:`Income: ${n.total_income.toLocaleString()}`,a=n.expense_change>10?`Expenses increased by ${n.expense_change.toFixed(1)}%`:n.savings_rate<10?`Low savings rate: ${n.savings_rate.toFixed(1)}%`:"No major concerns this month",o=n.net_change>0?`Net cashflow improved by ${n.net_change.toFixed(1)}%`:n.net_change<0?`Net cashflow decreased by ${Math.abs(n.net_change).toFixed(1)}%`:"Cashflow stable compared to last month";return{year:e.year,month:e.month,win:s,warning:a,trend:o,generated_at:"",is_cached:!1,credits_used:0}}const xs=[{key:"win",Icon:Yt,color:"text-green-600 dark:text-green-400",bg:"bg-green-100 dark:bg-green-900/30"},{key:"warning",Icon:ze,color:"text-amber-600 dark:text-amber-400",bg:"bg-amber-100 dark:bg-amber-900/30"},{key:"trend",Icon:yt,color:"text-blue-600 dark:text-blue-400",bg:"bg-blue-100 dark:bg-blue-900/30"}];function gs({year:e,month:n,reportData:s}){const{t:a,i18n:o}=z("common"),{data:i,refetch:r}=me({queryKey:["ai-summary",e,n,o.language],queryFn:()=>Qt(e,n,o.language),staleTime:1/0,retry:!1}),l=Re({mutationFn:f=>Gt(e,n,o.language,f),onSuccess:()=>{r()},onError:()=>{pt.error(a("report.aiSummaryError"))}}),c=i??fs(s),d=l.isPending,h=!!i;return!c&&!h?t.jsx(O,{className:"p-4",children:t.jsxs("button",{onClick:()=>l.mutate(!1),disabled:d,className:"flex items-center gap-2 w-full justify-center py-2 text-sm font-medium text-primary-600 dark:text-primary-400 hover:underline disabled:opacity-50",children:[t.jsx(Ee,{className:"w-4 h-4"}),a("report.generateSummary"),t.jsxs("span",{className:"text-xs text-gray-400",children:["~0.02 ",a("report.credits")]})]})}):t.jsxs(O,{className:"p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("h3",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 flex items-center gap-1.5",children:[t.jsx(Ee,{className:"w-4 h-4 text-primary-500"}),a("report.smartSummary")]}),t.jsxs("button",{onClick:()=>l.mutate(!0),disabled:d,className:"text-xs text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 flex items-center gap-1 disabled:opacity-50",children:[t.jsx(Ut,{className:`w-3 h-3 ${d?"animate-spin":""}`}),a("report.regenerate")]})]}),d?t.jsx("div",{className:"flex justify-center py-4",children:t.jsx(fe,{size:"sm"})}):t.jsxs("div",{className:"space-y-2.5",children:[xs.map(({key:f,Icon:u,color:b,bg:m})=>t.jsxs("div",{className:"flex items-start gap-2.5",children:[t.jsx("div",{className:`p-1 rounded-md ${m} shrink-0`,children:t.jsx(u,{className:`w-3.5 h-3.5 ${b}`})}),t.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-snug",children:c==null?void 0:c[f]})]},f)),!h&&t.jsxs("button",{onClick:()=>l.mutate(!1),className:"text-xs text-primary-600 dark:text-primary-400 hover:underline flex items-center gap-1 mt-1",children:[t.jsx(Ee,{className:"w-3 h-3"}),a("report.generateAI"),t.jsxs("span",{className:"text-gray-400",children:["~0.02 ",a("report.credits")]})]})]})]})}function hs(e){switch(e){case"ahead":return"success";case"on_track":return"info";default:return"warning"}}function ps({goal:e}){const{t:n}=z("common"),s={ahead:n("report.ahead"),on_track:n("report.onTrack"),behind:n("report.behind")}[e.status]||e.status;return t.jsxs("div",{className:"p-4 border rounded-lg border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("h3",{className:"font-medium text-gray-900 dark:text-gray-100",children:n("report.goalYears",{years:e.years})}),t.jsx(gt,{variant:hs(e.status),children:s})]}),t.jsx(Ve,{value:Math.min(e.progress_percentage,100),className:"mb-2"}),t.jsxs("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-400",children:[t.jsxs("span",{children:[D(e.total_saved)," / ",D(e.target_amount)]}),t.jsxs("span",{children:[e.progress_percentage.toFixed(1),"%"]})]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:n("report.neededPerMonth",{amount:D(e.needed_per_month)})})]})}function ys({accounts:e,totalNetWorth:n}){const{t:s}=z("common");return t.jsxs("div",{children:[t.jsxs("div",{className:"mb-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[t.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:s("report.totalNetWorth")}),t.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:D(n)})]}),t.jsx("div",{className:"space-y-2",children:e.map(a=>t.jsxs("div",{className:"flex justify-between items-center p-2 rounded hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:a.account_name}),t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:a.account_type})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"font-medium text-sm text-gray-900 dark:text-gray-100",children:D(a.balance,a.currency,void 0,!0)}),a.currency!=="JPY"&&t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:a.currency})]})]},a.account_id))})]})}function bs({insights:e}){const{t:n}=z("common");return e.length===0?null:t.jsxs(O,{children:[t.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:n("report.insights")}),t.jsx("div",{className:"space-y-3",children:e.map((s,a)=>t.jsxs("div",{className:"p-3 rounded-lg bg-gray-50 dark:bg-gray-700/50 border border-gray-100 dark:border-gray-600",children:[t.jsx("div",{className:"flex items-center gap-2 mb-1",children:t.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:s.title})}),t.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.message})]},a))})]})}function js({embedded:e=!1}){const{t:n}=z("common"),[s,a]=M.useState(new Date),[o,i]=M.useState(!1),r=s.getFullYear(),l=s.getMonth()+1,{data:c,isLoading:d,error:h}=me({queryKey:["monthly-report",r,l],queryFn:()=>Xt(r,l),staleTime:1e3*60*5}),f=M.useCallback(async()=>{i(!0);try{const b=await Jt(r,l),m=URL.createObjectURL(b),g=document.createElement("a");g.href=m,g.download=`monthly_report_${r}_${String(l).padStart(2,"0")}.pdf`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(m)}catch{pt.error(n("report.downloadError"))}finally{i(!1)}},[r,l,n]),u=t.jsxs(t.Fragment,{children:[t.jsx(os,{year:r,month:l,onDownloadPDF:f,isDownloading:o}),t.jsx(wt,{selectedMonth:s,onChange:a,className:"mb-6"}),d&&t.jsx("div",{className:"flex justify-center py-20",children:t.jsx(fe,{size:"lg"})}),h&&t.jsx(O,{className:"text-center py-10",children:t.jsx("p",{className:"text-red-500",children:n("report.loadError")})}),c&&t.jsxs("div",{className:"space-y-6",children:[t.jsx(gs,{year:r,month:l,reportData:c}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[t.jsx(re,{label:n("analytics.heroIncome"),value:D(c.summary.total_income),change:c.summary.income_change,trend:c.summary.income_change>0?"positive":c.summary.income_change<0?"negative":"neutral"}),t.jsx(re,{label:n("analytics.heroExpense"),value:D(c.summary.total_expense),change:c.summary.expense_change,trend:c.summary.expense_change<0?"positive":c.summary.expense_change>0?"negative":"neutral"}),t.jsx(re,{label:n("analytics.heroNet"),value:D(c.summary.net_cashflow),change:c.summary.net_change,trend:c.summary.net_change>0?"positive":c.summary.net_change<0?"negative":"neutral"}),t.jsx(re,{label:n("report.savingsRate"),value:`${c.summary.savings_rate.toFixed(1)}%`,subtitle:n("report.savingsRateDesc")})]}),c.budget_adherence&&t.jsxs(O,{children:[t.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:n("report.budgetAdherence")}),t.jsx(ms,{focusAreas:c.budget_adherence.focus_areas??[],budgetAdherence:c.budget_adherence})]}),c.category_breakdown.length>0&&t.jsxs(O,{children:[t.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:n("report.categoryBreakdown")}),t.jsx(jt,{data:c.category_breakdown})]}),c.spending_trends.length>0&&t.jsxs(O,{children:[t.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:n("report.spendingTrends")}),t.jsx(bt,{data:c.spending_trends})]}),c.goal_progress.length>0&&t.jsxs(O,{children:[t.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:n("report.goalProgress")}),t.jsx("div",{className:"space-y-4",children:c.goal_progress.map(b=>t.jsx(ps,{goal:b},b.goal_id))})]}),c.account_summary.length>0&&t.jsxs(O,{children:[t.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white",children:n("report.accountSummary")}),t.jsx(ys,{accounts:c.account_summary,totalNetWorth:c.total_net_worth})]}),t.jsx(bs,{insights:c.insights}),c.summary.total_income===0&&c.summary.total_expense===0&&t.jsx(O,{className:"text-center py-10",children:t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:n("report.noData")})})]})]});return e?u:t.jsx("div",{className:"max-w-3xl mx-auto px-4 py-6 sm:py-8",children:u})}function vs(e,n){const s=cn(n),a=ye(s>new Date?new Date:s,"yyyy-MM-dd");switch(e){case"current-month":return{start:ye(_e(n),"yyyy-MM-dd"),end:a};case"3-months":return{start:ye(Ie(_e(n),2),"yyyy-MM-dd"),end:a};case"6-months":return{start:ye(Ie(_e(n),5),"yyyy-MM-dd"),end:a};case"1-year":return{start:ye(Ie(_e(n),11),"yyyy-MM-dd"),end:a};default:return en()}}function Ns(){const{t:e}=z("common"),n=Ot({strict:!1}),[s,a]=M.useState((n==null?void 0:n.tab)==="report"?"report":"overview"),o=M.useRef(null),[i,r]=M.useState(new Date),[l,c]=M.useState("current-month"),[d,h]=M.useState(!1),f=vs(l,i),{data:u,isLoading:b}=me({queryKey:["analytics",f],queryFn:()=>tn(f)}),{data:m}=me({queryKey:["insights"],queryFn:ft}),{data:g}=me({queryKey:["goals"],queryFn:nn}),p=g&&g.length>0?Math.round(g[0].target_amount/(g[0].years*12)):null,x=S=>{c(S)},j=S=>{r(S)},N=M.useCallback(()=>{var S;(S=o.current)==null||S.scrollIntoView({behavior:"smooth"})},[]);return t.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-6 sm:py-8",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-3xl sm:text-4xl font-extrabold text-gray-900 dark:text-gray-100 tracking-tight",children:e("analytics.title")}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:e("analytics.subtitle")})]}),t.jsx("div",{className:"flex justify-center mb-6",children:t.jsxs("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-full p-1 inline-flex",role:"tablist",children:[t.jsx("button",{role:"tab","aria-selected":s==="overview",onClick:()=>a("overview"),className:R("px-5 py-2 text-sm font-semibold rounded-full transition-colors",s==="overview"?"bg-primary-600 text-white shadow-md":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),children:e("analytics.tabOverview","Overview")}),t.jsx("button",{role:"tab","aria-selected":s==="report",onClick:()=>a("report"),className:R("px-5 py-2 text-sm font-semibold rounded-full transition-colors",s==="report"?"bg-primary-600 text-white shadow-md":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),children:e("analytics.tabReport","Monthly Report")})]})}),s==="report"?t.jsx(js,{embedded:!0}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-6 space-y-3",children:[t.jsx(wt,{selectedMonth:i,onChange:j,className:"justify-center"}),t.jsx("div",{className:"flex justify-center",children:t.jsx(as,{selected:l,onChange:x})})]}),b?t.jsx("div",{className:"flex justify-center py-12",children:t.jsx(fe,{size:"lg"})}):t.jsxs("div",{className:"space-y-6",children:[u&&t.jsx(jn,{analytics:u}),(m==null?void 0:m.insights)&&m.insights.length>0&&t.jsx(ss,{insights:m.insights,onScrollToChart:N}),t.jsxs("div",{ref:o,className:"space-y-6",children:[t.jsxs(O,{className:"shadow-card",children:[t.jsxs("div",{className:"flex items-center gap-2.5 mb-4",children:[t.jsx("div",{className:"p-1.5 rounded-lg bg-primary-100 dark:bg-primary-900/30",children:t.jsx(Zt,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"})}),t.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:e("analytics.incomeVsExpense")})]}),t.jsx(Oe,{className:"h-64 sm:h-80",children:u!=null&&u.monthly_trends&&u.monthly_trends.length>0?t.jsx(bt,{data:u.monthly_trends}):t.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:e("analytics.noData")})})]}),t.jsxs(O,{className:"shadow-card",children:[t.jsxs("div",{className:"flex items-center gap-2.5 mb-4",children:[t.jsx("div",{className:"p-1.5 rounded-lg bg-purple-100 dark:bg-purple-900/30",children:t.jsx(Wt,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"})}),t.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:e("analytics.categoryBreakdown")})]}),t.jsx(Oe,{className:"h-64 sm:h-80",children:u!=null&&u.category_breakdown&&u.category_breakdown.length>0?t.jsx(jt,{data:u.category_breakdown}):t.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:e("analytics.noData")})})]}),t.jsxs(O,{className:"shadow-card",children:[t.jsxs("div",{className:"flex items-center gap-2.5 mb-4",children:[t.jsx("div",{className:"p-1.5 rounded-lg bg-net-100 dark:bg-net-900/30",children:t.jsx(yt,{className:"w-4 h-4 text-net-600 dark:text-net-300"})}),t.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:e("analytics.monthlyCashFlow")})]}),t.jsx("div",{className:"h-64 sm:h-80",children:u!=null&&u.monthly_trends&&u.monthly_trends.length>0?u.monthly_trends.length<3?t.jsx(rn,{data:u.monthly_trends,savingsGoal:p}):t.jsx(Oe,{className:"h-full",children:t.jsx(sn,{data:u.monthly_trends,dataKey:"net"})}):t.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:e("analytics.noData")})})]})]}),t.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-xl overflow-hidden shadow-card",children:[t.jsxs("button",{onClick:()=>h(!d),className:R("w-full px-4 py-3.5 flex items-center justify-between","bg-gray-50/80 dark:bg-gray-800/80","text-left font-semibold text-gray-900 dark:text-gray-100"),children:[t.jsxs("span",{className:"flex items-center gap-2.5",children:[t.jsx("div",{className:"p-1.5 rounded-lg bg-amber-100 dark:bg-amber-900/30",children:t.jsx(Ee,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"})}),e("analytics.aiTools")]}),t.jsx(ht,{className:R("w-4 h-4 text-gray-500 transition-transform duration-200",d&&"rotate-180")})]}),d&&t.jsxs("div",{className:"p-4 space-y-4 bg-white dark:bg-gray-900",children:[t.jsx(bn,{}),t.jsx(hn,{})]})]})]})]})]})}const zs=Rt("/analytics")({component:Ns});export{zs as Route};

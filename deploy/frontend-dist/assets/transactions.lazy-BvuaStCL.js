import{j as e,a as dt,f as mt,e as xt}from"./vendor-router-DONIM_LE.js";import{r as n,a as ae}from"./vendor-react-Cwh1aMWO.js";import{b as ut,u as gt,c as je}from"./vendor-query-B0NEAgzV.js";import{i as ht,j as S,R as pt,z as le,A as yt,D as ft,X as $e,F as bt,o as vt,E as jt,G as kt,B as b,T as Ye,P as Nt,H as we,J as ie,C as P,K as Ce,g as Be,M as He,N as wt,O as Ct,Q as St,V as Dt,W as Tt,Y as Mt,I as ke,n as Rt,Z as Ne,$ as Et,a0 as _t,a1 as At,a2 as Lt,a3 as Pt,a4 as zt,a5 as Ft,a6 as Ot}from"./index-8QQOl6s4.js";import{S as We}from"./Select-VOr_uKjK.js";import{T as It}from"./TransactionEditModal-L2mtNrSk.js";import{u as $t,a as Yt,T as Bt,R as Ht}from"./useDebouncedValue-CnS9xxHm.js";import{u as I}from"./vendor-i18n-CNDlYvyf.js";import{T as Wt}from"./tag-WPaal5cj.js";import{E as Vt}from"./BudgetInsightWidget-DWu6Mges.js";import{F as qt}from"./funnel-DAhVA7AK.js";import{D as Qt}from"./download-BM16G5XZ.js";import{P as Ut}from"./pencil-BmgcPZfM.js";import"./vendor-charts-BwEA5mzu.js";import"./zoom-out-DfvFx5Al.js";import"./RecurringOptions-B90hBlcx.js";import"./useXPGain-CWScU3DM.js";import"./useCategories-CcWulFHo.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Kt=ht("square-pen",Jt);function Xt({label:a,options:m,selected:i,onChange:c,placeholder:o}){const[r,u]=n.useState(!1),x=n.useRef(null);n.useEffect(()=>{function d(k){x.current&&!x.current.contains(k.target)&&u(!1)}return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const g=d=>{i.includes(d)?c(i.filter(k=>k!==d)):c([...i,d])},h=i.length>0?`${i.length} selected`:o||"Select...";return e.jsxs("div",{ref:x,className:"relative w-full",children:[a&&e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:a}),e.jsxs("button",{type:"button",onClick:()=>u(!r),className:S("w-full px-4 py-2 border rounded-lg text-left flex justify-between items-center","bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100","border-gray-300 dark:border-gray-600","transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500"),children:[e.jsx("span",{className:i.length===0?"text-gray-500":"",children:h}),e.jsx("svg",{className:S("w-4 h-4 transition-transform",r&&"rotate-180"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-auto",children:m.map(d=>e.jsxs("label",{className:"flex items-center px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:i.includes(d.value),onChange:()=>g(d.value),className:"mr-3 rounded border-gray-300 dark:border-gray-600 text-primary-600 focus:ring-primary-500"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:d.label})]},d.value))})]})}function Gt({onRefresh:a,threshold:m=80,disabled:i=!1}){const[c,o]=n.useState(0),[r,u]=n.useState(!1),[x,g]=n.useState(!1),h=n.useRef(0),d=n.useRef(0),k=n.useCallback(N=>{i||r||N.currentTarget.scrollTop>0||(h.current=N.touches[0].clientY,g(!0))},[i,r]),v=n.useCallback(N=>{if(!x||i||r)return;d.current=N.touches[0].clientY;const w=d.current-h.current;w>0&&o(Math.min(w*.4,m*1.5))},[x,i,r,m]),T=n.useCallback(async()=>{if(!(!x||i))if(g(!1),c>=m&&!r){u(!0),o(m);try{await a()}finally{u(!1),o(0)}}else o(0)},[x,i,c,m,r,a]);return n.useEffect(()=>()=>{o(0),u(!1),g(!1)},[]),{pullDistance:c,isRefreshing:r,isPulling:x,handlers:{onTouchStart:k,onTouchMove:v,onTouchEnd:T}}}function Zt({children:a,onRefresh:m,disabled:i=!1,className:c}){const{pullDistance:o,isRefreshing:r,handlers:u}=Gt({onRefresh:m,threshold:80,disabled:i}),x=Math.min(o/80,1),g=o>10||r;return e.jsxs("div",{className:S("relative overflow-auto",c),...u,children:[e.jsx("div",{className:S("absolute left-1/2 -translate-x-1/2 z-10 transition-opacity duration-200",g?"opacity-100":"opacity-0"),style:{top:Math.max(o-40,8)},children:e.jsx("div",{className:S("flex items-center justify-center w-10 h-10 rounded-full","bg-white dark:bg-gray-800 shadow-lg","border border-gray-200 dark:border-gray-700"),children:e.jsx(pt,{size:20,className:S("text-primary-600 transition-transform",r&&"animate-spin"),style:{transform:r?void 0:`rotate(${x*360}deg)`}})})}),e.jsx("div",{style:{transform:`translateY(${o}px)`,transition:o===0?"transform 0.2s ease-out":"none"},children:a})]})}function ea({transaction:a,isOpen:m,onClose:i,onEdit:c,onDelete:o}){const{t:r}=I("common"),{isPrivacyMode:u}=le(),{data:x}=yt(),[g,h]=n.useState(!1),d=(x==null?void 0:x.rates)||{};if(!m||!a)return null;const k=a.currency||"JPY",v=ft(Math.abs(a.amount),k,d,!0,u),T=()=>{o&&o(a),i()},N=e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40 bg-black/50 animate-in fade-in",onClick:i}),e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 animate-in zoom-in-95 duration-200",onClick:w=>{w.target===w.currentTarget&&i()},children:e.jsxs("div",{className:"relative bg-white dark:bg-gray-900 rounded-xl shadow-xl w-full max-w-md max-h-[80dvh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-900 z-10",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:r("transactions.transactionDetails")}),e.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg transition-colors",children:e.jsx($e,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"text-center py-2",children:[e.jsxs("p",{className:S("text-3xl font-bold font-numbers",a.type==="income"?"text-green-600 dark:text-green-400":"text-gray-900 dark:text-gray-100"),children:[a.type==="income"?"+":"-",u?"****":v]}),e.jsx("p",{className:S("text-sm font-medium mt-1",a.type==="income"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:a.type==="income"?r("transactions.income"):r("transactions.expense")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-800 rounded-lg",children:e.jsx(bt,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:r("transactions.description")}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:a.description||"-"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-800 rounded-lg",children:e.jsx(Wt,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:r("transactions.category")}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:a.category})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-800 rounded-lg",children:e.jsx(vt,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:r("transactions.date")}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:jt(a.date)})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-100 dark:bg-gray-800 rounded-lg",children:e.jsx(kt,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:r("transactions.source")}),e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:a.source||"-"})]})]})]}),a.receipt_url&&e.jsxs("div",{className:"pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:r("transactions.receipt")}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:a.receipt_url,alt:"Receipt",className:"w-full h-48 object-cover rounded-lg bg-gray-100 dark:bg-gray-800"}),e.jsx("a",{href:a.receipt_url,target:"_blank",rel:"noopener noreferrer",className:"absolute bottom-2 right-2 p-2 bg-black/50 rounded-lg hover:bg-black/70 transition-colors",children:e.jsx(Vt,{className:"w-4 h-4 text-white"})})]})]})]}),g?e.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 space-y-3 sticky bottom-0 bg-white dark:bg-gray-900",children:[e.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 text-center",children:r("transactions.deleteConfirm")}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(b,{variant:"outline",className:"flex-1",onClick:()=>h(!1),children:r("cancel")}),e.jsx(b,{variant:"danger",className:"flex-1",onClick:T,children:r("delete")})]})]}):e.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex gap-3 sticky bottom-0 bg-white dark:bg-gray-900",children:[e.jsxs(b,{variant:"outline",className:"flex-1",onClick:()=>c==null?void 0:c(a),children:[e.jsx(Kt,{className:"w-4 h-4 mr-2"}),r("edit")]}),e.jsxs(b,{variant:"danger",className:"flex-1",onClick:()=>h(!0),children:[e.jsx(Ye,{className:"w-4 h-4 mr-2"}),r("delete")]})]})]})})]});return ae.createPortal(N,document.body)}function ta({onClick:a}){const{t:m}=I("common");return ae.createPortal(e.jsx("button",{onClick:a,className:S("fixed bottom-20 right-4 sm:bottom-6 sm:right-6 z-50","w-14 h-14 rounded-full","bg-primary-600 hover:bg-primary-700 dark:bg-primary-500 dark:hover:bg-primary-600","text-white shadow-lg","flex items-center justify-center","active:scale-95 transition-all","md:hidden"),"aria-label":m("transaction.addTransaction","Add Transaction"),children:e.jsx(Nt,{size:28})}),document.body)}function Fe({transaction:a,onViewDetail:m,onEdit:i,onDelete:c}){const{t:o}=I("common"),{isPrivacyMode:r}=le(),u=we(),[x,g]=n.useState(0),[h,d]=n.useState(!1),[k,v]=n.useState(0),[T,N]=n.useState(!1),w=n.useRef(null),f=n.useRef(null),C=80,$=40,Y=500,z=n.useRef(null),_=n.useRef(!1),Q=n.useRef(0),de=p=>{v(p.touches[0].clientX),Q.current=p.touches[0].clientY,d(!0),_.current=!1,z.current=setTimeout(()=>{_.current=!0,N(!0)},Y)},se=p=>{if(!h)return;const F=p.touches[0].clientX,W=p.touches[0].clientY,U=Math.abs(W-Q.current);if(_.current)return;if(U>10){B();return}const j=k-F;j>0?g(Math.min(j,C)):g(Math.max(j,-20))},re=()=>{if(d(!1),_.current){g(0);return}B(),x>$?g(C):g(0)},B=n.useCallback(()=>{z.current&&(clearTimeout(z.current),z.current=null),_.current=!1},[]),H=()=>{if(_.current){N(!1);return}x>$||m(a)},me=p=>{p.stopPropagation(),c(a)},xe=p=>{p.preventDefault(),N(!0)},A=n.useCallback(()=>{N(!1)},[]);return n.useEffect(()=>{const p=F=>{f.current&&!f.current.contains(F.target)&&A()};if(T)return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[T,A]),n.useEffect(()=>{const p=F=>{w.current&&!w.current.contains(F.target)&&g(0)};if(x>0)return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[x]),e.jsxs("div",{ref:w,className:"relative overflow-hidden",children:[T&&e.jsx("div",{className:"fixed inset-0 z-40",onClick:A,children:e.jsx("div",{ref:f,className:"absolute bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden animate-in fade-in zoom-in-95 duration-150 select-none",style:{left:"50%",bottom:"20px",transform:"translateX(-50%)",maxWidth:"280px",width:"calc(100% - 32px)"},onClick:p=>p.stopPropagation(),children:e.jsxs("div",{className:"py-2",children:[e.jsxs("button",{onClick:()=>{i(a),A()},className:"w-full px-4 py-3 text-left flex items-center gap-3 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 text-blue-600 dark:text-blue-400",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125"})}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:o("button.edit","Edit")})]}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(`${a.description}: ${ie(a.amount,a.type,a.currency||"JPY",u,!1,!1)}`),A()},className:"w-full px-4 py-3 text-left flex items-center gap-3 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 text-gray-600 dark:text-gray-400",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"})}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:o("button.copy","Copy")})]}),e.jsx("div",{className:"my-2 border-t border-gray-200 dark:border-gray-700"}),e.jsxs("button",{onClick:()=>{c(a),A()},className:"w-full px-4 py-3 text-left flex items-center gap-3 hover:bg-red-50 dark:hover:bg-red-900/30 transition-colors",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 text-red-600 dark:text-red-400",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),e.jsx("span",{className:"text-red-600 dark:text-red-400",children:o("button.delete","Delete")})]})]})})}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center justify-center bg-red-600",style:{width:`${C}px`},children:e.jsxs("button",{onClick:me,className:"h-full w-full flex flex-col items-center justify-center text-white transition-opacity",style:{opacity:x>0?1:0},"aria-label":o("transaction.deleteTransaction","Delete transaction"),children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-6 h-6 mb-1",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),e.jsx("span",{className:"text-xs font-medium",children:o("button.delete","Delete")})]})}),e.jsx("div",{className:"relative",style:{transform:`translateX(-${x}px)`,transition:h?"none":"transform 250ms ease-out"},onTouchStart:de,onTouchMove:se,onTouchEnd:re,onTouchCancel:B,onClick:H,onContextMenu:xe,children:e.jsxs(P,{className:`cursor-pointer active:scale-[0.98] transition-transform border-l-[3px] ${a.is_transfer?"border-l-blue-400 dark:border-l-blue-500":a.type==="income"?"border-l-income-300 dark:border-l-income-600":"border-l-expense-300 dark:border-l-expense-600"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-50",children:a.description}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:Ce(a.date)})]}),e.jsx("p",{className:`text-lg font-bold font-numbers ${a.is_transfer?"text-blue-500 dark:text-blue-400":a.type==="income"?"text-income-600 dark:text-income-300":"text-expense-600 dark:text-expense-300"}`,children:ie(a.amount,a.type,a.currency||"JPY",u,!0,r)})]}),e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsx(Be,{variant:a.is_transfer?"info":a.type==="income"?"success":"error",children:a.category}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:a.source})]})]})})]})}function aa({isOpen:a,onClose:m,onConfirm:i,transaction:c,isDeleting:o=!1}){const{t:r}=I("common"),{currency:u}=He(),{isPrivacyMode:x}=le(),g=we();if(!a||!c)return null;const h=e.jsxs("div",{className:"fixed inset-0 z-[100001] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:m}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl w-[calc(100%-2rem)] max-w-md p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-gray-100",children:r("transaction.deleteConfirm","Delete this transaction?")}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6 space-y-2",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:c.description}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:Ce(c.date)}),e.jsx("span",{className:`font-bold font-numbers ${c.type==="income"?"text-green-600":"text-red-600"}`,children:ie(c.amount,c.type,u,g,!1,x)})]}),e.jsxs("div",{className:"flex gap-2 text-xs text-gray-600 dark:text-gray-400",children:[e.jsx("span",{children:c.category}),e.jsx("span",{children:"-"}),e.jsx("span",{children:c.source})]})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-6",children:r("transaction.deleteWarning","This action cannot be undone. Are you sure?")}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(b,{variant:"outline",onClick:m,disabled:o,className:"flex-1",children:r("button.cancel","Cancel")}),e.jsx(b,{onClick:i,disabled:o,className:"flex-1 bg-red-600 hover:bg-red-700 text-white",children:o?r("button.deleting","Deleting..."):r("button.delete","Delete")})]})]})]});return typeof document<"u"?ae.createPortal(h,document.body):null}function sa({isOpen:a,onClose:m,onConfirm:i,selectedCount:c,isLoading:o}){const{t:r}=I("common"),[u,x]=n.useState(""),g=[{value:"",label:r("transactions.selectCategory","Select category...")},{value:"食費",label:r("category.food","Food")},{value:"住宅",label:r("category.housing","Housing")},{value:"交通",label:r("category.transport","Transport")},{value:"娯楽",label:r("category.entertainment","Entertainment")},{value:"通信",label:r("category.communication","Communication")},{value:"日用品",label:r("category.daily","Daily Necessities")},{value:"医療",label:r("category.medical","Medical")},{value:"教育",label:r("category.education","Education")},{value:"その他",label:r("category.other","Other")}],h=()=>{u&&(i(u),x(""))};if(!a)return null;const d=e.jsxs("div",{className:"fixed inset-0 z-[100001] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:m}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg p-6 w-[calc(100%-2rem)] max-w-md shadow-xl",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:r("transactions.recategorizeTitle","Change Category")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:r("transactions.recategorizeDescription","Update category for {{count}} transactions",{count:c})}),e.jsx(We,{label:r("transactions.newCategory","New Category"),value:u,onChange:k=>x(k.target.value),options:g}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx(b,{variant:"outline",onClick:m,className:"flex-1",children:r("button.cancel","Cancel")}),e.jsx(b,{onClick:h,disabled:!u||o,className:"flex-1",children:o?r("button.saving","Saving..."):r("button.apply","Apply")})]})]})]});return typeof document<"u"?ae.createPortal(d,document.body):null}function ra({isOpen:a,onClose:m,onConfirm:i,selectedCount:c,isDeleting:o}){const{t:r}=I("common");if(!a)return null;const u=e.jsxs("div",{className:"fixed inset-0 z-[100001] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:m}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg p-6 w-[calc(100%-2rem)] max-w-md shadow-xl",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-2",children:r("transactions.bulkDeleteTitle","Delete Transactions")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-6",children:r("transactions.bulkDeleteConfirm","Are you sure you want to delete {{count}} transactions? This cannot be undone.",{count:c})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(b,{variant:"outline",onClick:m,className:"flex-1",children:r("button.cancel","Cancel")}),e.jsx(b,{variant:"danger",onClick:i,disabled:o,className:"flex-1",children:o?r("button.deleting","Deleting..."):r("button.delete","Delete")})]})]})]});return typeof document<"u"?ae.createPortal(u,document.body):null}function na(a){const m=["Date","Description","Amount","Type","Category","Source"],i=a.map(c=>[c.date,`"${c.description.replace(/"/g,'""')}"`,c.amount.toString(),c.type,c.category,c.source]);return[m.join(","),...i.map(c=>c.join(","))].join(`
`)}function oa(a,m){const i=new Blob(["\uFEFF"+a],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(i),o=document.createElement("a");o.href=c,o.download=m,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(c)}function Oe(a,m,i){const c=na(a),o=m&&i?`${m}_to_${i}`:new Date().toISOString().split("T")[0];oa(c,`smartmoney_transactions_${o}.csv`)}function Ie(a){const[m,i]=a.split("-").map(Number),c=`${m}-${String(i).padStart(2,"0")}-01`,o=new Date(m,i,0).getDate(),r=`${m}-${String(i).padStart(2,"0")}-${String(o).padStart(2,"0")}`;return{start:c,end:r}}function ca(){const{t:a}=I("common"),{currency:m}=He(),{isPrivacyMode:i}=le(),c=we(),o=ut(),r=dt(),u=wt(),{data:x}=Ct(),{categories:g,month:h,accountId:d,fromAccounts:k,type:v,action:T}=mt({from:"/transactions"}),N=g?g.split(",").filter(Boolean):[],w=h?Ie(h):u,[f,C]=n.useState({start_date:w.start,end_date:w.end,categories:N,source:"",type:v||"all",account_id:d?Number(d):void 0}),[$,Y]=n.useState(""),z=$t($,300),[_,Q]=n.useState(""),[de,se]=n.useState(""),[re,B]=n.useState("thisMonth"),[H,me]=n.useState(!1),xe=t=>{const s=new Date;let l,M=s;switch(t){case"today":l=s;break;case"thisWeek":l=new Date(s),l.setDate(s.getDay()-s.getDay());break;case"thisMonth":l=new Date(s.getFullYear(),s.getMonth(),1);break;case"lastMonth":l=new Date(s.getFullYear(),s.getMonth()-1,1),M=new Date(s.getFullYear(),s.getMonth(),0);break;case"last3Months":l=new Date(s.getFullYear(),s.getMonth()-3,1);break;default:l=new Date(s.getFullYear(),s.getMonth(),1)}return{start:l.toISOString().split("T")[0],end:M.toISOString().split("T")[0]}},A=t=>{if(B(t),t!=="custom"){const s=xe(t);C(l=>({...l,start_date:s.start,end_date:s.end}))}},p=(t,s)=>{const l=s?parseFloat(s):void 0;t==="min"?(Q(s),C(M=>({...M,min_amount:l}))):(se(s),C(M=>({...M,max_amount:l})))},F=t=>{C(s=>{const l={...s};return Y(""),l.search=void 0,l})},W=t=>{const s=f[t];return t==="categories"?!!(s&&s.length>0):t==="type"?s!=="all":t==="source"?!!s:t==="min_amount"||t==="max_amount"?s!==void 0:!!s},U=[W("categories"),W("source"),W("min_amount"),W("max_amount"),re!=="thisMonth"].filter(Boolean).length,[j,Se]=n.useState("date"),[L,ue]=n.useState("desc"),[J,De]=n.useState(50),[Te,ne]=n.useState(!1),K=t=>{ne(!0),j===t?ue(s=>s==="asc"?"desc":"asc"):(Se(t),ue("desc")),setTimeout(()=>ne(!1),150)},Ve=t=>{ne(!0);const[s,l]=t.split("-");Se(s),ue(l),setTimeout(()=>ne(!1),150)};n.useEffect(()=>{C(t=>({...t,search:z||void 0}))},[z]),n.useEffect(()=>{if(g||h||v!==void 0||d){const t=h?Ie(h):u,s=g?g.split(",").filter(Boolean):[];C(l=>({...l,categories:s.length>0?s:l.categories,start_date:t.start,end_date:t.end,type:v||"all",account_id:d?Number(d):void 0}))}},[g,h,v,d]);const Me=t=>{const s=v===t?void 0:t;r({to:"/transactions",search:l=>({...l,type:s})})},[Re,X]=n.useState(null),[Ee,ge]=n.useState(null),[qe,G]=n.useState(!1),[oe,V]=n.useState(null),[Qe,he]=n.useState(!1),[E,O]=n.useState(new Set),[Ue,pe]=n.useState(!1),[Je,ye]=n.useState(!1),ce=n.useMemo(()=>({...f,account_id:d?Number(d):f.account_id}),[f,d]),{data:y,isLoading:_e}=gt({queryKey:["transactions",ce],queryFn:()=>Ot(ce)});n.useEffect(()=>{O(new Set)},[y]),n.useEffect(()=>{T==="add-transaction"?(G(!0),r({to:"/transactions",search:t=>({...t,action:void 0})})):T==="scan-receipt"&&(he(!0),r({to:"/transactions",search:t=>({...t,action:void 0})}))},[T,r]),n.useEffect(()=>{const t=()=>{G(!0)},s=()=>{he(!0)};return window.addEventListener("open-add-transaction-modal",t),window.addEventListener("open-receipt-scanner",s),()=>{window.removeEventListener("open-add-transaction-modal",t),window.removeEventListener("open-receipt-scanner",s)}},[]);const Ke=Yt(Ft,"transaction",[["transactions"],["analytics"]]),Xe=t=>{if(!t.amount||!t.category)return;const s=x==null?void 0:x[0],l=(s==null?void 0:s.currency)||"JPY",M=zt(Math.abs(t.amount),l);Ke.mutate({date:t.date||new Date().toISOString().split("T")[0],description:t.merchant||"Receipt Scan",amount:-M,currency:l,category:t.category,source:(s==null?void 0:s.name)||"Unknown",type:"expense"})},Ge=[{value:"食費",label:a("category.food","Food")},{value:"住宅",label:a("category.housing","Housing")},{value:"交通",label:a("category.transport","Transport")},{value:"娯楽",label:a("category.entertainment","Entertainment")},{value:"通信",label:a("category.communication","Communication")},{value:"日用品",label:a("category.daily","Daily Necessities")},{value:"医療",label:a("category.medical","Medical")},{value:"教育",label:a("category.education","Education")},{value:"その他",label:a("category.other","Other")}],Ae=y&&y.length>0&&y.every(t=>E.has(t.id)),Ze=()=>{O(Ae?new Set:new Set((y==null?void 0:y.map(t=>t.id))||[]))},et=t=>{const s=new Set(E);s.has(t)?s.delete(t):s.add(t),O(s)},Le=je({mutationFn:t=>St(t),onSuccess:()=>{o.invalidateQueries({queryKey:["transactions"]}),o.invalidateQueries({queryKey:["dashboard"]}),o.invalidateQueries({queryKey:["analytics"]}),V(null)}}),Pe=je({mutationFn:()=>Dt(Array.from(E)),onSuccess:()=>{o.invalidateQueries({queryKey:["transactions"]}),o.invalidateQueries({queryKey:["dashboard"]}),o.invalidateQueries({queryKey:["analytics"]}),O(new Set),ye(!1)}}),ze=je({mutationFn:t=>Tt(Array.from(E),t),onSuccess:()=>{o.invalidateQueries({queryKey:["transactions"]}),O(new Set),pe(!1)}}),tt=()=>{oe&&Le.mutate(oe.id)},at=()=>{C({start_date:u.start,end_date:u.end,categories:[],source:"",type:"all"}),Y(""),B("thisMonth"),Q(""),se(""),r({to:"/transactions",search:{}})},st=async()=>{await o.invalidateQueries({queryKey:["transactions"]}),await o.invalidateQueries({queryKey:["dashboard"]}),await o.invalidateQueries({queryKey:["analytics"]})},Z=n.useMemo(()=>{if(!y)return[];if(ce.account_id||!d)return y;const t=Number(d);return y.filter(s=>s.account_id!=null&&Number(s.account_id)===t)},[y,d,ce.account_id]),ee=n.useMemo(()=>!d||!x?null:x.find(t=>t.id===Number(d))||null,[d,x]),fe=(ee==null?void 0:ee.currency)||m,rt={JPY:1,USD:.00667,VND:167},{income:nt,expense:ot,net:ct}=n.useMemo(()=>{const t=Z,s=(D,R)=>{if(ee)return D;const lt=Pt[R]??0,be=D/Math.pow(10,lt);if(R==="JPY")return be;const ve=c[R]??rt[R];return!ve||ve===0?be:be/ve},l=t.filter(D=>D.type==="income"&&!D.is_transfer).reduce((D,R)=>D+s(R.amount,R.currency||"JPY"),0),M=t.filter(D=>D.type==="expense"&&!D.is_transfer).reduce((D,R)=>D+s(Math.abs(R.amount),R.currency||"JPY"),0);return{income:l,expense:M,net:l-M}},[Z,ee,c]),te=n.useMemo(()=>Z.length?[...Z].sort((t,s)=>{let l=0;switch(j){case"date":l=t.date.localeCompare(s.date);break;case"description":l=t.description.localeCompare(s.description);break;case"category":l=t.category.localeCompare(s.category);break;case"source":l=t.source.localeCompare(s.source);break;case"amount":l=t.amount-s.amount;break}return L==="asc"?l:-l}):[],[Z,j,L]),q=n.useMemo(()=>J==="all"?te:te.slice(0,J),[te,J]),it=n.useMemo(()=>{if(!q.length)return[];const t=[];let s="";return q.forEach(l=>{l.date!==s?(s=l.date,t.push({date:l.date,transactions:[l]})):t[t.length-1].transactions.push(l)}),t},[q]);return e.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-6 pb-28",children:[k&&e.jsxs(b,{variant:"ghost",size:"sm",onClick:()=>r({to:"/accounts"}),className:"mb-4 -ml-2",children:[e.jsx(Mt,{className:"w-4 h-4 mr-2"}),a("backToAccounts")]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100 mb-1",children:a("transactions.title")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:a("transactions.subtitle")})]}),e.jsx(P,{className:"mb-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ke,{placeholder:a("transactions.searchPlaceholder","Search transactions..."),value:$,onChange:t=>Y(t.target.value),className:"h-11"}),$&&e.jsx("button",{onClick:()=>{Y(""),F()},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx($e,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>me(!H),className:S("flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition-colors",H||U>0?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:[e.jsx(qt,{className:"w-4 h-4"}),a("button.filter","Filter"),U>0&&e.jsx("span",{className:"bg-primary-500 text-white text-xs px-1.5 py-0.5 rounded-full",children:U}),e.jsx(Rt,{className:S("w-4 h-4 transition-transform",H&&"rotate-180")})]}),e.jsx("button",{onClick:()=>Oe(te,f.start_date,f.end_date),className:"flex items-center gap-1 px-3 py-2 rounded-lg text-sm font-medium bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:a("export.csv","Export CSV"),children:e.jsx(Qt,{className:"w-4 h-4"})}),e.jsx("div",{className:"flex gap-1 overflow-x-auto scrollbar-hide flex-1",children:[{key:"today",label:a("date.today","Today")},{key:"thisWeek",label:a("date.thisWeek","This Week")},{key:"thisMonth",label:a("date.thisMonth","This Month")},{key:"last3Months",label:a("date.last3Months","3 Months")}].map(({key:t,label:s})=>e.jsx("button",{onClick:()=>A(t),className:S("px-3 py-2 text-xs sm:text-sm font-medium rounded-lg whitespace-nowrap transition-colors",re===t?"bg-primary-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:s},t))})]}),H&&e.jsxs("div",{className:"pt-3 border-t border-gray-200 dark:border-gray-600 space-y-3 animate-slide-up",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 dark:text-gray-400 mb-1.5",children:a("transactions.amountRange","Amount Range")}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(ke,{type:"number",placeholder:a("transactions.minAmount","Min"),value:_,onChange:t=>p("min",t.target.value),className:"h-10"}),e.jsx(ke,{type:"number",placeholder:a("transactions.maxAmount","Max"),value:de,onChange:t=>p("max",t.target.value),className:"h-10"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsx("div",{className:"relative",children:e.jsx(Xt,{label:a("transactions.category","Category"),options:Ge,selected:f.categories||[],onChange:t=>C({...f,categories:t}),placeholder:a("transactions.allCategories","All")})}),e.jsx(We,{label:a("transactions.account","Account"),value:f.source||"",onChange:t=>C({...f,source:t.target.value}),options:[{value:"",label:a("transactions.all","All")},...(x==null?void 0:x.map(t=>({value:t.name,label:t.name})))||[]]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(b,{variant:"ghost",size:"sm",onClick:at,children:a("button.reset","Reset")}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>y&&Oe(y,f.start_date,f.end_date),disabled:!y||y.length===0,children:a("transactions.export","Export")})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx("div",{className:"animate-stagger-in",style:{"--stagger-index":0},children:e.jsxs(P,{onClick:()=>Me("income"),className:`cursor-pointer transition-all hover:shadow-md hover:scale-[1.01] ${v==="income"?"ring-2 ring-green-500 dark:ring-green-400 bg-green-50/50 dark:bg-green-900/20":""}`,children:[e.jsx("p",{className:"text-[11px] font-medium text-gray-500 dark:text-gray-400 mb-1.5 uppercase tracking-wider",children:a("transactions.income")}),e.jsx("p",{className:"text-2xl sm:text-3xl font-extrabold font-numbers text-green-600 dark:text-green-400 tracking-tight",children:Ne(nt,fe,c,!0,i)})]})}),e.jsx("div",{className:"animate-stagger-in",style:{"--stagger-index":1},children:e.jsxs(P,{onClick:()=>Me("expense"),className:`cursor-pointer transition-all hover:shadow-md hover:scale-[1.01] ${v==="expense"?"ring-2 ring-red-500 dark:ring-red-400 bg-red-50/50 dark:bg-red-900/20":""}`,children:[e.jsx("p",{className:"text-[11px] font-medium text-gray-500 dark:text-gray-400 mb-1.5 uppercase tracking-wider",children:a("transactions.expense")}),e.jsx("p",{className:"text-2xl sm:text-3xl font-extrabold font-numbers text-red-600 dark:text-red-400 tracking-tight",children:Ne(ot,fe,c,!0,i)})]})}),e.jsx("div",{className:"animate-stagger-in",style:{"--stagger-index":2},children:e.jsxs(P,{onClick:()=>v?r({to:"/transactions",search:t=>({...t,type:void 0})}):void 0,className:S("transition-all",v?"cursor-pointer hover:shadow-md hover:scale-[1.01]":"border-primary-200 dark:border-primary-800 bg-primary-50/30 dark:bg-primary-900/10"),children:[e.jsx("p",{className:"text-[11px] font-medium text-gray-500 dark:text-gray-400 mb-1.5 uppercase tracking-wider",children:a("transactions.difference")}),e.jsx("p",{className:"text-2xl sm:text-3xl font-extrabold font-numbers text-blue-600 dark:text-blue-400 tracking-tight",children:Ne(ct,fe,c,!0,i)})]})})]}),!_e&&y&&y.length>0&&e.jsxs("div",{className:"flex items-center justify-between mb-4 flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[a("transactions.show","Show"),":"]}),e.jsx("div",{className:"hidden md:flex gap-1",children:[50,100,"all"].map(t=>e.jsx("button",{onClick:()=>De(t),className:`px-3 py-1 text-sm rounded-md transition-colors ${J===t?"bg-primary-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:t==="all"?a("transactions.showAll","All"):t},t))}),e.jsxs("select",{value:J,onChange:t=>De(t.target.value==="all"?"all":Number(t.target.value)),className:"md:hidden px-3 py-1 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300",children:[e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"}),e.jsx("option",{value:"all",children:a("transactions.showAll","All")})]})]}),e.jsxs("div",{className:"flex md:hidden items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[a("transactions.sort","Sort"),":"]}),e.jsxs("select",{value:`${j}-${L}`,onChange:t=>Ve(t.target.value),className:"px-3 py-1 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300",children:[e.jsx("option",{value:"date-desc",children:a("transactions.sortDateDesc","Date ↓")}),e.jsx("option",{value:"date-asc",children:a("transactions.sortDateAsc","Date ↑")}),e.jsx("option",{value:"amount-desc",children:a("transactions.sortAmountDesc","Amount ↓")}),e.jsx("option",{value:"amount-asc",children:a("transactions.sortAmountAsc","Amount ↑")})]}),Te&&e.jsxs("svg",{className:"animate-spin h-4 w-4 text-primary-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})]})]}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:a("transactions.showingCount","Showing {{shown}} of {{total}}",{shown:q.length,total:te.length})})]}),_e?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"hidden md:block overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4 w-12"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase",children:a("transactions.date")}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase",children:a("transactions.description")}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase",children:a("transactions.category")}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase",children:a("transactions.source")}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase",children:a("transactions.amount")}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase w-24",children:a("transactions.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:[...Array(5)].map((t,s)=>e.jsx(Et,{},s))})]})}),e.jsx("div",{className:"md:hidden space-y-3",children:[...Array(5)].map((t,s)=>e.jsx(_t,{},s))})]}):y&&y.length>0?e.jsxs("div",{className:`transition-opacity duration-150 ${Te?"opacity-50":"opacity-100"}`,children:[e.jsx(P,{className:"hidden md:block overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4 w-12",children:e.jsx("input",{type:"checkbox",checked:Ae,onChange:Ze,className:"rounded border-gray-300 dark:border-gray-600 text-primary-600 focus:ring-primary-500"})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600/50 select-none",onClick:()=>K("date"),children:e.jsxs("span",{className:"flex items-center gap-1",children:[a("transactions.date"),j==="date"&&e.jsx("span",{className:"text-primary-600",children:L==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600/50 select-none",onClick:()=>K("description"),children:e.jsxs("span",{className:"flex items-center gap-1",children:[a("transactions.description"),j==="description"&&e.jsx("span",{className:"text-primary-600",children:L==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600/50 select-none",onClick:()=>K("category"),children:e.jsxs("span",{className:"flex items-center gap-1",children:[a("transactions.category"),j==="category"&&e.jsx("span",{className:"text-primary-600",children:L==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600/50 select-none",onClick:()=>K("source"),children:e.jsxs("span",{className:"flex items-center gap-1",children:[a("transactions.source"),j==="source"&&e.jsx("span",{className:"text-primary-600",children:L==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600/50 select-none",onClick:()=>K("amount"),children:e.jsxs("span",{className:"flex items-center justify-end gap-1",children:[a("transactions.amount"),j==="amount"&&e.jsx("span",{className:"text-primary-600",children:L==="asc"?"↑":"↓"})]})}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase w-24",children:a("transactions.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:q.map(t=>e.jsxs("tr",{className:`hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors ${t.is_transfer?"border-l-[3px] border-l-blue-400 dark:border-l-blue-500":t.type==="income"?"border-l-[3px] border-l-income-300 dark:border-l-income-600":"border-l-[3px] border-l-expense-300 dark:border-l-expense-600"}`,children:[e.jsx("td",{className:"px-4 py-4",children:e.jsx("input",{type:"checkbox",checked:E.has(t.id),onChange:()=>et(t.id),className:"rounded border-gray-300 dark:border-gray-600 text-primary-600 focus:ring-primary-500"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 dark:text-gray-50",children:Ce(t.date)}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 dark:text-gray-50",children:t.description}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(Be,{variant:t.is_transfer?"info":t.type==="income"?"success":"error",children:t.category})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600 dark:text-gray-300",children:t.source}),e.jsx("td",{className:`px-6 py-4 text-sm font-semibold font-numbers text-right ${t.is_transfer?"text-blue-500 dark:text-blue-400":t.type==="income"?"text-income-600 dark:text-income-300":"text-expense-600 dark:text-expense-300"}`,children:ie(t.amount,t.type,t.currency||"JPY",c,!0,i)}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("button",{onClick:()=>X(t),className:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-lg transition-colors","aria-label":a("button.edit"),children:e.jsx(Ut,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})}),e.jsx("button",{onClick:()=>V(t),className:"p-1.5 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors","aria-label":a("button.delete"),children:e.jsx(Ye,{className:"w-4 h-4 text-red-600 dark:text-red-400"})})]})})]},t.id))})]})}),e.jsx(Zt,{onRefresh:st,className:"md:hidden",children:e.jsx("div",{className:"space-y-6 pb-20",children:j==="date"?it.map(t=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("h3",{className:"text-xs font-bold uppercase tracking-wide text-primary-700 dark:text-primary-300 bg-primary-50 dark:bg-primary-900/20 px-3 py-1 rounded-full",children:At(t.date)}),e.jsx("div",{className:"flex-1 h-px bg-primary-100 dark:bg-primary-800/30"})]}),e.jsx("div",{className:"space-y-3",children:t.transactions.map(s=>e.jsx(Fe,{transaction:s,onViewDetail:ge,onEdit:X,onDelete:V},s.id))})]},t.date)):e.jsx("div",{className:"space-y-3",children:q.map(t=>e.jsx(Fe,{transaction:t,onViewDetail:ge,onEdit:X,onDelete:V},t.id))})})})]}):e.jsx(P,{children:e.jsx(Lt,{icon:e.jsx("svg",{className:"w-16 h-16 text-gray-300 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M2.25 18.75a60.07 60.07 0 0115.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 013 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 00-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 01-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 003 15h-.75M15 10.5a3 3 0 11-6 0 3 3 0 016 0zm3 0h.008v.008H18V10.5zm-12 0h.008v.008H6V10.5z"})}),title:a("transactions.noData"),description:a("transactions.noDataDescription","Upload a CSV file or add transactions manually to get started."),action:e.jsx(b,{onClick:()=>G(!0),children:a("transaction.addTransaction")})})}),E.size>0&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 shadow-lg p-4 z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:a("transactions.selectedCount","{{count}} selected",{count:E.size})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>O(new Set),children:a("button.clearSelection","Clear")}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>pe(!0),children:a("transactions.recategorize","Recategorize")}),e.jsx(b,{variant:"danger",size:"sm",onClick:()=>ye(!0),children:a("transactions.deleteSelected","Delete")})]})]})}),e.jsx(It,{isOpen:!!Re,onClose:()=>X(null),transaction:Re}),e.jsx(ea,{isOpen:!!Ee,onClose:()=>ge(null),transaction:Ee,onEdit:X,onDelete:V}),e.jsx(Bt,{isOpen:qe,onClose:()=>G(!1),defaultAccountId:d?Number(d):null}),e.jsx(aa,{isOpen:!!oe,onClose:()=>V(null),onConfirm:tt,transaction:oe,isDeleting:Le.isPending}),e.jsx(sa,{isOpen:Ue,onClose:()=>pe(!1),onConfirm:t=>ze.mutate(t),selectedCount:E.size,isLoading:ze.isPending}),e.jsx(ra,{isOpen:Je,onClose:()=>ye(!1),onConfirm:()=>Pe.mutate(),selectedCount:E.size,isDeleting:Pe.isPending}),e.jsx(Ht,{isOpen:Qe,onClose:()=>he(!1),onScanComplete:Xe}),e.jsx(ta,{onClick:()=>G(!0)})]})}const Sa=xt("/transactions")({component:ca});export{Sa as Route};

var Ue=t=>{throw TypeError(t)};var De=(t,s,r)=>s.has(t)||Ue("Cannot "+r);var $=(t,s,r)=>(De(t,s,"read from private field"),r?r.call(t):s.get(t)),Y=(t,s,r)=>s.has(t)?Ue("Cannot add the same private member more than once"):s instanceof WeakSet?s.add(t):s.set(t,r),H=(t,s,r,a)=>(De(t,s,"write to private field"),a?a.call(t,r):s.set(t,r),r),G=(t,s,r)=>(De(t,s,"access private method"),r);import{b3 as jt,b4 as Le,b5 as vt,b6 as Nt,b7 as nt,G as re,b8 as kt,b9 as wt,r as g,ba as _t,bb as Ct,bc as St,bd as Ft,be as Ve,bf as We,bg as Rt,bh as Mt,k as ae,u as X,x as At,K as lt,J as _e,j as e,C as ue,l as O,a6 as te,bi as Dt,bj as Pt,bk as qt,V as Ce,w as Se,Y as it,z as Q,a1 as V,D as ge,ao as ve,o as ot,R as se,T as Lt,I as Je,B as he,P as ze,aj as Et,g as ye,aw as Fe,p as Qe,aN as Ee,L as Ne,X as oe,F as Re,as as dt,ay as Tt,H as $t,aS as Ot,aM as je,ax as It,$ as ct,aO as Bt,ac as de,ae as zt,aa as Qt,i as Kt}from"./index-p_OOsc5s.js";import{f as Pe,p as qe,T as Ht,R as Ut}from"./TransactionFormModal-BCYdAJ4A.js";import{c as Vt,d as Wt,s as Jt,C as ke,e as we,f as xt,h as Yt,i as Gt,j as mt,k as ut,l as gt,m as ht,n as Xt,o as Zt,p as es,q as ts,r as ss,t as rs,u as yt,v as pt}from"./crypto-DRbT1RGC.js";import{E as Ke}from"./BudgetInsightWidget-CEcwLaK-.js";import{C as Me}from"./chevron-down-Cx7myVrH.js";import{R as as,O as ns}from"./generateCategoricalChart-bj5yJQLv.js";import{a as ls,C as is,X as os,Y as ds,L as cs}from"./LineChart-jf01rTcs.js";import{C as bt}from"./chevron-up-C8YTnu5q.js";import{C as xs}from"./clock-2nu-nT4z.js";import{T as ms}from"./triangle-alert-CQjekEGN.js";import{a as Ye,S as Ge}from"./square-DScr6dzh.js";import"./recurring-service-DftMy_sW.js";import"./RecurringOptions-BMy5dNLh.js";import"./useXPGain-C2e0qOcy.js";import"./useCategories-CH1jsCty.js";function Xe(t,s){const r=new Set(s);return t.filter(a=>!r.has(a))}function us(t,s,r){const a=t.slice(0);return a[s]=r,a}var ne,U,le,ie,J,ee,pe,be,fe,z,Te,$e,Oe,Ie,Be,at,gs=(at=class extends jt{constructor(s,r,a){super();Y(this,z);Y(this,ne);Y(this,U);Y(this,le);Y(this,ie);Y(this,J);Y(this,ee);Y(this,pe);Y(this,be);Y(this,fe,[]);H(this,ne,s),H(this,ie,a),H(this,le,[]),H(this,J,[]),H(this,U,[]),this.setQueries(r)}onSubscribe(){this.listeners.size===1&&$(this,J).forEach(s=>{s.subscribe(r=>{G(this,z,Ie).call(this,s,r)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,$(this,J).forEach(s=>{s.destroy()})}setQueries(s,r){H(this,le,s),H(this,ie,r),Le.batch(()=>{const a=$(this,J),c=G(this,z,Oe).call(this,$(this,le));H(this,fe,c),c.forEach(b=>b.observer.setOptions(b.defaultedQueryOptions));const l=c.map(b=>b.observer),n=l.map(b=>b.getCurrentResult()),p=a.length!==l.length,j=l.some((b,k)=>b!==a[k]),N=p||j,S=N?!0:n.some((b,k)=>{const u=$(this,U)[k];return!u||!vt(b,u)});!N&&!S||(N&&H(this,J,l),H(this,U,n),this.hasListeners()&&(N&&(Xe(a,l).forEach(b=>{b.destroy()}),Xe(l,a).forEach(b=>{b.subscribe(k=>{G(this,z,Ie).call(this,b,k)})})),G(this,z,Be).call(this)))})}getCurrentResult(){return $(this,U)}getQueries(){return $(this,J).map(s=>s.getCurrentQuery())}getObservers(){return $(this,J)}getOptimisticResult(s,r){const a=G(this,z,Oe).call(this,s),c=a.map(l=>l.observer.getOptimisticResult(l.defaultedQueryOptions));return[c,l=>G(this,z,$e).call(this,l??c,r),()=>G(this,z,Te).call(this,c,a)]}},ne=new WeakMap,U=new WeakMap,le=new WeakMap,ie=new WeakMap,J=new WeakMap,ee=new WeakMap,pe=new WeakMap,be=new WeakMap,fe=new WeakMap,z=new WeakSet,Te=function(s,r){return r.map((a,c)=>{const l=s[c];return a.defaultedQueryOptions.notifyOnChangeProps?l:a.observer.trackResult(l,n=>{r.forEach(p=>{p.observer.trackProp(n)})})})},$e=function(s,r){return r?((!$(this,ee)||$(this,U)!==$(this,be)||r!==$(this,pe))&&(H(this,pe,r),H(this,be,$(this,U)),H(this,ee,Nt($(this,ee),r(s)))),$(this,ee)):s},Oe=function(s){const r=new Map;$(this,J).forEach(c=>{const l=c.options.queryHash;if(!l)return;const n=r.get(l);n?n.push(c):r.set(l,[c])});const a=[];return s.forEach(c=>{var j;const l=$(this,ne).defaultQueryOptions(c),p=((j=r.get(l.queryHash))==null?void 0:j.shift())??new nt($(this,ne),l);a.push({defaultedQueryOptions:l,observer:p})}),a},Ie=function(s,r){const a=$(this,J).indexOf(s);a!==-1&&(H(this,U,us($(this,U),a,r)),G(this,z,Be).call(this))},Be=function(){var s;if(this.hasListeners()){const r=$(this,ee),a=G(this,z,Te).call(this,$(this,U),$(this,fe)),c=G(this,z,$e).call(this,a,(s=$(this,ie))==null?void 0:s.combine);r!==c&&Le.batch(()=>{this.listeners.forEach(l=>{l($(this,U))})})}},at);function Ze({queries:t,...s},r){const a=re(),c=kt(),l=wt(),n=g.useMemo(()=>t.map(C=>{const D=a.defaultQueryOptions(C);return D._optimisticResults=c?"isRestoring":"optimistic",D}),[t,a,c]);n.forEach(C=>{_t(C),Ct(C,l)}),St(l);const[p]=g.useState(()=>new gs(a,n,s)),[j,N,S]=p.getOptimisticResult(n,s.combine),b=!c&&s.subscribed!==!1;g.useSyncExternalStore(g.useCallback(C=>b?p.subscribe(Le.batchCalls(C)):Ft,[p,b]),()=>p.getCurrentResult(),()=>p.getCurrentResult()),g.useEffect(()=>{p.setQueries(n,s)},[n,s,p]);const u=j.some((C,D)=>Ve(n[D],C))?j.flatMap((C,D)=>{const R=n[D];if(R){const h=new nt(a,R);if(Ve(R,C))return We(R,h,l);Rt(C,c)&&We(R,h,l)}return[]}):[];if(u.length>0)throw Promise.all(u);const M=j.find((C,D)=>{const R=n[D];return R&&Mt({result:C,errorResetBoundary:l,throwOnError:R.throwOnError,query:a.getQueryCache().get(R.queryHash),suspense:R.suspense})});if(M!=null&&M.error)throw M.error;return N(S())}/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],ys=ae("archive",hs);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],bs=ae("arrow-down-right",ps);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],js=ae("arrow-right-left",fs);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],Ns=ae("arrow-up-right",vs);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],He=ae("gift",ks);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],_s=ae("layers",ws);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],Ss=ae("percent",Cs),Fs={bank:{icon:"ðŸ¦",color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/30"},cash:{icon:"ðŸ’µ",color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/30"},credit_card:{icon:"ðŸ’³",color:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-900/30"},investment:{icon:"ðŸ“ˆ",color:"text-orange-600",bgColor:"bg-orange-50 dark:bg-orange-900/30"},receivable:{icon:"ðŸ’°",color:"text-teal-600",bgColor:"bg-teal-50 dark:bg-teal-900/30"},savings:{icon:"ðŸ·",color:"text-pink-600",bgColor:"bg-pink-50 dark:bg-pink-900/30"},crypto:{icon:"â‚¿",color:"text-amber-600",bgColor:"bg-amber-50 dark:bg-amber-900/30"},other:{icon:"ðŸ“",color:"text-gray-600",bgColor:"bg-gray-50 dark:bg-gray-700"}};function Rs({account:t,onEdit:s,onAddTransaction:r}){const{t:a}=X("common"),c=At(),{data:l}=lt(),{isPrivacyMode:n}=_e(),p=Fs[t.type],j=t.current_balance>=0,N=()=>{const b=new Date,k=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}`;c({to:"/transactions",search:{accountId:t.id,month:k,fromAccounts:!0}})},S=b=>{b.stopPropagation(),r==null||r(t.id)};return e.jsxs(ue,{className:"relative hover:shadow-md transition-shadow cursor-pointer",onClick:N,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:O("p-3 rounded-lg",p.bgColor),children:e.jsx("span",{className:"text-2xl",children:p.icon})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg text-gray-900 dark:text-gray-100",children:t.name}),e.jsx("p",{className:O("text-sm",p.color),children:a(`account.type.${t.type}`)})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[r&&e.jsx("button",{onClick:S,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors","aria-label":a("transaction.addTransaction"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 text-green-600 dark:text-green-400",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})}),s&&e.jsx("button",{onClick:b=>{b.stopPropagation(),s(t.id)},className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors","aria-label":a("account.edit"),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5 text-gray-600 dark:text-gray-400",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})})}),!t.is_active&&e.jsx("span",{className:"text-xs px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-full",children:a("account.inactive")})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:a("account.currentBalance")}),e.jsx("p",{className:O("text-3xl font-bold font-mono",j?"text-green-600":"text-red-600"),children:te(t.current_balance,t.currency,(l==null?void 0:l.rates)||{},!0,n)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:a("account.initialBalance")}),e.jsx("p",{className:"text-sm font-mono text-gray-700 dark:text-gray-300",children:te(t.initial_balance,t.currency,(l==null?void 0:l.rates)||{},!0,n)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:a("account.transactions")}),e.jsx("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:t.transaction_count})]})]}),t.notes&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-gray-700",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:a("account.notes")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:t.notes})]})]})}const ce=t=>t==="USD"?100:1;function Ms({isOpen:t,onClose:s,editingAccountId:r}){const{t:a}=X("common"),c=Dt(),l=Pt(),{data:n}=qt(r||void 0),p=Ce(),{isPrivacyMode:j}=_e(),[N,S]=g.useState(""),[b,k]=g.useState("bank"),[u,M]=g.useState(""),[C,D]=g.useState(""),[R,h]=g.useState("JPY"),[w,y]=g.useState(""),[v,_]=g.useState({}),[q,L]=g.useState(""),[m,x]=g.useState(!1),d=["bank","cash","credit_card","investment","receivable","savings","other"],A=n&&n.transaction_count>0,E=(()=>{if(!n||!q)return null;const P=ce(n.currency),f=parseFloat(q)*P,o=n.current_balance;return f-o})();g.useEffect(()=>{if(t){if(r&&n)if(S(n.name),k(n.type),y(n.notes||""),h(n.currency),A)L(""),x(!1);else{const P=ce(n.currency);M((n.initial_balance/P).toString()),D(n.initial_balance_date)}else S(""),k("bank"),M("0"),D(new Date().toISOString().split("T")[0]),h("JPY"),y(""),L(""),x(!1);_({})}},[t,r,n,A]);const i=()=>{const P={};return N.trim()||(P.name=a("account.errors.nameRequired")),r?r&&!A&&(C||(P.initialBalanceDate=a("account.errors.dateRequired"))):C||(P.initialBalanceDate=a("account.errors.dateRequired")),_(P),Object.keys(P).length===0},F=async P=>{if(P.preventDefault(),!!i()){if(r&&A&&q&&!m){x(!0);return}try{if(r){const f={name:N.trim(),type:b,notes:w.trim()||void 0};if(!A&&n){const o=ce(n.currency);f.initial_balance=Math.round(parseFloat(u||"0")*o),f.initial_balance_date=C}if(A&&q&&n){const o=ce(n.currency);f.desired_current_balance=Math.round(parseFloat(q)*o)}await l.mutateAsync({id:r,data:f})}else{const f=ce(R),o={name:N.trim(),type:b,initial_balance:Math.round(parseFloat(u||"0")*f),initial_balance_date:C,currency:R,notes:w.trim()||void 0};await c.mutateAsync(o)}s()}catch(f){_({submit:f.message||a("account.errors.submitFailed")})}}};if(!t)return null;const Z=e.jsxs("div",{className:"fixed inset-0 z-[100001] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:s}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto overflow-x-hidden",style:{touchAction:"pan-y"},children:[e.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:a(r?"account.editAccount":"account.createAccount")}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-6 h-6",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:F,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[a("account.name")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",value:N,onChange:P=>S(P.target.value),className:O("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500","bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",v.name?"border-red-500":"border-gray-300 dark:border-gray-600"),placeholder:a("account.namePlaceholder")}),v.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.name})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"type",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[a("account.accountType")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("select",{id:"type",value:b,onChange:P=>k(P.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:d.map(P=>e.jsx("option",{value:P,children:a(`account.type.${P}`)},P))})]}),!r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"initialBalance",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:a("account.initialBalance")}),e.jsx("input",{type:"text",inputMode:"decimal",id:"initialBalance",value:Pe(u),onChange:P=>M(qe(P.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 font-numbers",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"initialBalanceDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[a("account.initialBalanceDate")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",id:"initialBalanceDate",value:C,onChange:P=>D(P.target.value),className:O("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500","bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",v.initialBalanceDate?"border-red-500":"border-gray-300 dark:border-gray-600")}),v.initialBalanceDate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.initialBalanceDate})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currency",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:a("account.currency")}),e.jsxs("select",{id:"currency",value:R,onChange:P=>h(P.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",children:[e.jsx("option",{value:"JPY",children:"JPY (Â¥)"}),e.jsx("option",{value:"USD",children:"USD ($)"}),e.jsx("option",{value:"VND",children:"VND (â‚«)"})]})]})]}),r&&!A&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"initialBalance",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:a("account.initialBalance")}),e.jsx("input",{type:"text",inputMode:"decimal",id:"initialBalance",value:Pe(u),onChange:P=>M(qe(P.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 font-numbers",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"initialBalanceDate",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[a("account.initialBalanceDate")," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",id:"initialBalanceDate",value:C,onChange:P=>D(P.target.value),className:O("w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500","bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",v.initialBalanceDate?"border-red-500":"border-gray-300 dark:border-gray-600")}),v.initialBalanceDate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:v.initialBalanceDate})]})]}),r&&A&&n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-blue-900 dark:text-blue-200",children:"Current Balance"}),e.jsx("span",{className:"text-lg font-bold text-blue-900 dark:text-blue-200",children:te(n.current_balance,n.currency,p,!0,j)})]}),e.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-1",children:[n.transaction_count," transactions"]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"desiredBalance",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Desired Current Balance"}),e.jsx("input",{type:"text",inputMode:"decimal",id:"desiredBalance",value:Pe(q),onChange:P=>{L(qe(P.target.value)),x(!1)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 font-numbers",placeholder:"Enter the actual balance"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Enter the actual balance from your bank/wallet to reconcile"})]}),E!==null&&E!==0&&e.jsx("div",{className:O("border rounded-lg p-4",E>0?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:O("text-sm font-medium",E>0?"text-green-900":"text-red-900"),children:"Adjustment Amount"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:O("text-lg font-bold",E>0?"text-green-900":"text-red-900"),children:E>0?"â†‘":"â†“"}),e.jsx("span",{className:O("text-lg font-bold",E>0?"text-green-900":"text-red-900"),children:te(Math.abs(E),n.currency,p,!0,j)})]})]})}),m&&E!==null&&E!==0&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.485 2.495c.673-1.167 2.357-1.167 3.03 0l6.28 10.875c.673 1.167-.17 2.625-1.516 2.625H3.72c-1.347 0-2.189-1.458-1.515-2.625L8.485 2.495zM10 5a.75.75 0 01.75.75v3.5a.75.75 0 01-1.5 0v-3.5A.75.75 0 0110 5zm0 9a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-900",children:"Confirm Balance Adjustment"}),e.jsxs("p",{className:"text-sm text-yellow-700 mt-1",children:["This will create a balance adjustment transaction of"," ",e.jsx("span",{className:"font-semibold",children:te(Math.abs(E),n.currency,p,!0,j)})," ","to reconcile your account balance."]})]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:a("account.notes")}),e.jsx("textarea",{id:"notes",value:w,onChange:P=>y(P.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",rows:3,placeholder:a("account.notesPlaceholder")})]}),v.submit&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-3",children:e.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm",children:v.submit})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[m&&e.jsx("button",{type:"button",onClick:()=>{x(!1),L("")},className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel Adjustment"}),!m&&e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:a("cancel")}),e.jsx("button",{type:"submit",disabled:c.isPending||l.isPending,className:O("flex-1 px-4 py-2 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",m?"bg-yellow-600 hover:bg-yellow-700":"bg-blue-600 hover:bg-blue-700"),children:c.isPending||l.isPending?a("saving"):m?"Confirm Adjustment":a(r?"update":"create")})]})]})]})]});return typeof document>"u"?null:Se.createPortal(Z,document.body)}const As=["eth","bsc","polygon"];function et({token:t,isPrivacyMode:s}){return e.jsxs("div",{className:"flex items-center justify-between py-1.5 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700/50",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[t.logo_url?e.jsx("img",{src:t.logo_url,alt:t.symbol,className:"w-5 h-5 rounded-full",onError:r=>{r.target.style.display="none"}}):e.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center text-[10px] font-medium",children:t.symbol.slice(0,2)}),e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 truncate",children:t.symbol})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:s?"***":Number(t.balance)<1e-4?"<0.0001":Number(t.balance).toFixed(4)}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s?"$***":`$${Number(t.balance_usd).toFixed(2)}`})]})]})}function tt(){const{t}=X("common"),s=re(),{currency:r}=it(),{isPrivacyMode:a}=_e(),c=Ce(),[l,n]=g.useState(!1),[p,j]=g.useState(""),[N,S]=g.useState(""),[b,k]=g.useState(["eth","bsc","polygon"]),[u,M]=g.useState(null),[C,D]=g.useState(null),{data:R,isLoading:h}=Q({queryKey:["crypto-wallets"],queryFn:xt}),{data:w}=Q({queryKey:["crypto-wallets-balance",R==null?void 0:R.map(f=>f.id)],queryFn:async()=>!R||R.length===0?[]:Promise.all(R.map(f=>Yt(f.id))),enabled:!!R&&R.length>0}),{data:y,isLoading:v}=Q({queryKey:["crypto-portfolio",C],queryFn:()=>Gt(C),enabled:!!C}),_=V({mutationFn:Vt,onSuccess:()=>{s.invalidateQueries({queryKey:["crypto-wallets"]}),n(!1),j(""),S(""),k(["eth","bsc","polygon"])}}),q=V({mutationFn:Wt,onSuccess:()=>{s.invalidateQueries({queryKey:["crypto-wallets"]}),s.invalidateQueries({queryKey:["crypto-wallets-balance"]})}}),L=V({mutationFn:Jt,onSuccess:()=>{s.invalidateQueries({queryKey:["crypto-wallets"]}),s.invalidateQueries({queryKey:["crypto-wallets-balance"]}),s.invalidateQueries({queryKey:["dashboard-summary"]}),M(null)},onError:()=>{M(null)}}),m=()=>{p.trim()&&_.mutate({wallet_address:p.trim(),label:N.trim()||void 0,chains:b})},x=f=>{confirm(t("confirmDelete"))&&q.mutate(f)},d=f=>{M(f),L.mutate(f)},A=f=>{k(o=>o.includes(f)?o.filter(K=>K!==f):[...o,f])},I=f=>{D(o=>o===f?null:f)},E=f=>`${f.slice(0,6)}...${f.slice(-4)}`,i=(f,o)=>{const K={eth:`https://etherscan.io/address/${f}`,bsc:`https://bscscan.com/address/${f}`,polygon:`https://polygonscan.com/address/${f}`,arbitrum:`https://arbiscan.io/address/${f}`,optimism:`https://optimistic.etherscan.io/address/${f}`};return K[o]||K.eth},F=(w==null?void 0:w.reduce((f,o)=>f+Number(o.total_balance_usd||0),0))||0,Z=1/((c==null?void 0:c.USD)||.00667),P=Math.round(F*Z);return h?e.jsx(ke,{title:t("crypto.wallets"),badge:0,children:e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(ge,{size:"md"})})}):e.jsxs(ke,{title:t("crypto.wallets"),badge:(R==null?void 0:R.length)||0,defaultOpen:R&&R.length>0,children:[w&&w.length>0&&e.jsxs("div",{className:"mb-4 p-4 bg-gradient-to-r from-purple-500/10 to-blue-500/10 dark:from-purple-900/20 dark:to-blue-900/20 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("crypto.totalBalance")}),e.jsx("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:te(P,r,c,!1,a)})]}),w&&w.length>0?e.jsx("div",{className:"space-y-3 mb-4",children:w.map(f=>{var o,K;return e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg",children:e.jsx(ve,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:f.label||E(f.wallet_address)}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx("code",{className:"text-xs",children:E(f.wallet_address)}),e.jsx("a",{href:i(f.wallet_address,"eth"),target:"_blank",rel:"noopener noreferrer",className:"hover:text-purple-500",children:e.jsx(Ke,{className:"w-3 h-3"})})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:a?"$***":`$${Number(f.total_balance_usd||0).toFixed(2)}`}),e.jsx("div",{className:"flex gap-1 mt-1",children:(o=f.chains)==null?void 0:o.map(T=>{var B;return e.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-gray-200 dark:bg-gray-700 rounded",title:(B=we[T])==null?void 0:B.name,children:T.toUpperCase()},T)})})]})]}),e.jsxs("button",{onClick:()=>I(f.id),className:"flex items-center gap-2 mt-3 text-sm text-purple-600 dark:text-purple-400 hover:text-purple-700 dark:hover:text-purple-300 transition-colors",children:[C===f.id?e.jsx(Me,{className:"w-4 h-4"}):e.jsx(ot,{className:"w-4 h-4"}),t("crypto.tokens")]}),C===f.id&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:v?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(ge,{size:"sm"})}):y!=null&&y.chains&&y.chains.length>0?e.jsx("div",{className:"space-y-4",children:y.chains.filter(T=>T.tokens.length>0||T.native_balance).sort((T,B)=>Number(B.total_usd)-Number(T.total_usd)).map(T=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase",children:T.chain_name}),e.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:a?"$***":`$${Number(T.total_usd).toFixed(2)}`})]}),e.jsxs("div",{className:"space-y-1",children:[T.native_balance&&Number(T.native_balance.balance)>0&&e.jsx(et,{token:T.native_balance,isPrivacyMode:a}),T.tokens.filter(B=>Number(B.balance_usd)>=1).sort((B,Ae)=>Number(Ae.balance_usd)-Number(B.balance_usd)).map(B=>e.jsx(et,{token:B,isPrivacyMode:a},B.token_address))]})]},T.chain_id))}):e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 text-center py-2",children:t("crypto.noTokens")})}),e.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500",children:(K=f.sync_statuses)!=null&&K.some(T=>T.last_sync_at)?t("crypto.lastSync",{time:new Date(Math.max(...f.sync_statuses.filter(T=>T.last_sync_at).map(T=>new Date(T.last_sync_at).getTime()))).toLocaleString()}):t("crypto.neverSynced")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d(f.id),disabled:u===f.id,className:"p-2 text-gray-500 hover:text-purple-600 hover:bg-purple-50 dark:hover:bg-purple-900/30 rounded-lg transition-colors",title:t("crypto.sync"),children:u===f.id?e.jsx(ge,{size:"sm"}):e.jsx(se,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>x(f.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-lg transition-colors",title:t("delete"),children:e.jsx(Lt,{className:"w-4 h-4"})})]})]})]},f.id)})}):l?null:e.jsxs("div",{className:"text-center py-6",children:[e.jsx(ve,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-2",children:t("crypto.noWallets")}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500",children:t("crypto.addWalletDescription")})]}),l?e.jsxs("div",{className:"p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-4",children:[e.jsx(Je,{label:t("crypto.walletAddress"),placeholder:"0x...",value:p,onChange:f=>j(f.target.value)}),e.jsx(Je,{label:t("crypto.walletLabel"),placeholder:t("crypto.walletLabelPlaceholder"),value:N,onChange:f=>S(f.target.value)}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t("crypto.selectChains")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:As.map(f=>{var o;return e.jsx("button",{type:"button",onClick:()=>A(f),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${b.includes(f)?"bg-purple-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:((o=we[f])==null?void 0:o.name)||f.toUpperCase()},f)})})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(he,{variant:"outline",onClick:()=>n(!1),children:t("cancel")}),e.jsx(he,{onClick:m,disabled:!p.trim()||b.length===0||_.isPending,children:_.isPending?t("saving"):t("crypto.addWallet")})]})]}):e.jsxs(he,{variant:"outline",onClick:()=>n(!0),className:"w-full",children:[e.jsx(ze,{className:"w-4 h-4 mr-2"}),t("crypto.addWallet")]})]})}function Ds({snapshots:t}){const{resolvedTheme:s}=Et(),r=s==="dark",a=r?"#374151":"#E5E7EB",c=r?"#9CA3AF":"#6B7280",l=r?"#1F2937":"#FFFFFF",n=r?"#374151":"#E5E7EB",p="#6366F1",j=g.useMemo(()=>[...t].sort((b,k)=>new Date(b.snapshot_date).getTime()-new Date(k.snapshot_date).getTime()).map(b=>({date:b.snapshot_date,value:Number(b.balance_usd),formattedDate:new Date(b.snapshot_date).toLocaleDateString("en-US",{month:"short",day:"numeric"})})),[t]),[N,S]=g.useMemo(()=>{const b=j.map(C=>C.value),k=Math.min(...b),u=Math.max(...b),M=(u-k)*.1||10;return[Math.max(0,k-M),u+M]},[j]);return j.length===0?e.jsx("div",{className:"flex items-center justify-center h-full text-gray-500",children:"No historical data available"}):e.jsx(as,{width:"100%",height:"100%",children:e.jsxs(ls,{data:j,margin:{top:5,right:10,left:0,bottom:5},children:[e.jsx(is,{strokeDasharray:"3 3",stroke:a,vertical:!1}),e.jsx(os,{dataKey:"formattedDate",tick:{fill:c,fontSize:11},tickLine:!1,axisLine:{stroke:a},interval:"preserveStartEnd"}),e.jsx(ds,{domain:[N,S],tick:{fill:c,fontSize:11},tickLine:!1,axisLine:!1,tickFormatter:b=>`$${b.toFixed(0)}`,width:50}),e.jsx(ns,{contentStyle:{backgroundColor:l,border:`1px solid ${n}`,borderRadius:"8px",fontSize:"12px"},labelStyle:{color:c,fontWeight:"bold"},formatter:b=>[`$${b.toFixed(2)}`,"Value"]}),e.jsx(cs,{type:"monotone",dataKey:"value",stroke:p,strokeWidth:2,dot:j.length<=10,activeDot:{r:6,fill:p}})]})})}function Ps({positionId:t}){var I,E;const{t:s}=X(),r=re(),[a,c]=g.useState(null),[l,n]=g.useState(!1),[p,j]=g.useState(null),[N,S]=g.useState(null),[b,k]=g.useState(null),{data:u,isLoading:M}=Q({queryKey:["position-roi",t],queryFn:()=>ht(t)}),{data:C=[]}=Q({queryKey:["position-rewards-list",t],queryFn:()=>Xt(t)}),D=V({mutationFn:()=>mt(90),onSuccess:i=>{c({scanned:i.scanned_claims,new:i.new_claims}),r.invalidateQueries({queryKey:["position-roi"]}),r.invalidateQueries({queryKey:["position-rewards-list"]}),r.invalidateQueries({queryKey:["unattributed-rewards"]}),setTimeout(()=>c(null),5e3)}}),R=V({mutationFn:i=>ut(i),onSuccess:i=>{S(s("crypto.transactionCreated","Transaction created: ${{amount}}",{amount:i.amount_usd.toFixed(2)})),r.invalidateQueries({queryKey:["position-rewards-list"]}),r.invalidateQueries({queryKey:["transactions"]}),j(null),setTimeout(()=>S(null),5e3)},onError:i=>{k(i.message||s("crypto.transactionCreateError","Failed to create transaction")),j(null),setTimeout(()=>k(null),5e3)}}),h=V({mutationFn:i=>gt(i),onSuccess:i=>{const F=s("crypto.batchTransactionsCreated","Created {{created}} transactions (${{total}}). Skipped: {{skipped}}",{created:i.created,total:i.total_usd.toFixed(2),skipped:i.skipped});S(F),r.invalidateQueries({queryKey:["position-rewards-list"]}),r.invalidateQueries({queryKey:["transactions"]}),setTimeout(()=>S(null),8e3)},onError:i=>{k(i.message||s("crypto.batchTransactionError","Failed to create transactions")),setTimeout(()=>k(null),5e3)}}),w=C.filter(i=>!i.transaction_id),y=1,v=((I=u==null?void 0:u.rewards_by_token)==null?void 0:I.filter(i=>Number(i.amount_usd)>=y))||[],_=((E=u==null?void 0:u.rewards_by_month)==null?void 0:E.filter(i=>Number(i.amount_usd)>=y))||[],q=C.filter(i=>Number(i.reward_usd||0)>=y),L=v.reduce((i,F)=>i+Number(F.amount_usd||0),0);if(M)return e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded-lg"}),e.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-lg"})]});const m=i=>{if(i==null)return null;const F=Number(i);return isNaN(F)?null:`$${F.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`},x=i=>{if(i===null)return"-";const F=Number(i);return`${F>=0?"+":""}${F.toFixed(2)}%`},d=i=>{const[F,Z]=i.split("-");return new Date(Number(F),Number(Z)-1).toLocaleDateString(void 0,{month:"short",year:"numeric"})},A=i=>Number(i).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg",children:[e.jsx("div",{className:"text-sm text-indigo-700 dark:text-indigo-300",children:s("crypto.scanRewardsHint","Scan blockchain for claimed rewards")}),e.jsx("button",{onClick:()=>D.mutate(),disabled:D.isPending,className:"flex items-center gap-2 px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 text-white text-sm font-medium rounded-lg transition-colors",children:D.isPending?e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"h-4 w-4 animate-spin"}),s("crypto.scanning","Scanning...")]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"h-4 w-4"}),s("crypto.scanRewards","Scan Rewards")]})})]}),a&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg text-sm text-green-700 dark:text-green-300",children:[e.jsx(ye,{className:"h-4 w-4"}),s("crypto.scanComplete","Scanned {{scanned}} claims, found {{new}} new",a)]}),u&&e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-green-800 dark:text-green-200 mb-3 flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),s("crypto.roiSummary","ROI Summary")]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-green-600 dark:text-green-400",children:s("crypto.totalRewards","Total Rewards")}),v.length>0?e.jsx("div",{className:"space-y-1",children:v.map(i=>{const F=m(i.amount_usd);return e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-semibold text-green-800 dark:text-green-200",children:[A(i.amount)," ",i.symbol]}),F&&e.jsxs("div",{className:"text-sm text-green-600 dark:text-green-400",children:["â‰ˆ ",F]})]},i.symbol)})}):e.jsx("div",{className:"text-lg font-semibold text-green-800 dark:text-green-200",children:m(L)||"-"}),e.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:[q.length," ",s("crypto.claims","claims")]})]}),u.cost_basis_usd!==null&&u.simple_roi_pct!==null&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2 border-t border-green-200 dark:border-green-800",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-green-600 dark:text-green-400",children:s("crypto.costBasis","Cost Basis")}),e.jsx("div",{className:"text-lg font-semibold text-green-800 dark:text-green-200",children:m(u.cost_basis_usd)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-green-600 dark:text-green-400",children:s("crypto.roi","ROI")}),e.jsx("div",{className:`text-lg font-semibold ${u.simple_roi_pct>=0?"text-green-800 dark:text-green-200":"text-red-600 dark:text-red-400"}`,children:x(u.simple_roi_pct)}),u.days_held&&e.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400",children:[u.days_held," ",s("crypto.daysHeld","days")]})]})]})]})]}),u&&_.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),s("crypto.monthlyBreakdown","Monthly Breakdown")]}),e.jsx("div",{className:"space-y-2",children:_.map(i=>{const F=m(i.amount_usd);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:d(i.month)}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[i.count," ",s("crypto.claims","claims")]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-semibold text-gray-900 dark:text-gray-100",children:[A(i.amount)," ",i.symbol]}),F&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["â‰ˆ ",F]})]})]},`${i.month}-${i.symbol}`)})})]}),q.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("button",{onClick:()=>n(!l),className:"flex items-center gap-2 font-medium text-gray-900 dark:text-gray-100 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",children:[e.jsx(Ee,{className:"h-4 w-4"}),s("crypto.allRewards","All Rewards")," (",q.length,")",l?e.jsx(bt,{className:"h-4 w-4"}):e.jsx(Me,{className:"h-4 w-4"})]}),w.length>0&&e.jsxs("button",{type:"button",onClick:()=>h.mutate(w.map(i=>i.id)),disabled:h.isPending,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-white bg-primary-600 hover:bg-primary-700 disabled:bg-primary-400 rounded-lg transition-colors",children:[h.isPending?e.jsx(Ne,{className:"h-3.5 w-3.5 animate-spin"}):e.jsx(ze,{className:"h-3.5 w-3.5"}),s("crypto.createAllTransactions","Create All Txns")," (",w.length,")"]})]}),l&&e.jsxs(e.Fragment,{children:[N&&e.jsxs("div",{className:"flex items-center gap-2 p-3 mb-3 bg-green-50 dark:bg-green-900/20 rounded-lg text-sm text-green-700 dark:text-green-300",children:[e.jsx(ye,{className:"h-4 w-4"}),N]}),b&&e.jsxs("div",{className:"flex items-center gap-2 p-3 mb-3 bg-red-50 dark:bg-red-900/20 rounded-lg text-sm text-red-700 dark:text-red-300",children:[e.jsx(oe,{className:"h-4 w-4"}),b]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:q.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:[Number(i.reward_amount).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:4})," ",i.reward_token_symbol||"tokens"]}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[new Date(i.claimed_at).toLocaleDateString()," via ",i.source,i.reward_usd&&e.jsxs("span",{className:"ml-2 text-green-600 dark:text-green-400",children:["â‰ˆ $",Number(i.reward_usd).toFixed(2)]})]})]}),i.reward_usd&&Number(i.reward_usd)>0&&e.jsx("div",{className:"flex-shrink-0 ml-3",children:i.transaction_id?e.jsxs("a",{href:`/transactions?id=${i.transaction_id}`,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-700 dark:text-green-300 bg-green-100 dark:bg-green-900/30 rounded hover:bg-green-200 dark:hover:bg-green-900/50 transition-colors",children:[e.jsx(Ke,{className:"h-3 w-3"}),s("crypto.viewTransaction","View Txn")]}):e.jsxs("button",{type:"button",onClick:()=>{j(i.id),R.mutate(i.id)},disabled:p===i.id,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-primary-700 dark:text-primary-300 bg-primary-100 dark:bg-primary-900/30 rounded hover:bg-primary-200 dark:hover:bg-primary-900/50 disabled:opacity-50 transition-colors",children:[p===i.id?e.jsx(Ne,{className:"h-3 w-3 animate-spin"}):e.jsx(Ee,{className:"h-3 w-3"}),s("crypto.createTransaction","Create Txn")]})})]},i.id))})]})]}),u&&q.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx(He,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),L<y?s("crypto.rewardsBelowThreshold","No rewards above ${{threshold}} to display",{threshold:y}):s("crypto.noRewards","No rewards claimed for this position yet.")]})]})}function qs({source:t="symbiotic"}){var q,L;const{t:s}=X(),r=re(),[a,c]=g.useState(null),[l,n]=g.useState(null),[p,j]=g.useState(null),{data:N,isLoading:S}=Q({queryKey:["staking-rewards",t],queryFn:()=>Zt(t)}),{data:b=[]}=Q({queryKey:["all-rewards"],queryFn:es}),k=b.filter(m=>!m.transaction_id&&m.reward_usd&&Number(m.reward_usd)>0),u=V({mutationFn:()=>mt(90),onSuccess:m=>{c({scanned:m.scanned_claims,new:m.new_claims}),r.invalidateQueries({queryKey:["staking-rewards"]}),r.invalidateQueries({queryKey:["all-rewards"]}),setTimeout(()=>c(null),5e3)}}),M=V({mutationFn:m=>gt(m),onSuccess:m=>{const x=s("crypto.batchTransactionsCreated","Created {{created}} transactions (${{total}}). Skipped: {{skipped}}",{created:m.created,total:m.total_usd.toFixed(2),skipped:m.skipped});n(x),r.invalidateQueries({queryKey:["all-rewards"]}),r.invalidateQueries({queryKey:["staking-rewards"]}),r.invalidateQueries({queryKey:["transactions"]}),setTimeout(()=>n(null),8e3)},onError:m=>{j(m.message||s("crypto.batchTransactionError","Failed to create transactions")),setTimeout(()=>j(null),5e3)}});if(S)return e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded-lg"}),e.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-lg"})]});const C=m=>{if(m==null)return null;const x=Number(m);return isNaN(x)?null:`$${x.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`},D=m=>{const[x,d]=m.split("-");return new Date(Number(x),Number(d)-1).toLocaleDateString(void 0,{month:"short",year:"numeric"})},R=m=>Number(m).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:4}),h=t==="symbiotic"?"Symbiotic":t,w=1,y=((q=N==null?void 0:N.rewards_by_token)==null?void 0:q.filter(m=>Number(m.amount_usd)>=w))||[],v=((L=N==null?void 0:N.rewards_by_month)==null?void 0:L.filter(m=>Number(m.amount_usd)>=w))||[],_=y.reduce((m,x)=>m+Number(x.amount_usd||0),0);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-indigo-50 dark:bg-indigo-900/20 rounded-lg",children:[e.jsx("div",{className:"text-sm text-indigo-700 dark:text-indigo-300",children:s("crypto.scanStakingRewardsHint","Scan blockchain for claimed staking rewards")}),e.jsx("button",{onClick:()=>u.mutate(),disabled:u.isPending,className:"flex items-center gap-2 px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 text-white text-sm font-medium rounded-lg transition-colors",children:u.isPending?e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"h-4 w-4 animate-spin"}),s("crypto.scanning","Scanning...")]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"h-4 w-4"}),s("crypto.scanRewards","Scan Rewards")]})})]}),a&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg text-sm text-green-700 dark:text-green-300",children:[e.jsx(ye,{className:"h-4 w-4"}),s("crypto.scanComplete","Scanned {{scanned}} claims, found {{new}} new",a)]}),l&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg text-sm text-green-700 dark:text-green-300",children:[e.jsx(ye,{className:"h-4 w-4"}),l]}),p&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg text-sm text-red-700 dark:text-red-300",children:[e.jsx(oe,{className:"h-4 w-4"}),p]}),k.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg",children:[e.jsx("div",{className:"text-sm text-amber-700 dark:text-amber-300",children:s("crypto.unlinkedRewardsHint","{{count}} rewards ready to convert to transactions",{count:k.length})}),e.jsx("button",{onClick:()=>M.mutate(k.map(m=>m.id)),disabled:M.isPending,className:"flex items-center gap-2 px-3 py-1.5 bg-amber-600 hover:bg-amber-700 disabled:bg-amber-400 text-white text-sm font-medium rounded-lg transition-colors",children:M.isPending?e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-4 w-4 animate-spin"}),s("crypto.creating","Creating...")]}):e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-4 w-4"}),s("crypto.createAllTransactions","Create All Txns")," (",k.length,")"]})})]}),N&&y.length>0&&e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-green-800 dark:text-green-200 mb-3 flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),s("crypto.stakingRewardsSummary","{{source}} Rewards Summary",{source:h})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-green-600 dark:text-green-400",children:s("crypto.totalRewards","Total Rewards")}),y.length>0?e.jsx("div",{className:"space-y-1",children:y.map(m=>{const x=C(m.amount_usd);return e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-semibold text-green-800 dark:text-green-200",children:[R(m.amount)," ",m.symbol]}),x&&e.jsxs("div",{className:"text-sm text-green-600 dark:text-green-400",children:["â‰ˆ ",x]})]},m.symbol)})}):e.jsx("div",{className:"text-lg font-semibold text-green-800 dark:text-green-200",children:C(_)||"-"}),e.jsxs("div",{className:"text-xs text-green-600 dark:text-green-400 mt-1",children:[v.reduce((m,x)=>m+x.count,0)," ",s("crypto.claims","claims")]})]})})]}),N&&v.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[e.jsx(Qe,{className:"h-4 w-4"}),s("crypto.monthlyBreakdown","Monthly Breakdown")]}),e.jsx("div",{className:"space-y-2",children:v.map(m=>{const x=C(m.amount_usd);return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:D(m.month)}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[m.count," ",s("crypto.claims","claims")]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-semibold text-gray-900 dark:text-gray-100",children:[R(m.amount)," ",m.symbol]}),x&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["â‰ˆ ",x]})]})]},`${m.month}-${m.symbol}`)})})]}),N&&y.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx(He,{className:"h-12 w-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2",children:_<w?s("crypto.rewardsBelowThreshold","No rewards above ${{threshold}} to display",{threshold:w}):s("crypto.noStakingRewards","No staking rewards found")}),e.jsx("p",{className:"text-sm",children:s("crypto.noStakingRewardsHint",'Click "Scan Rewards" to search for claimed rewards on the blockchain.')})]})]})}async function Ls(t,s){return(await Re.post(`/api/crypto/positions/${encodeURIComponent(t)}/close`,s)).data}async function Es(){return(await Re.get("/api/crypto/positions/closed")).data}function Ts({group:t,lastSnapshotValueUsd:s,costBasisUsd:r,totalRewardsUsd:a,onClose:c,onSuccess:l}){var i;const{t:n}=X("common"),{data:p}=lt(),j=((i=p==null?void 0:p.rates)==null?void 0:i.USD)||150,N=re(),[S,b]=g.useState(new Date().toISOString().slice(0,16)),[k,u]=g.useState(s),[M,C]=g.useState(Math.round(s*j)),[D,R]=g.useState(null),[h,w]=g.useState(`LP Exit: ${t.protocol} ${t.name}`),[y,v]=g.useState("");g.useEffect(()=>{C(Math.round(k*j))},[k,j]);const{data:_}=Q({queryKey:["accounts"],queryFn:()=>$t()}),q=(_==null?void 0:_.filter(F=>F.is_active&&(F.type==="bank"||F.type==="savings")))||[],L=r!==null?k-r+(a||0):null,m=r&&L!==null?L/r*100:null,x=t.tokens[0],d=(x==null?void 0:x.id)||"",A=(x==null?void 0:x.wallet_address)||"",I=V({mutationFn:()=>{if(!D)throw new Error(n("crypto.selectAccount","Select destination account"));const F={exit_date:new Date(S).toISOString(),exit_value_usd:k,exit_value_jpy:M,destination_account_id:D,note:h||void 0,tx_hash:y||void 0,wallet_address:A,chain_id:t.chain_id,protocol:t.protocol,symbol:t.name};return Ls(d,F)},onSuccess:()=>{N.invalidateQueries({queryKey:["closed-positions"]}),N.invalidateQueries({queryKey:["defi-positions"]}),N.invalidateQueries({queryKey:["accounts"]}),l(),c()}}),E=e.jsxs("div",{className:"fixed inset-0 z-[100001] flex items-center justify-center p-4 overflow-hidden",style:{touchAction:"pan-y"},children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:c}),e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto overflow-x-hidden",onClick:F=>F.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:n("crypto.closePosition","Close Position")}),e.jsx("button",{onClick:c,className:"p-2 text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:e.jsx(oe,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-3",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[t.protocol," - ",t.name]}),e.jsx("p",{className:"text-xs text-gray-500",children:t.chain_id.toUpperCase()})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(Qe,{className:"w-4 h-4 inline mr-1"}),n("crypto.exitDate","Exit Date")]}),e.jsx("input",{type:"datetime-local",value:S,onChange:F=>b(F.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(dt,{className:"w-4 h-4 inline mr-1"}),n("crypto.exitValue","Exit Value")," (USD)"]}),e.jsx("input",{type:"number",step:"0.01",value:k,onChange:F=>u(parseFloat(F.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[n("crypto.exitValue","Exit Value")," (JPY)"]}),e.jsx("input",{type:"number",value:M,onChange:F=>C(parseInt(F.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(ve,{className:"w-4 h-4 inline mr-1"}),n("crypto.destinationAccount","Destination Account")]}),e.jsxs("select",{value:D||"",onChange:F=>R(parseInt(F.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"",children:n("select","Select...")}),q.map(F=>e.jsx("option",{value:F.id,children:F.name},F.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:n("note","Note")}),e.jsx("input",{type:"text",value:h,onChange:F=>w(F.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["TX Hash (",n("optional","optional"),")"]}),e.jsx("input",{type:"text",value:y,onChange:F=>v(F.target.value),placeholder:"0x...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white font-mono text-sm"})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4 space-y-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:n("crypto.pnlPreview","P&L Preview")}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:n("crypto.costBasis","Cost Basis")}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:r!==null?`$${r.toFixed(2)}`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500",children:n("crypto.totalRewards","Total Rewards")}),e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a?`$${a.toFixed(2)}`:"$0.00"})]}),e.jsxs("div",{className:"col-span-2 pt-2 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("p",{className:"text-gray-500",children:n("crypto.realizedPnl","Realized P&L")}),e.jsx("p",{className:`text-lg font-bold ${L!==null?L>=0?"text-green-600":"text-red-600":"text-gray-400"}`,children:L!==null?`${L>=0?"+":""}$${L.toFixed(2)} (${m==null?void 0:m.toFixed(1)}%)`:"N/A"})]})]})]}),I.error&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(Tt,{className:"w-4 h-4"}),I.error.message]})]}),e.jsxs("div",{className:"flex gap-3 p-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:c,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800",children:n("cancel","Cancel")}),e.jsx("button",{onClick:()=>I.mutate(),disabled:!D||I.isPending,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:I.isPending?n("loading","Loading..."):n("crypto.confirmClose","Confirm Close")})]})]})]});return typeof document>"u"?null:Se.createPortal(E,document.body)}function $s({group:t,onClose:s}){const[r,a]=g.useState("overview"),[c,l]=g.useState(!1),n=t.tokens[0],p=Ze({queries:t.tokens.map(h=>({queryKey:["position-history",h.id],queryFn:()=>ts(h.id,30),retry:!1}))}),j=p.some(h=>h.isLoading),N=g.useMemo(()=>{const h=p.filter(v=>{var _;return(_=v.data)==null?void 0:_.snapshots}).flatMap(v=>v.data.snapshots);if(h.length===0)return null;const w=new Map;for(const v of h){const _=w.get(v.snapshot_date)||0;w.set(v.snapshot_date,_+Number(v.balance_usd))}return{snapshots:Array.from(w.entries()).map(([v,_])=>({snapshot_date:v,balance_usd:_}))}},[p]),S=Ze({queries:t.tokens.map(h=>({queryKey:["position-performance",h.id],queryFn:()=>ss(h.id),retry:!1}))}),b=S.some(h=>h.isLoading),k=S.every(h=>!h.isLoading),u=g.useMemo(()=>{if(!k)return null;const h=S.filter(E=>E.data);if(h.length===0)return null;const w=h[0].data;if(h.length===1)return w;let y=0,v=0,_=0,q=0,L=0,m=!1,x=0,d=0;for(const E of h){const i=E.data;y+=Number(i.start_value_usd),v+=Number(i.current_value_usd),_+=Number(i.total_return_usd),q=Math.max(q,i.days_held),L+=i.snapshot_count,i.il_usd!=null&&(m=!0,x+=Number(i.il_usd)),i.hodl_value_usd!=null&&(d+=Number(i.hodl_value_usd))}const A=y>0?_/y*100:0;let I=null;if(q>=7&&y>0){const E=((v/y)**(365/q)-1)*100;Math.abs(E)<=500&&(I=E)}return{position_id:w.position_id,protocol:w.protocol,symbol:t.name,days_held:q,start_value_usd:y,current_value_usd:v,total_return_usd:_,total_return_pct:A,annualized_return_pct:I,current_apy:w.current_apy,snapshot_count:L,il_percentage:m&&y>0?x/y*100:null,il_usd:m?x:null,hodl_value_usd:m?d:null,lp_vs_hodl_usd:m?v-d:null,lp_outperformed_hodl:m?v>d:void 0}},[S,t.name,k]),{data:M}=Q({queryKey:["position-roi",n.id],queryFn:()=>ht(n.id),retry:!1}),C=j||b,D=h=>{const w=Number(h.balance);return w<1e-4?"<0.0001":w<1?w.toFixed(4):w.toFixed(2)},R=e.jsxs("div",{className:"fixed inset-0 z-[100001]",children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm",onClick:s}),e.jsx("div",{className:"fixed inset-0 z-[100002] flex items-center justify-center p-4 overflow-y-auto",children:e.jsxs("div",{className:"relative bg-white dark:bg-gray-900 rounded-2xl shadow-2xl max-w-lg w-full mx-4 max-h-[90dvh] my-auto overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-gray-900 to-gray-800 dark:from-gray-800 dark:to-gray-900 p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex -space-x-2",children:t.tokens.slice(0,3).map((h,w)=>h.logo_url?e.jsx("img",{src:h.logo_url,alt:h.symbol,className:"w-10 h-10 rounded-full border-2 border-white/20",style:{zIndex:t.tokens.length-w}},h.id):e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-bold text-sm border-2 border-white/20",style:{zIndex:t.tokens.length-w},children:h.symbol.slice(0,2)},h.id))}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:t.protocol}),e.jsx("p",{className:"text-gray-400 text-sm",children:t.name})]})]}),e.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-white hover:bg-white/10 rounded-lg transition-colors",children:e.jsx(oe,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-400 text-sm mb-1",children:"Current Value"}),e.jsxs("p",{className:"text-4xl font-bold",children:["$",t.total_usd.toFixed(2)]}),e.jsx("div",{className:"flex items-center justify-center gap-2 mt-2 text-sm",children:e.jsx("span",{className:"text-gray-400",children:t.tokens.map((h,w)=>e.jsxs("span",{children:[w>0&&" + ",D(h)," ",h.symbol]},h.id))})})]})]}),e.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:[e.jsx("button",{onClick:()=>a("overview"),className:O("flex-1 px-4 py-3 text-sm font-medium transition-colors",r==="overview"?"text-indigo-600 dark:text-indigo-400 border-b-2 border-indigo-600 dark:border-indigo-400":"text-gray-500 hover:text-gray-700"),children:"Gain/Loss"}),e.jsxs("button",{onClick:()=>a("rewards"),className:O("flex-1 px-4 py-3 text-sm font-medium transition-colors flex items-center justify-center gap-2",r==="rewards"?"text-indigo-600 dark:text-indigo-400 border-b-2 border-indigo-600 dark:border-indigo-400":"text-gray-500 hover:text-gray-700"),children:[e.jsx(He,{className:"w-4 h-4"}),"Rewards"]})]}),e.jsx("div",{className:"p-4 space-y-4 max-h-[50vh] overflow-y-auto",children:C?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(ge,{size:"lg"})}):e.jsxs(e.Fragment,{children:[r==="overview"&&e.jsxs(e.Fragment,{children:[u&&e.jsxs(ue,{className:"overflow-hidden",children:[e.jsxs("div",{className:O("p-4 text-center",Number(u.total_return_pct)>=0?"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20":"bg-gradient-to-br from-red-50 to-rose-50 dark:from-red-900/20 dark:to-rose-900/20"),children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[Number(u.total_return_pct)>=0?e.jsx(Ns,{className:"w-5 h-5 text-green-600"}):e.jsx(bs,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:O("text-sm font-medium",Number(u.total_return_pct)>=0?"text-green-700 dark:text-green-400":"text-red-700 dark:text-red-400"),children:"Total Return"})]}),e.jsxs("p",{className:O("text-3xl font-bold",Number(u.total_return_pct)>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:[Number(u.total_return_pct)>=0?"+":"",u.total_return_pct.toFixed(2),"%"]}),e.jsxs("p",{className:O("text-lg font-semibold mt-1",Number(u.total_return_usd)>=0?"text-green-700 dark:text-green-400":"text-red-700 dark:text-red-400"),children:[Number(u.total_return_usd)>=0?"+":"","$",Math.abs(Number(u.total_return_usd)).toFixed(2)]})]}),e.jsxs("div",{className:"p-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-gray-500 dark:text-gray-400 text-xs mb-1",children:[e.jsx(dt,{className:"w-3.5 h-3.5"}),"Invested"]}),e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:["$",Number(u.start_value_usd).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-gray-500 dark:text-gray-400 text-xs mb-1",children:[e.jsx(xs,{className:"w-3.5 h-3.5"}),"Duration"]}),e.jsxs("p",{className:"font-semibold text-gray-900 dark:text-white",children:[u.days_held," days"]})]})]})]}),u&&u.annualized_return_pct!==null&&e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ss,{className:"w-4 h-4 text-indigo-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Annualized Return"})]}),e.jsxs("span",{className:O("font-bold text-lg",Number(u.annualized_return_pct)>=0?"text-green-600":"text-red-600"),children:[Number(u.annualized_return_pct)>=0?"+":"",u.annualized_return_pct.toFixed(2),"%"]})]})}),u&&u.current_apy!=null&&e.jsx(ue,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Current APY"})]}),e.jsxs("span",{className:"font-bold text-lg text-purple-600 dark:text-purple-400",children:[Number(u.current_apy).toFixed(2),"%"]})]})}),N&&N.snapshots.length>0&&e.jsxs(ue,{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-3",children:"30-Day Performance"}),e.jsx("div",{className:"h-40",children:e.jsx(Ds,{snapshots:N.snapshots})})]}),e.jsx("button",{onClick:()=>l(!0),className:"w-full py-3 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors",children:"Close Position"})]}),r==="rewards"&&e.jsx(e.Fragment,{children:t.protocol_module==="staked"?e.jsx(qs,{source:"symbiotic"}):e.jsx(Ps,{positionId:n.id})})]})}),c&&e.jsx(Ts,{group:t,lastSnapshotValueUsd:t.total_usd,costBasisUsd:(M==null?void 0:M.cost_basis_usd)??null,totalRewardsUsd:(M==null?void 0:M.total_rewards_usd)??null,onClose:()=>l(!1),onSuccess:()=>{l(!1),s()}})]})})]});return typeof document>"u"?null:Se.createPortal(R,document.body)}function Os({walletId:t}){const{t:s}=X(),r=re(),[a,c]=g.useState(new Set),[l,n]=g.useState(""),{data:p=[]}=Q({queryKey:["unattributed-rewards"],queryFn:yt}),{data:j}=Q({queryKey:["defi-positions",t],queryFn:()=>pt(t),enabled:!!t}),N=V({mutationFn:({rewardIds:d,positionId:A})=>rs(d,A),onSuccess:()=>{r.invalidateQueries({queryKey:["unattributed-rewards"]}),r.invalidateQueries({queryKey:["position-rewards"]}),c(new Set),n("")}}),[S,b]=g.useState(null),[k,u]=g.useState(null),[M,C]=g.useState(null),D=V({mutationFn:d=>ut(d),onSuccess:d=>{u(s("crypto.transactionCreated","Transaction created: ${{amount}}",{amount:d.amount_usd.toFixed(2)})),r.invalidateQueries({queryKey:["unattributed-rewards"]}),r.invalidateQueries({queryKey:["transactions"]}),b(null),setTimeout(()=>u(null),5e3)},onError:d=>{C(d.message||s("crypto.transactionCreateError","Failed to create transaction")),b(null),setTimeout(()=>C(null),5e3)}});if(p.length===0)return null;const R=1,h=p.filter(d=>Number(d.reward_usd||0)>=R);if(h.length===0)return null;const w=(j==null?void 0:j.positions)||[],y=d=>`${Number(d.reward_amount).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:6})} ${d.reward_token_symbol||"tokens"}`,v=d=>new Date(d).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}),_=d=>{const A=new Set(a);A.has(d)?A.delete(d):A.add(d),c(A)},q=()=>{a.size===h.length?c(new Set):c(new Set(h.map(d=>d.id)))},L=h.length>0&&a.size===h.length,m=a.size>0,x=()=>{a.size===0||!l||N.mutate({rewardIds:Array.from(a),positionId:l})};return e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(ms,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-500"}),e.jsx("h3",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:s("crypto.unattributedRewards",{count:h.length})})]}),e.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mb-4",children:s("crypto.unattributedRewardsDesc","These rewards need to be assigned to a position for ROI tracking.")}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3 mb-4 p-3 bg-white dark:bg-gray-800 rounded-lg border border-yellow-100 dark:border-gray-700",children:[e.jsxs("button",{type:"button",onClick:q,className:"flex items-center gap-2 px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:[L?e.jsx(Ye,{className:"h-4 w-4 text-primary-600"}):e.jsx(Ge,{className:"h-4 w-4"}),L?s("deselectAll","Deselect All"):s("selectAll","Select All")]}),e.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsxs("select",{value:l,onChange:d=>n(d.target.value),disabled:!m,className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-sm text-gray-900 dark:text-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"",children:s("crypto.selectPosition","Select position...")}),w.map(d=>e.jsxs("option",{value:d.id,children:[d.protocol," - ",d.symbol]},d.id))]}),e.jsxs("button",{type:"button",onClick:x,disabled:!m||!l||N.isPending,className:"flex items-center justify-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 disabled:bg-gray-400 text-white text-sm font-medium rounded-md transition-colors disabled:cursor-not-allowed",children:[e.jsx(Ot,{className:"h-4 w-4"}),N.isPending?s("assigning","Assigning..."):s("crypto.assignSelected","Assign {{count}} Selected",{count:a.size})]})]})]}),k&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg text-sm text-green-700 dark:text-green-300",children:[e.jsx(ye,{className:"h-4 w-4"}),k]}),M&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg text-sm text-red-700 dark:text-red-300",children:[e.jsx(oe,{className:"h-4 w-4"}),M]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:h.map(d=>e.jsxs("div",{onClick:()=>_(d.id),className:`flex items-center gap-3 p-3 rounded-md border cursor-pointer transition-colors ${a.has(d.id)?"bg-primary-50 dark:bg-primary-900/20 border-primary-300 dark:border-primary-700":"bg-white dark:bg-gray-800 border-yellow-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-750"}`,children:[e.jsx("div",{className:"flex-shrink-0",children:a.has(d.id)?e.jsx(Ye,{className:"h-5 w-5 text-primary-600"}):e.jsx(Ge,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:y(d)}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[v(d.claimed_at)," via ",d.source,d.reward_usd&&e.jsxs("span",{className:"ml-2 text-green-600 dark:text-green-400",children:["â‰ˆ $",Number(d.reward_usd).toFixed(2)]})]})]}),d.reward_usd&&d.reward_usd>0&&e.jsx("div",{className:"flex-shrink-0",onClick:A=>A.stopPropagation(),children:d.transaction_id?e.jsxs("a",{href:`/transactions?id=${d.transaction_id}`,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-green-700 dark:text-green-300 bg-green-100 dark:bg-green-900/30 rounded hover:bg-green-200 dark:hover:bg-green-900/50 transition-colors",children:[e.jsx(Ke,{className:"h-3 w-3"}),s("crypto.viewTransaction","View Txn")]}):e.jsxs("button",{type:"button",onClick:()=>{b(d.id),D.mutate(d.id)},disabled:S===d.id,className:"flex items-center gap-1 px-2 py-1 text-xs font-medium text-primary-700 dark:text-primary-300 bg-primary-100 dark:bg-primary-900/30 rounded hover:bg-primary-200 dark:hover:bg-primary-900/50 disabled:opacity-50 transition-colors",children:[S===d.id?e.jsx(Ne,{className:"h-3 w-3 animate-spin"}):e.jsx(Ee,{className:"h-3 w-3"}),s("crypto.createTransaction","Create Txn")]})})]},d.id))}),m&&e.jsx("div",{className:"mt-3 pt-3 border-t border-yellow-200 dark:border-gray-700 text-sm text-yellow-700 dark:text-yellow-300",children:s("crypto.selectedRewards","{{count}} reward(s) selected",{count:a.size})})]})}const Is={deposit:"ðŸ’°",stake:"ðŸ”’",borrow:"ðŸ’¸",reward:"ðŸŽ",liquidity:"ðŸ’§"},Bs={liquidity_pool:"LP",staking:"Staking",lending:"Lending",farming:"Farming",vault:"Vault"};function zs(t){const s={};for(const r of t){const a=`${r.protocol}-${r.chain_id}-${r.name||r.token_name}-${r.position_type}`;s[a]||(s[a]={key:a,name:r.name||r.token_name,protocol:r.protocol,protocol_module:r.protocol_module,position_type:r.position_type,chain_id:r.chain_id,tokens:[],total_usd:0}),s[a].tokens.push(r),s[a].total_usd+=Number(r.balance_usd)}return Object.values(s)}function Qs({group:t,onClick:s,isPrivacyMode:r}){const a=t.chain_id,c=we[a],l=t.tokens[0],n=r?t.tokens.map(p=>`*** ${p.symbol}`).join(" + "):t.tokens.map(p=>{const j=Number(p.balance);return`${j<1e-4?"<0.0001":j<1?j.toFixed(4):j.toFixed(2)} ${p.symbol}`}).join(" + ");return e.jsxs("button",{onClick:()=>s(t),className:"w-full flex items-center justify-between py-3 px-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors text-left group",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"relative flex-shrink-0",children:t.tokens.length>1?e.jsxs("div",{className:"flex -space-x-2",children:[t.tokens.slice(0,3).map((p,j)=>p.logo_url?e.jsx("img",{src:p.logo_url,alt:p.symbol,className:"w-7 h-7 rounded-full border-2 border-white dark:border-gray-800",style:{zIndex:t.tokens.length-j},onError:N=>{N.target.style.display="none"}},p.id):e.jsx("div",{className:"w-7 h-7 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-xs font-bold border-2 border-white dark:border-gray-800",style:{zIndex:t.tokens.length-j},children:p.symbol.slice(0,2)},p.id)),t.tokens.length>3&&e.jsxs("div",{className:"w-7 h-7 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center text-xs font-medium border-2 border-white dark:border-gray-800",children:["+",t.tokens.length-3]})]}):l.logo_url?e.jsx("img",{src:l.logo_url,alt:l.symbol,className:"w-8 h-8 rounded-full",onError:p=>{p.target.style.display="none"}}):e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white text-sm font-bold",children:Is[t.position_type]||"ðŸ“ˆ"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white truncate",children:t.protocol}),e.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 rounded",children:Bs[t.protocol_module]||t.protocol_module})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx("span",{className:"truncate",children:t.name}),c&&e.jsxs("span",{className:"text-xs px-1 py-0.5 bg-gray-200 dark:bg-gray-700 rounded",children:[c.icon," ",a.toUpperCase()]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:r?"$***":`$${t.total_usd.toFixed(2)}`}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 max-w-[180px] truncate",children:n})]}),e.jsx(ot,{className:"w-4 h-4 text-gray-400 group-hover:text-indigo-500 transition-colors"})]})]})}function st(){const{t}=X("common"),{currency:s}=it(),{isPrivacyMode:r}=_e(),[a,c]=g.useState(null),l=Ce(),{data:n,isLoading:p}=Q({queryKey:["crypto-wallets"],queryFn:xt}),{data:j=[]}=Q({queryKey:["unattributed-rewards"],queryFn:yt}),{data:N,isLoading:S,refetch:b}=Q({queryKey:["crypto-defi-positions",n==null?void 0:n.map(y=>y.id)],queryFn:async()=>!n||n.length===0?[]:await Promise.all(n.map(v=>pt(v.id).catch(()=>({wallet_address:v.wallet_address,total_value_usd:0,positions:[],last_sync_at:null})))),enabled:!!n&&n.length>0}),k=(N==null?void 0:N.flatMap(y=>y.positions))||[],u=zs(k),M=(N==null?void 0:N.reduce((y,v)=>y+Number(v.total_value_usd||0),0))||0,C=1/((l==null?void 0:l.USD)||.00667),D=Math.round(M*C),R=u.reduce((y,v)=>{const _=v.protocol;return y[_]||(y[_]=[]),y[_].push(v),y},{});if(p||S)return e.jsx(ke,{title:t("crypto.defiPositions"),badge:0,children:e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(ge,{size:"md"})})});if(!n||n.length===0)return null;const w=j.length>0?`${u.length} Â· ${j.length} âš `:u.length;return e.jsxs(ke,{title:t("crypto.defiPositions"),badge:w,defaultOpen:u.length>0,children:[k.length>0&&e.jsx("div",{className:"mb-4 p-4 bg-gradient-to-r from-indigo-500/10 to-purple-500/10 dark:from-indigo-900/20 dark:to-purple-900/20 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("crypto.totalDefiValue")}),e.jsx("p",{className:"text-2xl font-bold text-indigo-600 dark:text-indigo-400",children:te(D,s,l,!1,r)})]}),e.jsx("button",{onClick:()=>b(),className:"p-2 text-gray-500 hover:text-indigo-600 hover:bg-indigo-50 dark:hover:bg-indigo-900/30 rounded-lg transition-colors",title:t("crypto.refresh"),children:e.jsx(se,{className:"w-5 h-5"})})]})}),n[0]&&e.jsx("div",{className:"mb-4",children:e.jsx(Os,{walletId:n[0].id})}),u.length>0?e.jsx("div",{className:"space-y-4",children:Object.entries(R).sort(([,y],[,v])=>{const _=y.reduce((L,m)=>L+m.total_usd,0);return v.reduce((L,m)=>L+m.total_usd,0)-_}).map(([y,v])=>e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-2 bg-gray-100 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-600",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:y}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:r?"$***":`$${v.reduce((_,q)=>_+q.total_usd,0).toFixed(2)}`})]})}),e.jsx("div",{className:"divide-y divide-gray-100 dark:divide-gray-700/50",children:v.sort((_,q)=>q.total_usd-_.total_usd).map(_=>e.jsx(Qs,{group:_,onClick:c,isPrivacyMode:r},_.key))})]},y))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(_s,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t("crypto.noDefiPositions")}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:t("crypto.noDefiPositionsDescription")})]}),a&&e.jsx($s,{group:a,onClose:()=>c(null)})]})}function rt(){const{t}=X("common"),[s,r]=g.useState(!1),{data:a,isLoading:c}=Q({queryKey:["closed-positions"],queryFn:Es});return c||!a||a.total_closed===0?null:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700",children:[e.jsxs("button",{onClick:()=>r(!s),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ys,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:t("crypto.closedPositions","Closed Positions")}),e.jsxs("p",{className:"text-sm text-gray-500",children:[a.total_closed," ",t("crypto.positions","positions")]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[a.total_realized_pnl_jpy!==null&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:t("crypto.totalPnl","Total P&L")}),e.jsxs("p",{className:`font-medium ${a.total_realized_pnl_jpy>=0?"text-green-600":"text-red-600"}`,children:[a.total_realized_pnl_jpy>=0?"+":"",je(a.total_realized_pnl_jpy,"JPY")]})]}),s?e.jsx(bt,{className:"w-5 h-5 text-gray-500"}):e.jsx(Me,{className:"w-5 h-5 text-gray-500"})]})]}),s&&e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 space-y-3",children:a.positions.map(l=>{const n=we[l.chain_id],p=l.realized_pnl_jpy!==null&&l.realized_pnl_jpy>=0;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900 dark:text-white",children:[l.protocol," - ",l.symbol]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[n&&e.jsx("span",{children:n.icon}),e.jsx("span",{children:new Date(l.exit_date).toLocaleDateString()})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:je(l.exit_value_jpy,"JPY")}),l.realized_pnl_jpy!==null&&e.jsxs("div",{className:`flex items-center justify-end gap-1 text-sm ${p?"text-green-600":"text-red-600"}`,children:[p?e.jsx(Fe,{className:"w-3 h-3"}):e.jsx(It,{className:"w-3 h-3"}),p?"+":"",je(l.realized_pnl_jpy,"JPY"),l.realized_pnl_pct!==null&&e.jsxs("span",{className:"text-xs",children:["(",l.realized_pnl_pct.toFixed(1),"%)"]})]})]})]},l.id)})})]})}async function Ks(t){return(await Re.post("/api/transfers/",t)).data}async function Hs(t){return(await Re.post("/api/transfers/exchange",t)).data}const xe={JPY:"Â¥",USD:"$",VND:"â‚«"};function me(t){const s=t.replace(/[^\d]/g,"");return s?parseInt(s).toLocaleString("en-US"):""}function W(t){return parseInt(t.replace(/[,.\s]/g,""),10)||0}function Us({isOpen:t,onClose:s}){const{t:r}=X("common"),a=re(),{data:c}=ct(),l=Ce(),[n,p]=g.useState(null),[j,N]=g.useState(null),[S,b]=g.useState(""),[k,u]=g.useState(""),[M,C]=g.useState(""),[D,R]=g.useState(new Date().toISOString().split("T")[0]),[h,w]=g.useState(""),[y,v]=g.useState({}),[_,q]=g.useState(!1),[L,m]=g.useState(null),x=g.useMemo(()=>c==null?void 0:c.find(o=>o.id===n),[c,n]),d=g.useMemo(()=>c==null?void 0:c.find(o=>o.id===j),[c,j]),A=g.useMemo(()=>(c==null?void 0:c.filter(o=>o.id!==n))||[],[c,n]),{data:I}=Q({queryKey:["transactions","income",x==null?void 0:x.currency],queryFn:()=>zt({type:"income"}),enabled:_&&!!x,select:o=>o.filter(K=>K.currency===(x==null?void 0:x.currency))});g.useEffect(()=>{if(!x||!d||!S||!l)return;const o=W(S);if(o<=0)return;if(x.currency===d.currency){u(me(o.toString()));return}const K=l[x.currency]||1,T=l[d.currency]||1,B=o/K,Ae=Math.round(B*T);u(me(Ae.toString()))},[x,d,S,l]),g.useEffect(()=>{var o;t&&(p(((o=c==null?void 0:c[0])==null?void 0:o.id)||null),N(null),b(""),u(""),C(""),R(new Date().toISOString().split("T")[0]),w(""),v({}),q(!1),m(null))},[t,c]);const E=V({mutationFn:Ks,onSuccess:()=>{a.invalidateQueries({queryKey:["accounts"]}),a.invalidateQueries({queryKey:["transactions"]}),a.invalidateQueries({queryKey:["transfers"]}),a.invalidateQueries({queryKey:["analytics"]}),s()}}),i=V({mutationFn:Hs,onSuccess:()=>{a.invalidateQueries({queryKey:["accounts"]}),a.invalidateQueries({queryKey:["transactions"]}),a.invalidateQueries({queryKey:["transfers"]}),a.invalidateQueries({queryKey:["analytics"]}),s()}}),F=_?i:E,Z=()=>{const o={};return n||(o.fromAccount=r("transfer.errors.fromRequired")),j||(o.toAccount=r("transfer.errors.toRequired")),n&&j&&n===j&&(o.toAccount=r("transfer.errors.sameAccount")),(!S||W(S)<=0)&&(o.fromAmount=r("transfer.errors.amountRequired")),(!k||W(k)<=0)&&(o.toAmount=r("transfer.errors.amountRequired")),v(o),Object.keys(o).length===0},P=o=>{if(o.preventDefault(),!Z())return;const K=(x==null?void 0:x.currency)||"JPY",T=(d==null?void 0:d.currency)||"JPY";if(_){const B={date:D,from_account_id:n,from_amount:de(W(S),K),to_account_id:j,to_amount:de(W(k),T),link_to_transaction_id:L||void 0,notes:h.trim()||void 0};i.mutate(B)}else{const B={from_account_id:n,to_account_id:j,from_amount:de(W(S),K),to_amount:de(W(k),T),fee_amount:de(W(M)||0,K),date:D,description:h.trim()||void 0};x&&d&&x.currency!==d.currency&&(B.exchange_rate=W(k)/W(S)),E.mutate(B)}};if(!t)return null;const f=e.jsxs("div",{className:"fixed inset-0 z-[100001] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 animate-modal-backdrop",onClick:s}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto overflow-x-hidden",style:{touchAction:"pan-y"},onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 dark:border-gray-700 px-6 py-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:_?r("transfer.exchangeTitle","Currency Exchange"):r("transfer.title")}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full",children:e.jsx(oe,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:P,className:"p-6 space-y-5",children:[e.jsx("div",{className:"flex items-center gap-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:o=>q(o.target.checked),className:"w-4 h-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx(se,{className:"w-4 h-4"}),r("transfer.exchangeMode","Currency Exchange")]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("transfer.fromAccount")}),e.jsxs("select",{value:n||"",onChange:o=>p(o.target.value?parseInt(o.target.value):null),className:O("w-full h-12 px-4 border rounded-lg","bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100",y.fromAccount?"border-red-500":"border-gray-300"),children:[e.jsx("option",{value:"",children:r("transfer.selectAccount")}),c==null?void 0:c.map(o=>e.jsxs("option",{value:o.id,children:[o.name," (",xe[o.currency]||o.currency,")"]},o.id))]}),y.fromAccount&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:y.fromAccount})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(Bt,{className:"w-6 h-6 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("transfer.toAccount")}),e.jsxs("select",{value:j||"",onChange:o=>N(o.target.value?parseInt(o.target.value):null),className:O("w-full h-12 px-4 border rounded-lg","bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100",y.toAccount?"border-red-500":"border-gray-300"),children:[e.jsx("option",{value:"",children:r("transfer.selectAccount")}),A.map(o=>e.jsxs("option",{value:o.id,children:[o.name," (",xe[o.currency]||o.currency,")"]},o.id))]}),y.toAccount&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:y.toAccount})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("transfer.amount")}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500",children:x?xe[x.currency]||x.currency:"Â¥"}),e.jsx("input",{type:"text",inputMode:"numeric",value:S,onChange:o=>b(me(o.target.value)),className:O("w-full h-12 pl-10 pr-4 border rounded-lg text-right","dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100",y.fromAmount?"border-red-500":"border-gray-300"),placeholder:"0"})]}),y.fromAmount&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:y.fromAmount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("transfer.convertedAmount")}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500",children:d?xe[d.currency]||d.currency:"Â¥"}),e.jsx("input",{type:"text",inputMode:"numeric",value:k,onChange:o=>u(me(o.target.value)),className:O("w-full h-12 pl-10 pr-4 border rounded-lg text-right","dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100",y.toAmount?"border-red-500":"border-gray-300"),placeholder:"0"})]}),y.toAmount&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:y.toAmount})]})]}),x&&d&&x.currency!==d.currency&&S&&k&&e.jsxs("p",{className:"text-sm text-gray-500 text-center",children:["1 ",x.currency," â‰ˆ ",(W(k)/W(S)).toFixed(4)," ",d.currency]}),_&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("transfer.linkToIncome","Link to Income")," (",r("optional"),")"]}),e.jsxs("select",{value:L||"",onChange:o=>m(o.target.value?parseInt(o.target.value):null),className:"w-full h-12 px-4 border border-gray-300 rounded-lg bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100",children:[e.jsx("option",{value:"",children:r("transfer.noLink","None")}),I==null?void 0:I.map(o=>e.jsxs("option",{value:o.id,children:[o.date," - ",o.description," (",je(o.amount,o.currency),")"]},o.id))]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:r("transfer.linkToIncomeHelp","Link this exchange to an income transaction for tracking")})]}),!_&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("transfer.fee")," (",r("optional"),")"]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500",children:x?xe[x.currency]||x.currency:"Â¥"}),e.jsx("input",{type:"text",inputMode:"numeric",value:M,onChange:o=>C(me(o.target.value)),className:"w-full h-12 pl-10 pr-4 border border-gray-300 rounded-lg text-right dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100",placeholder:"0"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r("transfer.date")}),e.jsx("input",{type:"date",value:D,onChange:o=>R(o.target.value),className:"w-full h-12 px-4 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r("transfer.description")," (",r("optional"),")"]}),e.jsx("input",{type:"text",value:h,onChange:o=>w(o.target.value),className:"w-full h-12 px-4 border border-gray-300 rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100",placeholder:r("transfer.descriptionPlaceholder")})]}),F.isError&&e.jsx("p",{className:"text-sm text-red-500 text-center",children:r("transfer.error")}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx(he,{type:"button",variant:"outline",onClick:s,className:"flex-1 h-12",children:r("cancel")}),e.jsx(he,{type:"submit",loading:F.isPending,className:"flex-1 h-12 bg-blue-600 hover:bg-blue-700",children:r("transfer.create")})]})]})]})]});return typeof document>"u"?null:Se.createPortal(f,document.body)}const ft="accounts_collapsed_sections";function Vs(){try{const t=localStorage.getItem(ft);if(t)return new Set(JSON.parse(t))}catch{}return new Set}function Ws(t){localStorage.setItem(ft,JSON.stringify([...t]))}function Js(){const{t}=X("common"),[s,r]=g.useState(!1),[a,c]=g.useState(!1),[l,n]=g.useState(!1),[p,j]=g.useState(!1),[N,S]=g.useState(!1),[b,k]=g.useState(null),[u,M]=g.useState(null),[C,D]=g.useState(()=>Vs());g.useEffect(()=>{Ws(C)},[C]),g.useEffect(()=>{const x=()=>{j(!0)},d=()=>{S(!0)};return window.addEventListener("open-add-transaction-modal",x),window.addEventListener("open-receipt-scanner",d),()=>{window.removeEventListener("open-add-transaction-modal",x),window.removeEventListener("open-receipt-scanner",d)}},[]);const R=g.useCallback(x=>{D(d=>{const A=new Set(d);return A.has(x)?A.delete(x):A.add(x),A})},[]),{data:h,isLoading:w,error:y}=ct(s),v=()=>{k(null),c(!0)},_=x=>{k(x),c(!0)},q=()=>{c(!1),k(null)},L=h==null?void 0:h.reduce((x,d)=>{const A=d.type;return x[A]||(x[A]=[]),x[A].push(d),x},{}),m=["bank","savings","cash","credit_card","investment","crypto","receivable","other"];return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:t("account.accounts")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:t("account.manageYourAccounts")})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(js,{className:"w-5 h-5"}),t("transfer.title")]}),e.jsxs("button",{onClick:v,className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),t("account.createAccount")]})]})]}),e.jsx("div",{className:"mt-4 flex items-center gap-4",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:x=>r(x.target.checked),className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 dark:bg-gray-700"}),t("account.showInactive")]})})]}),w&&e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}),y&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-6",children:e.jsxs("p",{className:"text-red-700 dark:text-red-400",children:[t("account.errors.loadFailed"),": ",y.message]})}),!w&&!y&&(!h||h.length===0)&&e.jsx(Qt,{icon:e.jsx(ve,{}),title:t("emptyState.accounts.title","No accounts added yet"),description:t("emptyState.accounts.description","Add your bank accounts, credit cards, or cash to track balances"),action:e.jsx("button",{onClick:v,className:"inline-flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:t("emptyState.accounts.cta","Add Account")})}),!w&&!y&&h&&h.length>0&&e.jsxs("div",{className:"space-y-8",children:[m.map(x=>{const d=L==null?void 0:L[x];if(!d||d.length===0)return null;const A=C.has(x);return e.jsxs("div",{children:[e.jsxs("button",{type:"button",onClick:()=>R(x),className:"w-full flex items-center justify-between mb-4 group cursor-pointer",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[t(`account.type.${x}`),e.jsxs("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:["(",d.length,")"]})]}),e.jsx(Me,{className:`w-5 h-5 text-gray-500 dark:text-gray-400 transition-transform duration-200 ${A?"-rotate-90":""}`})]}),e.jsx("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 transition-all duration-200 ease-in-out ${A?"max-h-0 opacity-0 overflow-hidden":"max-h-[2000px] opacity-100"}`,children:d.map((I,E)=>e.jsx("div",{className:"animate-stagger-in",style:{"--stagger-index":Math.min(E,9)},children:e.jsx(Rs,{account:I,onEdit:_,onAddTransaction:i=>{M(i),j(!0)}})},I.id))})]},x)}),e.jsx(tt,{}),e.jsx(st,{}),e.jsx(rt,{})]}),!w&&!y&&(!h||h.length===0)&&e.jsxs("div",{className:"mt-8 space-y-6",children:[e.jsx(tt,{}),e.jsx(st,{}),e.jsx(rt,{})]}),e.jsx(Ms,{isOpen:a,onClose:q,editingAccountId:b}),e.jsx(Us,{isOpen:l,onClose:()=>n(!1)}),e.jsx(Ht,{isOpen:p,onClose:()=>{j(!1),M(null)},defaultAccountId:u}),e.jsx(Ut,{isOpen:N,onClose:()=>S(!1),onScanComplete:()=>S(!1)})]})}const mr=Kt("/accounts")({component:Js});export{mr as Route};

import{k as Ar,ag as T,ah as He,r as C,Z as Bt,N as $t,u as Y,aU as je,j as a,aL as H,l as z,av as Er,aw as kr,M as Pr,a7 as cn,z as ue,C as it,E as pe,aV as Bn,H as $n,J as Or,a2 as ln,B as nt,x as Tr,aW as un,aX as de,aY as gt,aZ as Nr,$ as Cr,a_ as se,a$ as Ir,aH as Dr,i as Mr}from"./index-BadmHgZg.js";import{f as ft,L as st,B as ie,n as Tt,C as fe,A as Fn,l as rt,h as yt,E as Lr,m as Le,F as Br,o as Xt,G as zn,j as Nt,H as me,i as ge,D as $r,u as Kn,S as dn,I as Fr,d as zr,r as Rn,J as Kr,K as Rr,s as qt,x as Vn,M as Ct,N as Hn,R as we,O as Se,P as Yn,Q as Vr}from"./generateCategoricalChart-COiIpkhd.js";import{X as Ft,Y as zt,L as Ye,C as Un,a as Hr}from"./LineChart-w15Veo1y.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=[["path",{d:"M5 12h14",key:"1ays0h"}]],Ur=Ar("minus",Yr);var Wr=["layout","type","stroke","connectNulls","isRange","ref"],Gr=["key"],Wn;function It(e){"@babel/helpers - typeof";return It=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(e)}function Gn(e,t){if(e==null)return{};var n=Xr(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Xr(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function _t(){return _t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_t.apply(this,arguments)}function fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function mt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fn(Object(n),!0).forEach(function(r){ot(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fn(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function qr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,qn(r.key),r)}}function Jr(e,t,n){return t&&hn(e.prototype,t),n&&hn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Qr(e,t,n){return t=ye(t),Zr(e,Xn()?Reflect.construct(t,n||[],ye(e).constructor):t.apply(e,n))}function Zr(e,t){if(t&&(It(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ts(e)}function ts(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Xn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xn=function(){return!!e})()}function ye(e){return ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ye(e)}function es(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Be(e,t)}function Be(e,t){return Be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Be(e,t)}function ot(e,t,n){return t=qn(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qn(e){var t=ns(e,"string");return It(t)=="symbol"?t:t+""}function ns(e,t){if(It(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(It(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wt=function(e){function t(){var n;qr(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=Qr(this,t,[].concat(s)),ot(n,"state",{isAnimationFinished:!0}),ot(n,"id",Kn("recharts-area-")),ot(n,"handleAnimationEnd",function(){var o=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),ge(o)&&o()}),ot(n,"handleAnimationStart",function(){var o=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),ge(o)&&o()}),n}return es(t,e),Jr(t,[{key:"renderDots",value:function(r,s,i){var o=this.props.isAnimationActive,c=this.state.isAnimationFinished;if(o&&!c)return null;var u=this.props,l=u.dot,d=u.points,f=u.dataKey,h=ft(this.props,!1),m=ft(l,!0),p=d.map(function(v,g){var x=mt(mt(mt({key:"dot-".concat(g),r:3},h),m),{},{index:g,cx:v.x,cy:v.y,dataKey:f,value:v.value,payload:v.payload,points:d});return t.renderDotItem(l,x)}),y={clipPath:r?"url(#clipPath-".concat(s?"":"dots-").concat(i,")"):null};return T.createElement(st,_t({className:"recharts-area-dots"},y),p)}},{key:"renderHorizontalRect",value:function(r){var s=this.props,i=s.baseLine,o=s.points,c=s.strokeWidth,u=o[0].x,l=o[o.length-1].x,d=r*Math.abs(u-l),f=ie(o.map(function(h){return h.y||0}));return Tt(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(ie(i.map(function(h){return h.y||0})),f)),Tt(f)?T.createElement("rect",{x:u<l?u:u-d,y:0,width:d,height:Math.floor(f+(c?parseInt("".concat(c),10):1))}):null}},{key:"renderVerticalRect",value:function(r){var s=this.props,i=s.baseLine,o=s.points,c=s.strokeWidth,u=o[0].y,l=o[o.length-1].y,d=r*Math.abs(u-l),f=ie(o.map(function(h){return h.x||0}));return Tt(i)&&typeof i=="number"?f=Math.max(i,f):i&&Array.isArray(i)&&i.length&&(f=Math.max(ie(i.map(function(h){return h.x||0})),f)),Tt(f)?T.createElement("rect",{x:0,y:u<l?u:u-d,width:f+(c?parseInt("".concat(c),10):1),height:Math.floor(d)}):null}},{key:"renderClipRect",value:function(r){var s=this.props.layout;return s==="vertical"?this.renderVerticalRect(r):this.renderHorizontalRect(r)}},{key:"renderAreaStatically",value:function(r,s,i,o){var c=this.props,u=c.layout,l=c.type,d=c.stroke,f=c.connectNulls,h=c.isRange;c.ref;var m=Gn(c,Wr);return T.createElement(st,{clipPath:i?"url(#clipPath-".concat(o,")"):null},T.createElement(fe,_t({},ft(m,!0),{points:r,connectNulls:f,type:l,baseLine:s,layout:u,stroke:"none",className:"recharts-area-area"})),d!=="none"&&T.createElement(fe,_t({},ft(this.props,!1),{className:"recharts-area-curve",layout:u,type:l,connectNulls:f,fill:"none",points:r})),d!=="none"&&h&&T.createElement(fe,_t({},ft(this.props,!1),{className:"recharts-area-curve",layout:u,type:l,connectNulls:f,fill:"none",points:s})))}},{key:"renderAreaWithAnimation",value:function(r,s){var i=this,o=this.props,c=o.points,u=o.baseLine,l=o.isAnimationActive,d=o.animationBegin,f=o.animationDuration,h=o.animationEasing,m=o.animationId,p=this.state,y=p.prevPoints,v=p.prevBaseLine;return T.createElement(Fn,{begin:d,duration:f,isActive:l,easing:h,from:{t:0},to:{t:1},key:"area-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(g){var x=g.t;if(y){var b=y.length/c.length,j=c.map(function(A,k){var P=Math.floor(k*b);if(y[P]){var O=y[P],N=rt(O.x,A.x),K=rt(O.y,A.y);return mt(mt({},A),{},{x:N(x),y:K(x)})}return A}),S;if(Tt(u)&&typeof u=="number"){var w=rt(v,u);S=w(x)}else if(yt(u)||Lr(u)){var _=rt(v,0);S=_(x)}else S=u.map(function(A,k){var P=Math.floor(k*b);if(v[P]){var O=v[P],N=rt(O.x,A.x),K=rt(O.y,A.y);return mt(mt({},A),{},{x:N(x),y:K(x)})}return A});return i.renderAreaStatically(j,S,r,s)}return T.createElement(st,null,T.createElement("defs",null,T.createElement("clipPath",{id:"animationClipPath-".concat(s)},i.renderClipRect(x))),T.createElement(st,{clipPath:"url(#animationClipPath-".concat(s,")")},i.renderAreaStatically(c,u,r,s)))})}},{key:"renderArea",value:function(r,s){var i=this.props,o=i.points,c=i.baseLine,u=i.isAnimationActive,l=this.state,d=l.prevPoints,f=l.prevBaseLine,h=l.totalLength;return u&&o&&o.length&&(!d&&h>0||!Le(d,o)||!Le(f,c))?this.renderAreaWithAnimation(r,s):this.renderAreaStatically(o,c,r,s)}},{key:"render",value:function(){var r,s=this.props,i=s.hide,o=s.dot,c=s.points,u=s.className,l=s.top,d=s.left,f=s.xAxis,h=s.yAxis,m=s.width,p=s.height,y=s.isAnimationActive,v=s.id;if(i||!c||!c.length)return null;var g=this.state.isAnimationFinished,x=c.length===1,b=He("recharts-area",u),j=f&&f.allowDataOverflow,S=h&&h.allowDataOverflow,w=j||S,_=yt(v)?this.id:v,A=(r=ft(o,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},k=A.r,P=k===void 0?3:k,O=A.strokeWidth,N=O===void 0?2:O,K=Br(o)?o:{},U=K.clipDot,W=U===void 0?!0:U,X=P*2+N;return T.createElement(st,{className:b},j||S?T.createElement("defs",null,T.createElement("clipPath",{id:"clipPath-".concat(_)},T.createElement("rect",{x:j?d:d-m/2,y:S?l:l-p/2,width:j?m:m*2,height:S?p:p*2})),!W&&T.createElement("clipPath",{id:"clipPath-dots-".concat(_)},T.createElement("rect",{x:d-X/2,y:l-X/2,width:m+X,height:p+X}))):null,x?null:this.renderArea(w,_),(o||x)&&this.renderDots(w,W,_),(!y||g)&&Xt.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(r,s){return r.animationId!==s.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,curBaseLine:r.baseLine,prevPoints:s.curPoints,prevBaseLine:s.curBaseLine}:r.points!==s.curPoints||r.baseLine!==s.curBaseLine?{curPoints:r.points,curBaseLine:r.baseLine}:null}}])}(C.PureComponent);Wn=wt;ot(wt,"displayName","Area");ot(wt,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!zn.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});ot(wt,"getBaseValue",function(e,t,n,r){var s=e.layout,i=e.baseValue,o=t.props.baseValue,c=o??i;if(Tt(c)&&typeof c=="number")return c;var u=s==="horizontal"?r:n,l=u.scale.domain();if(u.type==="number"){var d=Math.max(l[0],l[1]),f=Math.min(l[0],l[1]);return c==="dataMin"?f:c==="dataMax"||d<0?d:Math.max(Math.min(l[0],l[1]),0)}return c==="dataMin"?l[0]:c==="dataMax"?l[1]:l[0]});ot(wt,"getComposedData",function(e){var t=e.props,n=e.item,r=e.xAxis,s=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,c=e.bandSize,u=e.dataKey,l=e.stackedData,d=e.dataStartIndex,f=e.displayedData,h=e.offset,m=t.layout,p=l&&l.length,y=Wn.getBaseValue(t,n,r,s),v=m==="horizontal",g=!1,x=f.map(function(j,S){var w;p?w=l[d+S]:(w=Nt(j,u),Array.isArray(w)?g=!0:w=[y,w]);var _=w[1]==null||p&&Nt(j,u)==null;return v?{x:me({axis:r,ticks:i,bandSize:c,entry:j,index:S}),y:_?null:s.scale(w[1]),value:w,payload:j}:{x:_?null:r.scale(w[1]),y:me({axis:s,ticks:o,bandSize:c,entry:j,index:S}),value:w,payload:j}}),b;return p||g?b=x.map(function(j){var S=Array.isArray(j.value)?j.value[0]:null;return v?{x:j.x,y:S!=null&&j.y!=null?s.scale(S):null}:{x:S!=null?r.scale(S):null,y:j.y}}):b=v?s.scale(y):r.scale(y),mt({points:x,baseLine:b,layout:m,isRange:g},h)});ot(wt,"renderDotItem",function(e,t){var n;if(T.isValidElement(e))n=T.cloneElement(e,t);else if(ge(e))n=e(t);else{var r=He("recharts-area-dot",typeof e!="boolean"?e.className:""),s=t.key,i=Gn(t,Gr);n=T.createElement($r,_t({},i,{key:s,className:r}))}return n});function Dt(e){"@babel/helpers - typeof";return Dt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(e)}function rs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ss(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Zn(r.key),r)}}function is(e,t,n){return t&&ss(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function os(e,t,n){return t=xe(t),as(e,Jn()?Reflect.construct(t,n||[],xe(e).constructor):t.apply(e,n))}function as(e,t){if(t&&(Dt(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cs(e)}function cs(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Jn=function(){return!!e})()}function xe(e){return xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},xe(e)}function ls(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$e(e,t)}function $e(e,t){return $e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},$e(e,t)}function Qn(e,t,n){return t=Zn(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zn(e){var t=us(e,"string");return Dt(t)=="symbol"?t:t+""}function us(e,t){if(Dt(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Dt(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ae=function(e){function t(){return rs(this,t),os(this,t,arguments)}return ls(t,e),is(t,[{key:"render",value:function(){return null}}])}(C.Component);Qn(Ae,"displayName","ZAxis");Qn(Ae,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var ds=["option","isActive"];function Ut(){return Ut=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ut.apply(this,arguments)}function fs(e,t){if(e==null)return{};var n=hs(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function hs(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function ps(e){var t=e.option,n=e.isActive,r=fs(e,ds);return typeof t=="string"?C.createElement(dn,Ut({option:C.createElement(Fr,Ut({type:t},r)),isActive:n,shapeType:"symbols"},r)):C.createElement(dn,Ut({option:t,isActive:n,shapeType:"symbols"},r))}function Mt(e){"@babel/helpers - typeof";return Mt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(e)}function Wt(){return Wt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Wt.apply(this,arguments)}function pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pn(Object(n),!0).forEach(function(r){xt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pn(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ms(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,er(r.key),r)}}function gs(e,t,n){return t&&mn(e.prototype,t),n&&mn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ys(e,t,n){return t=ve(t),xs(e,tr()?Reflect.construct(t,n||[],ve(e).constructor):t.apply(e,n))}function xs(e,t){if(t&&(Mt(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vs(e)}function vs(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function tr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(tr=function(){return!!e})()}function ve(e){return ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ve(e)}function bs(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fe(e,t)}function Fe(e,t){return Fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Fe(e,t)}function xt(e,t,n){return t=er(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function er(e){var t=_s(e,"string");return Mt(t)=="symbol"?t:t+""}function _s(e,t){if(Mt(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Mt(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ee=function(e){function t(){var n;ms(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=ys(this,t,[].concat(s)),xt(n,"state",{isAnimationFinished:!1}),xt(n,"handleAnimationEnd",function(){n.setState({isAnimationFinished:!0})}),xt(n,"handleAnimationStart",function(){n.setState({isAnimationFinished:!1})}),xt(n,"id",Kn("recharts-scatter-")),n}return bs(t,e),gs(t,[{key:"renderSymbolsStatically",value:function(r){var s=this,i=this.props,o=i.shape,c=i.activeShape,u=i.activeIndex,l=ft(this.props,!1);return r.map(function(d,f){var h=u===f,m=h?c:o,p=J(J({},l),d);return T.createElement(st,Wt({className:"recharts-scatter-symbol",key:"symbol-".concat(d==null?void 0:d.cx,"-").concat(d==null?void 0:d.cy,"-").concat(d==null?void 0:d.size,"-").concat(f)},zr(s.props,d,f),{role:"img"}),T.createElement(ps,Wt({option:m,isActive:h,key:"symbol-".concat(f)},p)))})}},{key:"renderSymbolsWithAnimation",value:function(){var r=this,s=this.props,i=s.points,o=s.isAnimationActive,c=s.animationBegin,u=s.animationDuration,l=s.animationEasing,d=s.animationId,f=this.state.prevPoints;return T.createElement(Fn,{begin:c,duration:u,isActive:o,easing:l,from:{t:0},to:{t:1},key:"pie-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(h){var m=h.t,p=i.map(function(y,v){var g=f&&f[v];if(g){var x=rt(g.cx,y.cx),b=rt(g.cy,y.cy),j=rt(g.size,y.size);return J(J({},y),{},{cx:x(m),cy:b(m),size:j(m)})}var S=rt(0,y.size);return J(J({},y),{},{size:S(m)})});return T.createElement(st,null,r.renderSymbolsStatically(p))})}},{key:"renderSymbols",value:function(){var r=this.props,s=r.points,i=r.isAnimationActive,o=this.state.prevPoints;return i&&s&&s.length&&(!o||!Le(o,s))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(s)}},{key:"renderErrorBar",value:function(){var r=this.props.isAnimationActive;if(r&&!this.state.isAnimationFinished)return null;var s=this.props,i=s.points,o=s.xAxis,c=s.yAxis,u=s.children,l=Rn(u,Kr);return l?l.map(function(d,f){var h=d.props,m=h.direction,p=h.dataKey;return T.cloneElement(d,{key:"".concat(m,"-").concat(p,"-").concat(i[f]),data:i,xAxis:o,yAxis:c,layout:m==="x"?"vertical":"horizontal",dataPointFormatter:function(v,g){return{x:v.cx,y:v.cy,value:m==="x"?+v.node.x:+v.node.y,errorVal:Nt(v,g)}}})}):null}},{key:"renderLine",value:function(){var r=this.props,s=r.points,i=r.line,o=r.lineType,c=r.lineJointType,u=ft(this.props,!1),l=ft(i,!1),d,f;if(o==="joint")d=s.map(function(b){return{x:b.cx,y:b.cy}});else if(o==="fitting"){var h=Rr(s),m=h.xmin,p=h.xmax,y=h.a,v=h.b,g=function(j){return y*j+v};d=[{x:m,y:g(m)},{x:p,y:g(p)}]}var x=J(J(J({},u),{},{fill:"none",stroke:u&&u.fill},l),{},{points:d});return T.isValidElement(i)?f=T.cloneElement(i,x):ge(i)?f=i(x):f=T.createElement(fe,Wt({},x,{type:c})),T.createElement(st,{className:"recharts-scatter-line",key:"recharts-scatter-line"},f)}},{key:"render",value:function(){var r=this.props,s=r.hide,i=r.points,o=r.line,c=r.className,u=r.xAxis,l=r.yAxis,d=r.left,f=r.top,h=r.width,m=r.height,p=r.id,y=r.isAnimationActive;if(s||!i||!i.length)return null;var v=this.state.isAnimationFinished,g=He("recharts-scatter",c),x=u&&u.allowDataOverflow,b=l&&l.allowDataOverflow,j=x||b,S=yt(p)?this.id:p;return T.createElement(st,{className:g,clipPath:j?"url(#clipPath-".concat(S,")"):null},x||b?T.createElement("defs",null,T.createElement("clipPath",{id:"clipPath-".concat(S)},T.createElement("rect",{x:x?d:d-h/2,y:b?f:f-m/2,width:x?h:h*2,height:b?m:m*2}))):null,o&&this.renderLine(),this.renderErrorBar(),T.createElement(st,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!y||v)&&Xt.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(r,s){return r.animationId!==s.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,prevPoints:s.curPoints}:r.points!==s.curPoints?{curPoints:r.points}:null}}])}(C.PureComponent);xt(Ee,"displayName","Scatter");xt(Ee,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!zn.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});xt(Ee,"getComposedData",function(e){var t=e.xAxis,n=e.yAxis,r=e.zAxis,s=e.item,i=e.displayedData,o=e.xAxisTicks,c=e.yAxisTicks,u=e.offset,l=s.props.tooltipType,d=Rn(s.props.children,qt),f=yt(t.dataKey)?s.props.dataKey:t.dataKey,h=yt(n.dataKey)?s.props.dataKey:n.dataKey,m=r&&r.dataKey,p=r?r.range:Ae.defaultProps.range,y=p&&p[0],v=t.scale.bandwidth?t.scale.bandwidth():0,g=n.scale.bandwidth?n.scale.bandwidth():0,x=i.map(function(b,j){var S=Nt(b,f),w=Nt(b,h),_=!yt(m)&&Nt(b,m)||"-",A=[{name:yt(t.dataKey)?s.props.name:t.name||t.dataKey,unit:t.unit||"",value:S,payload:b,dataKey:f,type:l},{name:yt(n.dataKey)?s.props.name:n.name||n.dataKey,unit:n.unit||"",value:w,payload:b,dataKey:h,type:l}];_!=="-"&&A.push({name:r.name||r.dataKey,unit:r.unit||"",value:_,payload:b,dataKey:m,type:l});var k=me({axis:t,ticks:o,bandSize:v,entry:b,index:j,dataKey:f}),P=me({axis:n,ticks:c,bandSize:g,entry:b,index:j,dataKey:h}),O=_!=="-"?r.scale(_):y,N=Math.sqrt(Math.max(O,0)/Math.PI);return J(J({},b),{},{cx:k,cy:P,x:k-N,y:P-N,xAxis:t,yAxis:n,zAxis:r,width:2*N,height:2*N,size:O,node:{x:S,y:w,z:_},tooltipPayload:A,tooltipPosition:{x:k,y:P},payload:b},d&&d[j]&&d[j].props)});return J({points:x},u)});var nr=Vn({chartName:"BarChart",GraphicalChild:Ct,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:Ft},{axisType:"yAxis",AxisComp:zt}],formatAxisMap:Hn}),js=Vn({chartName:"ComposedChart",GraphicalChild:[Ye,wt,Ct,Ee],axisComponents:[{axisType:"xAxis",AxisComp:Ft},{axisType:"yAxis",AxisComp:zt},{axisType:"zAxis",AxisComp:Ae}],formatAxisMap:Hn});function gn(e,t){if(e===0)return"";const n=Math.abs(e);return t==="VND"?n>=1e6?`${(e/1e6).toFixed(1)}M`:n>=1e3?`${(e/1e3).toFixed(0)}K`:e.toString():t==="JPY"?n>=1e4?`${(e/1e4).toFixed(1)}万`:n>=1e3?`${(e/1e3).toFixed(0)}K`:e.toString():n>=1e6?`${(e/1e6).toFixed(1)}M`:n>=1e3?`${(e/1e3).toFixed(0)}K`:e.toString()}function ws({data:e}){const{currency:t}=Bt(),{data:n}=$t(),{t:r}=Y("common"),{resolvedTheme:s}=je(),i=s==="dark",o=i?"#45475a":"#E5E7EB",c=i?"#a6adc8":"#6B7280",u=i?"#1e1e2e":"#fff",l=i?"#45475a":"#E5E7EB",d=i?"#cdd6f4":"#374151",f=e.every(m=>m.expenses===0),h=e.map(m=>({...m,net:m.income-m.expenses}));return a.jsx(we,{width:"100%",height:"100%",children:a.jsxs(js,{data:h,margin:{top:20,right:30,left:20,bottom:5},children:[a.jsx(Un,{strokeDasharray:"3 3",stroke:o}),a.jsx(Ft,{dataKey:"month",stroke:c,style:{fontSize:"12px",fontFamily:"Noto Sans JP, sans-serif"}}),a.jsx(zt,{stroke:c,style:{fontSize:"12px",fontFamily:"Inter, sans-serif"},tickFormatter:m=>H(m,t,(n==null?void 0:n.rates)||{},!1)}),a.jsx(Se,{contentStyle:{backgroundColor:u,border:`1px solid ${l}`,borderRadius:"8px",fontSize:"14px",color:d},formatter:(m,p)=>[H(m,t,(n==null?void 0:n.rates)||{},!1),p],labelFormatter:m=>m}),a.jsx(Yn,{wrapperStyle:{fontSize:"14px",fontFamily:"Noto Sans JP, sans-serif",color:d}}),a.jsx(Ct,{dataKey:"income",fill:"#4CAF50",name:r("chart.income"),radius:[4,4,0,0],isAnimationActive:!0,animationBegin:0,animationDuration:800,animationEasing:"ease-out",children:a.jsx(Xt,{dataKey:"income",position:"top",formatter:m=>gn(m,t),style:{fontSize:"10px",fill:"#4CAF50",fontWeight:500}})}),a.jsxs(Ct,{dataKey:"expenses",fill:"#F44336",name:r("chart.expense"),radius:[4,4,0,0],isAnimationActive:!0,animationBegin:200,animationDuration:800,animationEasing:"ease-out",children:[f?h.map((m,p)=>a.jsx(qt,{fill:"#F4433633"},`cell-${p}`)):h.map((m,p)=>a.jsx(qt,{fill:m.expenses===0?"#F4433633":"#F44336"},`cell-${p}`)),a.jsx(Xt,{dataKey:"expenses",position:"top",formatter:m=>gn(m,t),style:{fontSize:"10px",fill:"#F44336",fontWeight:500}})]}),a.jsx(Ye,{type:"monotone",dataKey:"net",name:r("chart.net"),stroke:"#2196F3",strokeWidth:2,dot:{fill:"#2196F3",strokeWidth:2,r:4},activeDot:{r:6},isAnimationActive:!0,animationBegin:400,animationDuration:1e3,animationEasing:"ease-out"})]})})}const oe=7,ae=["#4CAF50","#2196F3","#FF9800","#9C27B0","#F44336","#00BCD4","#FFEB3B","#795548","#607D8B"];function Ss({changePercent:e}){if(e==null)return null;const t=e>0,n=Math.abs(e)>=20;return e===0?a.jsxs("span",{className:"inline-flex items-center gap-0.5 text-xs text-gray-500 dark:text-gray-400",children:[a.jsx(Ur,{className:"w-3 h-3"}),a.jsx("span",{children:"0%"})]}):a.jsxs("span",{className:z("inline-flex items-center gap-0.5 text-xs font-medium",t?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400",n&&"font-bold"),children:[t?a.jsx(Er,{className:"w-3 h-3"}):a.jsx(kr,{className:"w-3 h-3"}),a.jsxs("span",{children:[t?"+":"",e.toFixed(0),"%"]})]})}function As({data:e}){const{t}=Y("common"),{currency:n}=Bt(),{data:r}=$t(),{resolvedTheme:s}=je(),i=s==="dark",[o,c]=C.useState(!1),u=i?"#1e1e2e":"#fff",l=i?"#45475a":"#E5E7EB",d=i?"#cdd6f4":"#374151",f=e.reduce((x,b)=>x+b.amount,0),h=[...e].sort((x,b)=>b.amount-x.amount),p=(()=>{if(h.length<=oe||o)return h.map((w,_)=>({...w,percentage:f>0?w.amount/f*100:0,color:ae[_%ae.length]}));const x=h.slice(0,oe),b=h.slice(oe),j=b.reduce((w,_)=>w+_.amount,0),S=x.map((w,_)=>({...w,percentage:f>0?w.amount/f*100:0,color:ae[_%ae.length]}));return b.length>0&&S.push({category:`${t("analytics.otherCategories")} (${b.length})`,amount:j,percentage:f>0?j/f*100:0,color:"#9E9E9E",isOther:!0,otherCount:b.length}),S})(),y=h.length>oe,v=x=>{const{x:b,y:j,width:S,height:w,value:_}=x;return a.jsxs("text",{x:b+S+8,y:j+w/2,fill:d,textAnchor:"start",dominantBaseline:"middle",fontSize:12,children:[_.toFixed(1),"%"]})},g=Math.max(200,p.length*32);return a.jsxs("div",{className:"w-full",children:[a.jsx(we,{width:"100%",height:g,children:a.jsxs(nr,{data:p,layout:"vertical",margin:{top:5,right:60,left:0,bottom:5},children:[a.jsx(Ft,{type:"number",hide:!0,domain:[0,100]}),a.jsx(zt,{type:"category",dataKey:"category",width:100,tick:{fill:d,fontSize:12},axisLine:!1,tickLine:!1}),a.jsx(Se,{contentStyle:{backgroundColor:u,border:`1px solid ${l}`,borderRadius:"8px",fontSize:"14px",color:d},content:({active:x,payload:b})=>{if(!x||!(b!=null&&b[0]))return null;const j=b[0].payload,S=j.change_percent!==null&&j.change_percent!==void 0;return a.jsxs("div",{className:"p-3 rounded-lg shadow-lg",style:{backgroundColor:u,border:`1px solid ${l}`},children:[a.jsx("p",{className:"font-medium mb-1",children:j.category}),a.jsx("p",{className:"text-sm",children:H(j.amount,n,(r==null?void 0:r.rates)||{},!1)}),S&&a.jsxs("div",{className:"mt-1 pt-1 border-t border-gray-200 dark:border-gray-600",children:[a.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t("analytics.vsPrevious"),": "]}),a.jsx(Ss,{changePercent:j.change_percent})]})]})}}),a.jsxs(Ct,{dataKey:"percentage",radius:[0,4,4,0],maxBarSize:24,isAnimationActive:!0,animationBegin:0,animationDuration:800,animationEasing:"ease-out",children:[p.map((x,b)=>a.jsx(qt,{fill:x.color},`cell-${b}`)),a.jsx(Xt,{dataKey:"percentage",content:v})]})]})}),y&&a.jsx("button",{onClick:()=>c(!o),className:z("w-full mt-2 py-2 px-4 text-sm font-medium rounded-lg transition-colors","text-primary-600 dark:text-primary-400","hover:bg-primary-50 dark:hover:bg-primary-900/20"),children:o?t("analytics.showLessCategories"):t("analytics.showAllCategories",{count:h.length})})]})}const yn={income:"#4CAF50",expense:"#F44336",net:"#2196F3"};function Es({data:e,dataKey:t}){const{currency:n}=Bt(),{data:r}=$t(),{isPrivacyMode:s}=Pr(),{t:i}=Y("common"),{resolvedTheme:o}=je(),c=o==="dark",u=c?"#45475a":"#E5E7EB",l=c?"#a6adc8":"#6B7280",d=c?"#1e1e2e":"#fff",f=c?"#45475a":"#E5E7EB",h=c?"#cdd6f4":"#374151",m={income:i("chart.income"),expense:i("chart.expense"),net:i("chart.net")};return a.jsx(we,{width:"100%",height:"100%",children:a.jsxs(Hr,{data:e,margin:{top:5,right:30,left:20,bottom:5},children:[a.jsx(Un,{strokeDasharray:"3 3",stroke:u}),a.jsx(Ft,{dataKey:"month",stroke:l,style:{fontSize:"12px",fontFamily:"Noto Sans JP, sans-serif"}}),a.jsx(zt,{stroke:l,style:{fontSize:"12px",fontFamily:"Inter, sans-serif"},tickFormatter:p=>cn(p,n,(r==null?void 0:r.rates)||{},!1,s)}),a.jsx(Se,{contentStyle:{backgroundColor:d,border:`1px solid ${f}`,borderRadius:"8px",fontSize:"14px",color:h},formatter:p=>[cn(p,n,(r==null?void 0:r.rates)||{},!1,s),m[t]]}),a.jsx(Yn,{wrapperStyle:{fontSize:"14px",fontFamily:"Noto Sans JP, sans-serif",color:h}}),a.jsx(Ye,{type:"monotone",dataKey:t,stroke:yn[t],strokeWidth:2,dot:{fill:yn[t],r:4},activeDot:{r:6},name:m[t],isAnimationActive:!0,animationBegin:0,animationDuration:1200,animationEasing:"ease-out"})]})})}function ks({data:e,savingsGoal:t}){const{t:n}=Y("common"),{currency:r}=Bt(),{data:s}=$t(),{resolvedTheme:i}=je(),o=i==="dark",c=o?"#1e1e2e":"#fff",u=o?"#45475a":"#E5E7EB",l=o?"#cdd6f4":"#374151",d=e.length>0?e[e.length-1]:null,f=(d==null?void 0:d.net)||0,h=e.length>1?e.slice(0,-1):e,m=h.length>0?h.reduce((x,b)=>x+b.net,0)/h.length:f,p=[{name:n("analytics.thisMonth"),value:f,color:f>=0?"#4CAF50":"#F44336"},{name:n("analytics.average"),value:m,color:"#9E9E9E"}],y=m!==0?(f-m)/Math.abs(m)*100:0,v=y>=0,g=t&&t>0?Math.min(f/t*100,100):null;return e.length===1?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full py-8",children:[a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-2",children:n("analytics.netCashFlow")}),a.jsx("p",{className:z("text-3xl font-bold",f>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:H(f,r,(s==null?void 0:s.rates)||{},!1)}),f>=0&&a.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 mt-1",children:n("analytics.positiveCashFlow")}),t&&t>0&&a.jsxs("div",{className:"mt-4 w-full max-w-xs",children:[a.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1",children:[a.jsx("span",{children:n("analytics.savingsGoal")}),a.jsxs("span",{children:[(g??0).toFixed(0),"%"]})]}),a.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:a.jsx("div",{className:z("h-full rounded-full transition-all duration-700 ease-out",g&&g>=100?"bg-green-500":"bg-primary-500"),style:{width:`${g||0}%`}})}),a.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 text-center",children:[H(t,r,(s==null?void 0:s.rates)||{},!1)," ",n("analytics.target")]})]})]}):a.jsxs("div",{className:"w-full h-full flex flex-col",children:[a.jsx("div",{className:"flex-1 min-h-[150px]",children:a.jsx(we,{width:"100%",height:"100%",children:a.jsxs(nr,{data:p,layout:"vertical",margin:{top:10,right:60,left:10,bottom:10},children:[a.jsx(Ft,{type:"number",hide:!0}),a.jsx(zt,{type:"category",dataKey:"name",width:80,tick:{fill:l,fontSize:12},axisLine:!1,tickLine:!1}),a.jsx(Se,{contentStyle:{backgroundColor:c,border:`1px solid ${u}`,borderRadius:"8px",fontSize:"14px",color:l},formatter:x=>[H(x,r,(s==null?void 0:s.rates)||{},!1),n("analytics.netCashFlow")]}),t&&t>0&&a.jsx(Vr,{x:t,stroke:"#9C27B0",strokeDasharray:"3 3",label:{value:n("analytics.goal"),position:"top",fill:"#9C27B0",fontSize:10}}),a.jsx(Ct,{dataKey:"value",radius:[0,4,4,0],maxBarSize:32,isAnimationActive:!0,animationBegin:0,animationDuration:800,animationEasing:"ease-out",children:p.map((x,b)=>a.jsx(qt,{fill:x.color},`cell-${b}`))})]})})}),a.jsxs("div",{className:"flex items-center justify-center gap-2 py-2 border-t border-gray-100 dark:border-gray-800",children:[a.jsxs("span",{className:z("text-sm font-medium",v?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"),children:[v?"▲":"▼"," ",Math.abs(y).toFixed(1),"%"]}),a.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:n("analytics.vsAverage")})]}),t&&t>0&&a.jsxs("div",{className:"px-4 pb-2",children:[a.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mb-1",children:[a.jsx("span",{children:n("analytics.savingsGoal")}),a.jsxs("span",{children:[H(f,r,(s==null?void 0:s.rates)||{},!1)," / ",H(t,r,(s==null?void 0:s.rates)||{},!1)]})]}),a.jsx("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:a.jsx("div",{className:z("h-full rounded-full transition-all duration-700 ease-out",g&&g>=100?"bg-green-500":"bg-primary-500"),style:{width:`${g||0}%`}})})]})]})}function Ps(e,t,n){return Math.max(t,Math.min(e,n))}const D={toVector(e,t){return e===void 0&&(e=t),Array.isArray(e)?e:[e,e]},add(e,t){return[e[0]+t[0],e[1]+t[1]]},sub(e,t){return[e[0]-t[0],e[1]-t[1]]},addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function xn(e,t,n){return t===0||Math.abs(t)===1/0?Math.pow(e,n*5):e*t*n/(t+n*e)}function vn(e,t,n,r=.15){return r===0?Ps(e,t,n):e<t?-xn(t-e,n-t,r)+t:e>n?+xn(e-n,n-t,r)+n:e}function Os(e,[t,n],[r,s]){const[[i,o],[c,u]]=e;return[vn(t,i,o,r),vn(n,c,u,s)]}function Ts(e,t){if(typeof e!="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ns(e){var t=Ts(e,"string");return typeof t=="symbol"?t:String(t)}function F(e,t,n){return t=Ns(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bn(Object(n),!0).forEach(function(r){F(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}const rr={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function _n(e){return e?e[0].toUpperCase()+e.slice(1):""}const Cs=["enter","leave"];function Is(e=!1,t){return e&&!Cs.includes(t)}function Ds(e,t="",n=!1){const r=rr[e],s=r&&r[t]||t;return"on"+_n(e)+_n(s)+(Is(n,s)?"Capture":"")}const Ms=["gotpointercapture","lostpointercapture"];function Ls(e){let t=e.substring(2).toLowerCase();const n=!!~t.indexOf("passive");n&&(t=t.replace("passive",""));const r=Ms.includes(t)?"capturecapture":"capture",s=!!~t.indexOf(r);return s&&(t=t.replace("capture","")),{device:t,capture:s,passive:n}}function Bs(e,t=""){const n=rr[e],r=n&&n[t]||t;return e+r}function ke(e){return"touches"in e}function sr(e){return ke(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function $s(e){return Array.from(e.touches).filter(t=>{var n,r;return t.target===e.currentTarget||((n=e.currentTarget)===null||n===void 0||(r=n.contains)===null||r===void 0?void 0:r.call(n,t.target))})}function Fs(e){return e.type==="touchend"||e.type==="touchcancel"?e.changedTouches:e.targetTouches}function ir(e){return ke(e)?Fs(e)[0]:e}function ze(e,t){try{const n=t.clientX-e.clientX,r=t.clientY-e.clientY,s=(t.clientX+e.clientX)/2,i=(t.clientY+e.clientY)/2,o=Math.hypot(n,r);return{angle:-(Math.atan2(n,r)*180)/Math.PI,distance:o,origin:[s,i]}}catch{}return null}function zs(e){return $s(e).map(t=>t.identifier)}function jn(e,t){const[n,r]=Array.from(e.touches).filter(s=>t.includes(s.identifier));return ze(n,r)}function De(e){const t=ir(e);return ke(e)?t.identifier:t.pointerId}function Lt(e){const t=ir(e);return[t.clientX,t.clientY]}const wn=40,Sn=800;function or(e){let{deltaX:t,deltaY:n,deltaMode:r}=e;return r===1?(t*=wn,n*=wn):r===2&&(t*=Sn,n*=Sn),[t,n]}function Ks(e){var t,n;const{scrollX:r,scrollY:s,scrollLeft:i,scrollTop:o}=e.currentTarget;return[(t=r??i)!==null&&t!==void 0?t:0,(n=s??o)!==null&&n!==void 0?n:0]}function Rs(e){const t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){const{shiftKey:n,altKey:r,metaKey:s,ctrlKey:i}=e;Object.assign(t,{shiftKey:n,altKey:r,metaKey:s,ctrlKey:i})}return t}function be(e,...t){return typeof e=="function"?e(...t):e}function Vs(){}function Hs(...e){return e.length===0?Vs:e.length===1?e[0]:function(){let t;for(const n of e)t=n.apply(this,arguments)||t;return t}}function An(e,t){return Object.assign({},t,e||{})}const Ys=32;let ar=class{constructor(t,n,r){this.ctrl=t,this.args=n,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(t){this.ctrl.state[this.key]=t}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:t,shared:n,ingKey:r,args:s}=this;n[r]=t._active=t.active=t._blocked=t._force=!1,t._step=[!1,!1],t.intentional=!1,t._movement=[0,0],t._distance=[0,0],t._direction=[0,0],t._delta=[0,0],t._bounds=[[-1/0,1/0],[-1/0,1/0]],t.args=s,t.axis=void 0,t.memo=void 0,t.elapsedTime=t.timeDelta=0,t.direction=[0,0],t.distance=[0,0],t.overflow=[0,0],t._movementBound=[!1,!1],t.velocity=[0,0],t.movement=[0,0],t.delta=[0,0],t.timeStamp=0}start(t){const n=this.state,r=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=t.target,n.currentTarget=t.currentTarget,n.lastOffset=r.from?be(r.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=t.timeStamp)}computeValues(t){const n=this.state;n._values=t,n.values=this.config.transform(t)}computeInitial(){const t=this.state;t._initial=t._values,t.initial=t.values}compute(t){const{state:n,config:r,shared:s}=this;n.args=this.args;let i=0;if(t&&(n.event=t,r.preventDefault&&t.cancelable&&n.event.preventDefault(),n.type=t.type,s.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,s.locked=!!document.pointerLockElement,Object.assign(s,Rs(t)),s.down=s.pressed=s.buttons%2===1||s.touches>0,i=t.timeStamp-n.timeStamp,n.timeStamp=t.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const w=n._delta.map(Math.abs);D.addTo(n._distance,w)}this.axisIntent&&this.axisIntent(t);const[o,c]=n._movement,[u,l]=r.threshold,{_step:d,values:f}=n;if(r.hasCustomTransform?(d[0]===!1&&(d[0]=Math.abs(o)>=u&&f[0]),d[1]===!1&&(d[1]=Math.abs(c)>=l&&f[1])):(d[0]===!1&&(d[0]=Math.abs(o)>=u&&Math.sign(o)*u),d[1]===!1&&(d[1]=Math.abs(c)>=l&&Math.sign(c)*l)),n.intentional=d[0]!==!1||d[1]!==!1,!n.intentional)return;const h=[0,0];if(r.hasCustomTransform){const[w,_]=f;h[0]=d[0]!==!1?w-d[0]:0,h[1]=d[1]!==!1?_-d[1]:0}else h[0]=d[0]!==!1?o-d[0]:0,h[1]=d[1]!==!1?c-d[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(h);const m=n.offset,p=n._active&&!n._blocked||n.active;p&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=s[this.ingKey]=n._active,t&&(n.first&&("bounds"in r&&(n._bounds=be(r.bounds,n)),this.setup&&this.setup()),n.movement=h,this.computeOffset()));const[y,v]=n.offset,[[g,x],[b,j]]=n._bounds;n.overflow=[y<g?-1:y>x?1:0,v<b?-1:v>j?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const S=n._active?r.rubberband||[0,0]:[0,0];if(n.offset=Os(n._bounds,n.offset,S),n.delta=D.sub(n.offset,m),this.computeMovement(),p&&(!n.last||i>Ys)){n.delta=D.sub(n.offset,m);const w=n.delta.map(Math.abs);D.addTo(n.distance,w),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&i>0&&(n.velocity=[w[0]/i,w[1]/i],n.timeDelta=i)}}emit(){const t=this.state,n=this.shared,r=this.config;if(t._active||this.clean(),(t._blocked||!t.intentional)&&!t._force&&!r.triggerAllEvents)return;const s=this.handler(B(B(B({},n),t),{},{[this.aliasKey]:t.values}));s!==void 0&&(t.memo=s)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}};function Us([e,t],n){const r=Math.abs(e),s=Math.abs(t);if(r>s&&r>n)return"x";if(s>r&&s>n)return"y"}class te extends ar{constructor(...t){super(...t),F(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=D.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=D.sub(this.state.offset,this.state.lastOffset)}axisIntent(t){const n=this.state,r=this.config;if(!n.axis&&t){const s=typeof r.axisThreshold=="object"?r.axisThreshold[sr(t)]:r.axisThreshold;n.axis=Us(n._movement,s)}n._blocked=(r.lockDirection||!!r.axis)&&!n.axis||!!r.axis&&r.axis!==n.axis}restrictToAxis(t){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":t[1]=0;break;case"y":t[0]=0;break}}}const Ws=e=>e,En=.15,cr={enabled(e=!0){return e},eventOptions(e,t,n){return B(B({},n.shared.eventOptions),e)},preventDefault(e=!1){return e},triggerAllEvents(e=!1){return e},rubberband(e=0){switch(e){case!0:return[En,En];case!1:return[0,0];default:return D.toVector(e)}},from(e){if(typeof e=="function")return e;if(e!=null)return D.toVector(e)},transform(e,t,n){const r=e||n.shared.transform;return this.hasCustomTransform=!!r,r||Ws},threshold(e){return D.toVector(e,0)}},Gs=0,St=B(B({},cr),{},{axis(e,t,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(e=Gs){return e},bounds(e={}){if(typeof e=="function")return i=>St.bounds(e(i));if("current"in e)return()=>e.current;if(typeof HTMLElement=="function"&&e instanceof HTMLElement)return e;const{left:t=-1/0,right:n=1/0,top:r=-1/0,bottom:s=1/0}=e;return[[t,n],[r,s]]}}),kn={ArrowRight:(e,t=1)=>[e*t,0],ArrowLeft:(e,t=1)=>[-1*e*t,0],ArrowUp:(e,t=1)=>[0,-1*e*t],ArrowDown:(e,t=1)=>[0,e*t]};class Xs extends te{constructor(...t){super(...t),F(this,"ingKey","dragging")}reset(){super.reset();const t=this.state;t._pointerId=void 0,t._pointerActive=!1,t._keyboardActive=!1,t._preventScroll=!1,t._delayed=!1,t.swipe=[0,0],t.tap=!1,t.canceled=!1,t.cancel=this.cancel.bind(this)}setup(){const t=this.state;if(t._bounds instanceof HTMLElement){const n=t._bounds.getBoundingClientRect(),r=t.currentTarget.getBoundingClientRect(),s={left:n.left-r.left+t.offset[0],right:n.right-r.right+t.offset[0],top:n.top-r.top+t.offset[1],bottom:n.bottom-r.bottom+t.offset[1]};t._bounds=St.bounds(s)}}cancel(){const t=this.state;t.canceled||(t.canceled=!0,t._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(t){const n=this.config,r=this.state;if(t.buttons!=null&&(Array.isArray(n.pointerButtons)?!n.pointerButtons.includes(t.buttons):n.pointerButtons!==-1&&n.pointerButtons!==t.buttons))return;const s=this.ctrl.setEventIds(t);n.pointerCapture&&t.target.setPointerCapture(t.pointerId),!(s&&s.size>1&&r._pointerActive)&&(this.start(t),this.setupPointer(t),r._pointerId=De(t),r._pointerActive=!0,this.computeValues(Lt(t)),this.computeInitial(),n.preventScrollAxis&&sr(t)!=="mouse"?(r._active=!1,this.setupScrollPrevention(t)):n.delay>0?(this.setupDelayTrigger(t),n.triggerAllEvents&&(this.compute(t),this.emit())):this.startPointerDrag(t))}startPointerDrag(t){const n=this.state;n._active=!0,n._preventScroll=!0,n._delayed=!1,this.compute(t),this.emit()}pointerMove(t){const n=this.state,r=this.config;if(!n._pointerActive)return;const s=De(t);if(n._pointerId!==void 0&&s!==n._pointerId)return;const i=Lt(t);if(document.pointerLockElement===t.target?n._delta=[t.movementX,t.movementY]:(n._delta=D.sub(i,n._values),this.computeValues(i)),D.addTo(n._movement,n._delta),this.compute(t),n._delayed&&n.intentional){this.timeoutStore.remove("dragDelay"),n.active=!1,this.startPointerDrag(t);return}if(r.preventScrollAxis&&!n._preventScroll)if(n.axis)if(n.axis===r.preventScrollAxis||r.preventScrollAxis==="xy"){n._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(t);return}else return;this.emit()}pointerUp(t){this.ctrl.setEventIds(t);try{this.config.pointerCapture&&t.target.hasPointerCapture(t.pointerId)&&t.target.releasePointerCapture(t.pointerId)}catch{}const n=this.state,r=this.config;if(!n._active||!n._pointerActive)return;const s=De(t);if(n._pointerId!==void 0&&s!==n._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(t);const[i,o]=n._distance;if(n.tap=i<=r.tapsThreshold&&o<=r.tapsThreshold,n.tap&&r.filterTaps)n._force=!0;else{const[c,u]=n._delta,[l,d]=n._movement,[f,h]=r.swipe.velocity,[m,p]=r.swipe.distance,y=r.swipe.duration;if(n.elapsedTime<y){const v=Math.abs(c/n.timeDelta),g=Math.abs(u/n.timeDelta);v>f&&Math.abs(l)>m&&(n.swipe[0]=Math.sign(c)),g>h&&Math.abs(d)>p&&(n.swipe[1]=Math.sign(u))}}this.emit()}pointerClick(t){!this.state.tap&&t.detail>0&&(t.preventDefault(),t.stopPropagation())}setupPointer(t){const n=this.config,r=n.device;n.pointerLock&&t.currentTarget.requestPointerLock(),n.pointerCapture||(this.eventStore.add(this.sharedConfig.window,r,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,r,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(t){this.state._preventScroll&&t.cancelable&&t.preventDefault()}setupScrollPrevention(t){this.state._preventScroll=!1,qs(t);const n=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",n),this.eventStore.add(this.sharedConfig.window,"touch","cancel",n),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,t)}setupDelayTrigger(t){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(t)},this.config.delay)}keyDown(t){const n=kn[t.key];if(n){const r=this.state,s=t.shiftKey?10:t.altKey?.1:1;this.start(t),r._delta=n(this.config.keyboardDisplacement,s),r._keyboardActive=!0,D.addTo(r._movement,r._delta),this.compute(t),this.emit()}}keyUp(t){t.key in kn&&(this.state._keyboardActive=!1,this.setActive(),this.compute(t),this.emit())}bind(t){const n=this.config.device;t(n,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(t(n,"change",this.pointerMove.bind(this)),t(n,"end",this.pointerUp.bind(this)),t(n,"cancel",this.pointerUp.bind(this)),t("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(t("key","down",this.keyDown.bind(this)),t("key","up",this.keyUp.bind(this))),this.config.filterTaps&&t("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function qs(e){"persist"in e&&typeof e.persist=="function"&&e.persist()}const ee=typeof window<"u"&&window.document&&window.document.createElement;function lr(){return ee&&"ontouchstart"in window}function Js(){return lr()||ee&&window.navigator.maxTouchPoints>1}function Qs(){return ee&&"onpointerdown"in window}function Zs(){return ee&&"exitPointerLock"in window.document}function ti(){try{return"constructor"in GestureEvent}catch{return!1}}const Q={isBrowser:ee,gesture:ti(),touch:lr(),touchscreen:Js(),pointer:Qs(),pointerLock:Zs()},ei=250,ni=180,ri=.5,si=50,ii=250,oi=10,Pn={mouse:0,touch:0,pen:8},ai=B(B({},St),{},{device(e,t,{pointer:{touch:n=!1,lock:r=!1,mouse:s=!1}={}}){return this.pointerLock=r&&Q.pointerLock,Q.touch&&n?"touch":this.pointerLock?"mouse":Q.pointer&&!s?"pointer":Q.touch?"touch":"mouse"},preventScrollAxis(e,t,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&e?ei:void 0,!(!Q.touchscreen||n===!1))return e||(n!==void 0?"y":void 0)},pointerCapture(e,t,{pointer:{capture:n=!0,buttons:r=1,keys:s=!0}={}}){return this.pointerButtons=r,this.keys=s,!this.pointerLock&&this.device==="pointer"&&n},threshold(e,t,{filterTaps:n=!1,tapsThreshold:r=3,axis:s=void 0}){const i=D.toVector(e,n?r:s?1:0);return this.filterTaps=n,this.tapsThreshold=r,i},swipe({velocity:e=ri,distance:t=si,duration:n=ii}={}){return{velocity:this.transform(D.toVector(e)),distance:this.transform(D.toVector(t)),duration:n}},delay(e=0){switch(e){case!0:return ni;case!1:return 0;default:return e}},axisThreshold(e){return e?B(B({},Pn),e):Pn},keyboardDisplacement(e=oi){return e}});function ur(e){const[t,n]=e.overflow,[r,s]=e._delta,[i,o]=e._direction;(t<0&&r>0&&i<0||t>0&&r<0&&i>0)&&(e._movement[0]=e._movementBound[0]),(n<0&&s>0&&o<0||n>0&&s<0&&o>0)&&(e._movement[1]=e._movementBound[1])}const ci=30,li=100;class ui extends ar{constructor(...t){super(...t),F(this,"ingKey","pinching"),F(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const t=this.state;t._touchIds=[],t.canceled=!1,t.cancel=this.cancel.bind(this),t.turns=0}computeOffset(){const{type:t,movement:n,lastOffset:r}=this.state;t==="wheel"?this.state.offset=D.add(n,r):this.state.offset=[(1+n[0])*r[0],n[1]+r[1]]}computeMovement(){const{offset:t,lastOffset:n}=this.state;this.state.movement=[t[0]/n[0],t[1]-n[1]]}axisIntent(){const t=this.state,[n,r]=t._movement;if(!t.axis){const s=Math.abs(n)*ci-Math.abs(r);s<0?t.axis="angle":s>0&&(t.axis="scale")}}restrictToAxis(t){this.config.lockDirection&&(this.state.axis==="scale"?t[1]=0:this.state.axis==="angle"&&(t[0]=0))}cancel(){const t=this.state;t.canceled||setTimeout(()=>{t.canceled=!0,t._active=!1,this.compute(),this.emit()},0)}touchStart(t){this.ctrl.setEventIds(t);const n=this.state,r=this.ctrl.touchIds;if(n._active&&n._touchIds.every(i=>r.has(i))||r.size<2)return;this.start(t),n._touchIds=Array.from(r).slice(0,2);const s=jn(t,n._touchIds);s&&this.pinchStart(t,s)}pointerStart(t){if(t.buttons!=null&&t.buttons%2!==1)return;this.ctrl.setEventIds(t),t.target.setPointerCapture(t.pointerId);const n=this.state,r=n._pointerEvents,s=this.ctrl.pointerIds;if(n._active&&Array.from(r.keys()).every(o=>s.has(o))||(r.size<2&&r.set(t.pointerId,t),n._pointerEvents.size<2))return;this.start(t);const i=ze(...Array.from(r.values()));i&&this.pinchStart(t,i)}pinchStart(t,n){const r=this.state;r.origin=n.origin,this.computeValues([n.distance,n.angle]),this.computeInitial(),this.compute(t),this.emit()}touchMove(t){if(!this.state._active)return;const n=jn(t,this.state._touchIds);n&&this.pinchMove(t,n)}pointerMove(t){const n=this.state._pointerEvents;if(n.has(t.pointerId)&&n.set(t.pointerId,t),!this.state._active)return;const r=ze(...Array.from(n.values()));r&&this.pinchMove(t,r)}pinchMove(t,n){const r=this.state,s=r._values[1],i=n.angle-s;let o=0;Math.abs(i)>270&&(o+=Math.sign(i)),this.computeValues([n.distance,n.angle-360*o]),r.origin=n.origin,r.turns=o,r._movement=[r._values[0]/r._initial[0]-1,r._values[1]-r._initial[1]],this.compute(t),this.emit()}touchEnd(t){this.ctrl.setEventIds(t),this.state._active&&this.state._touchIds.some(n=>!this.ctrl.touchIds.has(n))&&(this.state._active=!1,this.compute(t),this.emit())}pointerEnd(t){const n=this.state;this.ctrl.setEventIds(t);try{t.target.releasePointerCapture(t.pointerId)}catch{}n._pointerEvents.has(t.pointerId)&&n._pointerEvents.delete(t.pointerId),n._active&&n._pointerEvents.size<2&&(n._active=!1,this.compute(t),this.emit())}gestureStart(t){t.cancelable&&t.preventDefault();const n=this.state;n._active||(this.start(t),this.computeValues([t.scale,t.rotation]),n.origin=[t.clientX,t.clientY],this.compute(t),this.emit())}gestureMove(t){if(t.cancelable&&t.preventDefault(),!this.state._active)return;const n=this.state;this.computeValues([t.scale,t.rotation]),n.origin=[t.clientX,t.clientY];const r=n._movement;n._movement=[t.scale-1,t.rotation],n._delta=D.sub(n._movement,r),this.compute(t),this.emit()}gestureEnd(t){this.state._active&&(this.state._active=!1,this.compute(t),this.emit())}wheel(t){const n=this.config.modifierKey;n&&(Array.isArray(n)?!n.find(r=>t[r]):!t[n])||(this.state._active?this.wheelChange(t):this.wheelStart(t),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(t){this.start(t),this.wheelChange(t)}wheelChange(t){"uv"in t||t.cancelable&&t.preventDefault();const r=this.state;r._delta=[-or(t)[1]/li*r.offset[0],0],D.addTo(r._movement,r._delta),ur(r),this.state.origin=[t.clientX,t.clientY],this.compute(t),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(t){const n=this.config.device;n&&(t(n,"start",this[n+"Start"].bind(this)),t(n,"change",this[n+"Move"].bind(this)),t(n,"end",this[n+"End"].bind(this)),t(n,"cancel",this[n+"End"].bind(this)),t("lostPointerCapture","",this[n+"End"].bind(this))),this.config.pinchOnWheel&&t("wheel","",this.wheel.bind(this),{passive:!1})}}const di=B(B({},cr),{},{device(e,t,{shared:n,pointer:{touch:r=!1}={}}){if(n.target&&!Q.touch&&Q.gesture)return"gesture";if(Q.touch&&r)return"touch";if(Q.touchscreen){if(Q.pointer)return"pointer";if(Q.touch)return"touch"}},bounds(e,t,{scaleBounds:n={},angleBounds:r={}}){const s=o=>{const c=An(be(n,o),{min:-1/0,max:1/0});return[c.min,c.max]},i=o=>{const c=An(be(r,o),{min:-1/0,max:1/0});return[c.min,c.max]};return typeof n!="function"&&typeof r!="function"?[s(),i()]:o=>[s(o),i(o)]},threshold(e,t,n){return this.lockDirection=n.axis==="lock",D.toVector(e,this.lockDirection?[.1,3]:0)},modifierKey(e){return e===void 0?"ctrlKey":e},pinchOnWheel(e=!0){return e}});class fi extends te{constructor(...t){super(...t),F(this,"ingKey","moving")}move(t){this.config.mouseOnly&&t.pointerType!=="mouse"||(this.state._active?this.moveChange(t):this.moveStart(t),this.timeoutStore.add("moveEnd",this.moveEnd.bind(this)))}moveStart(t){this.start(t),this.computeValues(Lt(t)),this.compute(t),this.computeInitial(),this.emit()}moveChange(t){if(!this.state._active)return;const n=Lt(t),r=this.state;r._delta=D.sub(n,r._values),D.addTo(r._movement,r._delta),this.computeValues(n),this.compute(t),this.emit()}moveEnd(t){this.state._active&&(this.state._active=!1,this.compute(t),this.emit())}bind(t){t("pointer","change",this.move.bind(this)),t("pointer","leave",this.moveEnd.bind(this))}}const hi=B(B({},St),{},{mouseOnly:(e=!0)=>e});class pi extends te{constructor(...t){super(...t),F(this,"ingKey","scrolling")}scroll(t){this.state._active||this.start(t),this.scrollChange(t),this.timeoutStore.add("scrollEnd",this.scrollEnd.bind(this))}scrollChange(t){t.cancelable&&t.preventDefault();const n=this.state,r=Ks(t);n._delta=D.sub(r,n._values),D.addTo(n._movement,n._delta),this.computeValues(r),this.compute(t),this.emit()}scrollEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(t){t("scroll","",this.scroll.bind(this))}}const mi=St;class gi extends te{constructor(...t){super(...t),F(this,"ingKey","wheeling")}wheel(t){this.state._active||this.start(t),this.wheelChange(t),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(t){const n=this.state;n._delta=or(t),D.addTo(n._movement,n._delta),ur(n),this.compute(t),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(t){t("wheel","",this.wheel.bind(this))}}const yi=St;class xi extends te{constructor(...t){super(...t),F(this,"ingKey","hovering")}enter(t){this.config.mouseOnly&&t.pointerType!=="mouse"||(this.start(t),this.computeValues(Lt(t)),this.compute(t),this.emit())}leave(t){if(this.config.mouseOnly&&t.pointerType!=="mouse")return;const n=this.state;if(!n._active)return;n._active=!1;const r=Lt(t);n._movement=n._delta=D.sub(r,n._values),this.computeValues(r),this.compute(t),n.delta=n.movement,this.emit()}bind(t){t("pointer","enter",this.enter.bind(this)),t("pointer","leave",this.leave.bind(this))}}const vi=B(B({},St),{},{mouseOnly:(e=!0)=>e}),Ue=new Map,Ke=new Map;function bi(e){Ue.set(e.key,e.engine),Ke.set(e.key,e.resolver)}const _i={key:"drag",engine:Xs,resolver:ai},ji={key:"hover",engine:xi,resolver:vi},wi={key:"move",engine:fi,resolver:hi},Si={key:"pinch",engine:ui,resolver:di},Ai={key:"scroll",engine:pi,resolver:mi},Ei={key:"wheel",engine:gi,resolver:yi};function ki(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,i;for(i=0;i<r.length;i++)s=r[i],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function Pi(e,t){if(e==null)return{};var n=ki(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}const Oi={target(e){if(e)return()=>"current"in e?e.current:e},enabled(e=!0){return e},window(e=Q.isBrowser?window:void 0){return e},eventOptions({passive:e=!0,capture:t=!1}={}){return{passive:e,capture:t}},transform(e){return e}},Ti=["target","eventOptions","window","enabled","transform"];function he(e={},t){const n={};for(const[r,s]of Object.entries(t))switch(typeof s){case"function":n[r]=s.call(n,e[r],r,e);break;case"object":n[r]=he(e[r],s);break;case"boolean":s&&(n[r]=e[r]);break}return n}function Ni(e,t,n={}){const r=e,{target:s,eventOptions:i,window:o,enabled:c,transform:u}=r,l=Pi(r,Ti);if(n.shared=he({target:s,eventOptions:i,window:o,enabled:c,transform:u},Oi),t){const d=Ke.get(t);n[t]=he(B({shared:n.shared},l),d)}else for(const d in l){const f=Ke.get(d);f&&(n[d]=he(B({shared:n.shared},l[d]),f))}return n}let dr=class{constructor(t,n){F(this,"_listeners",new Set),this._ctrl=t,this._gestureKey=n}add(t,n,r,s,i){const o=this._listeners,c=Bs(n,r),u=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},l=B(B({},u),i);t.addEventListener(c,s,l);const d=()=>{t.removeEventListener(c,s,l),o.delete(d)};return o.add(d),d}clean(){this._listeners.forEach(t=>t()),this._listeners.clear()}};class Ci{constructor(){F(this,"_timeouts",new Map)}add(t,n,r=140,...s){this.remove(t),this._timeouts.set(t,window.setTimeout(n,r,...s))}remove(t){const n=this._timeouts.get(t);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(t=>void window.clearTimeout(t)),this._timeouts.clear()}}class Ii{constructor(t){F(this,"gestures",new Set),F(this,"_targetEventStore",new dr(this)),F(this,"gestureEventStores",{}),F(this,"gestureTimeoutStores",{}),F(this,"handlers",{}),F(this,"config",{}),F(this,"pointerIds",new Set),F(this,"touchIds",new Set),F(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),Di(this,t)}setEventIds(t){if(ke(t))return this.touchIds=new Set(zs(t)),this.touchIds;if("pointerId"in t)return t.type==="pointerup"||t.type==="pointercancel"?this.pointerIds.delete(t.pointerId):t.type==="pointerdown"&&this.pointerIds.add(t.pointerId),this.pointerIds}applyHandlers(t,n){this.handlers=t,this.nativeHandlers=n}applyConfig(t,n){this.config=Ni(t,n,this.config)}clean(){this._targetEventStore.clean();for(const t of this.gestures)this.gestureEventStores[t].clean(),this.gestureTimeoutStores[t].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...t){const n=this.config.shared,r={};let s;if(!(n.target&&(s=n.target(),!s))){if(n.enabled){for(const o of this.gestures){const c=this.config[o],u=On(r,c.eventOptions,!!s);if(c.enabled){const l=Ue.get(o);new l(this,t,o).bind(u)}}const i=On(r,n.eventOptions,!!s);for(const o in this.nativeHandlers)i(o,"",c=>this.nativeHandlers[o](B(B({},this.state.shared),{},{event:c,args:t})),void 0,!0)}for(const i in r)r[i]=Hs(...r[i]);if(!s)return r;for(const i in r){const{device:o,capture:c,passive:u}=Ls(i);this._targetEventStore.add(s,o,"",r[i],{capture:c,passive:u})}}}}function Pt(e,t){e.gestures.add(t),e.gestureEventStores[t]=new dr(e,t),e.gestureTimeoutStores[t]=new Ci}function Di(e,t){t.drag&&Pt(e,"drag"),t.wheel&&Pt(e,"wheel"),t.scroll&&Pt(e,"scroll"),t.move&&Pt(e,"move"),t.pinch&&Pt(e,"pinch"),t.hover&&Pt(e,"hover")}const On=(e,t,n)=>(r,s,i,o={},c=!1)=>{var u,l;const d=(u=o.capture)!==null&&u!==void 0?u:t.capture,f=(l=o.passive)!==null&&l!==void 0?l:t.passive;let h=c?r:Ds(r,s,d);n&&f&&(h+="Passive"),e[h]=e[h]||[],e[h].push(i)},Mi=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function Li(e){const t={},n={},r=new Set;for(let s in e)Mi.test(s)?(r.add(RegExp.lastMatch),n[s]=e[s]):t[s]=e[s];return[n,t,r]}function Ot(e,t,n,r,s,i){if(!e.has(n)||!Ue.has(r))return;const o=n+"Start",c=n+"End",u=l=>{let d;return l.first&&o in t&&t[o](l),n in t&&(d=t[n](l)),l.last&&c in t&&t[c](l),d};s[r]=u,i[r]=i[r]||{}}function Bi(e,t){const[n,r,s]=Li(e),i={};return Ot(s,n,"onDrag","drag",i,t),Ot(s,n,"onWheel","wheel",i,t),Ot(s,n,"onScroll","scroll",i,t),Ot(s,n,"onPinch","pinch",i,t),Ot(s,n,"onMove","move",i,t),Ot(s,n,"onHover","hover",i,t),{handlers:i,config:t,nativeHandlers:r}}function $i(e,t={},n,r){const s=T.useMemo(()=>new Ii(e),[]);if(s.applyHandlers(e,r),s.applyConfig(t,n),T.useEffect(s.effect.bind(s)),T.useEffect(()=>s.clean.bind(s),[]),t.target===void 0)return s.bind.bind(s)}function Fi(e){return e.forEach(bi),function(n,r){const{handlers:s,nativeHandlers:i,config:o}=Bi(n,r||{});return $i(s,o,void 0,i)}}function zi(e,t){return Fi([_i,Si,Ai,Ei,wi,ji])(e,t||{})}function Me({children:e,className:t="",minScale:n=1,maxScale:r=3}){const s=C.useRef(null),[i,o]=C.useState(1),[c,u]=C.useState({x:0,y:0}),l=C.useCallback(()=>{o(1),u({x:0,y:0})},[]);return zi({onPinch:({offset:[d],memo:f})=>{const h=Math.min(r,Math.max(n,d));return o(h),h<=1&&u({x:0,y:0}),f},onDrag:({offset:[d,f],pinching:h})=>{if(i>1&&!h){const m=(i-1)*100/2;u({x:Math.min(m,Math.max(-m,d)),y:Math.min(m,Math.max(-m,f))})}},onWheel:({delta:[,d],event:f})=>{f.preventDefault();const h=Math.min(r,Math.max(n,i-d*.01));o(h),h<=1&&u({x:0,y:0})}},{target:s,pinch:{scaleBounds:{min:n,max:r}},drag:{filterTaps:!0},wheel:{preventDefault:!0}}),a.jsxs("div",{className:`relative overflow-hidden touch-none ${t}`,children:[a.jsx("div",{ref:s,style:{transform:`scale(${i}) translate(${c.x}px, ${c.y}px)`,transformOrigin:"center center",transition:"transform 0.1s ease-out"},className:"w-full h-full",children:e}),i>1&&a.jsxs("button",{onClick:l,className:"absolute bottom-2 right-2 px-2 py-1 text-xs bg-gray-800/70 text-white rounded-md hover:bg-gray-700/70 transition-colors",children:[Math.round(i*100),"% - Tap to reset"]})]})}const Ki={spike:"📈",trend:"📊",unusual:"🔍",budget:"💰",saving:"✨"},Ri={info:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",warning:"bg-amber-50 dark:bg-amber-900/20 border-amber-200 dark:border-amber-800",success:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800"},Vi={info:"text-blue-700 dark:text-blue-300",warning:"text-amber-700 dark:text-amber-300",success:"text-green-700 dark:text-green-300"};function Hi({insight:e}){const{currency:t}=Bt(),{data:n}=$t();return a.jsx("div",{className:`p-4 rounded-lg border ${Ri[e.severity]} transition-all hover:shadow-sm`,children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"text-2xl",children:Ki[e.type]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:`font-medium ${Vi[e.severity]}`,children:e.title}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.message}),e.amount&&a.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mt-2",children:H(e.amount,t,(n==null?void 0:n.rates)||{},!1)})]}),e.percentage_change!==void 0&&a.jsxs("span",{className:`text-sm font-medium px-2 py-1 rounded ${e.percentage_change>0?"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400":"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400"}`,children:[e.percentage_change>0?"+":"",e.percentage_change.toFixed(0),"%"]})]})})}function Yi(){const{t:e}=Y("common"),{data:t,isLoading:n,error:r}=ue({queryKey:["spending-insights"],queryFn:Bn,staleTime:5*60*1e3});if(n)return a.jsxs(it,{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:e("analytics.spendingInsights","Spending Insights")}),a.jsx("div",{className:"flex justify-center py-8",children:a.jsx(pe,{size:"md"})})]});if(r)return a.jsxs(it,{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:e("analytics.spendingInsights","Spending Insights")}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:e("error","Failed to load insights")})]});const s=(t==null?void 0:t.insights)||[];return a.jsxs(it,{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:e("analytics.spendingInsights","Spending Insights")}),s.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("span",{className:"text-4xl mb-3 block",children:"🎉"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e("analytics.noInsights","No notable spending patterns detected")}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-1",children:e("analytics.insightsHint","Keep tracking to see personalized insights")})]}):a.jsx("div",{className:"space-y-3",children:s.map((i,o)=>a.jsx(Hi,{insight:i},`${i.type}-${i.category}-${o}`))})]})}async function Tn(e=50,t="ja"){return(await $n.post("/api/ai/categorize/suggestions",{limit:e,language:t})).data}async function Nn(e){return(await $n.post("/api/ai/categorize/apply",e)).data}const ce=50,Ui=.5;function Wi({suggestion:e,isSelected:t,onToggle:n}){const{currency:r}=Bt(),{data:s}=$t(),{t:i}=Y("common"),o=e.confidence>=.8?"text-green-600 dark:text-green-400":e.confidence>=.6?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400";return a.jsxs("div",{className:`p-3 rounded-lg border transition-colors cursor-pointer ${t?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"}`,onClick:()=>n(e.transaction_id,e.suggested_category),children:[a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:e.description}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:H(e.amount,r,(s==null?void 0:s.rates)||{},!1)})]}),a.jsxs("div",{className:"text-right flex-shrink-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[e.is_new_category&&a.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded",children:i("ai.newCategory")}),a.jsx("span",{className:"text-sm font-medium text-primary-600 dark:text-primary-400",children:e.suggested_category})]}),a.jsxs("p",{className:`text-xs mt-1 ${o}`,children:[Math.round(e.confidence*100),"% ",i("ai.confidence")]})]})]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2 italic",children:e.reason})]})}function Gi(){const{t:e,i18n:t}=Y("common"),n=Or(),[r,s]=C.useState(null),[i,o]=C.useState(new Map),[c,u]=C.useState(!0),[l,d]=C.useState(0),[f,h]=C.useState(null),m=C.useRef(!1),p=ln({mutationFn:()=>Tn(ce,t.language),onSuccess:_=>{s(_),d(_.total_other_count);const A=new Map;_.suggestions.forEach(k=>{k.confidence>=.7&&A.set(k.transaction_id,k.suggested_category)}),o(A)}}),y=ln({mutationFn:()=>Nn({approved:Array.from(i.entries()).map(([_,A])=>({transaction_id:_,category:A})),create_rules:c}),onSuccess:()=>{n.invalidateQueries({queryKey:["analytics"]}),n.invalidateQueries({queryKey:["transactions"]});const _=l-i.size;_>0?(d(_),s(null),o(new Map),setTimeout(()=>p.mutate(),500)):(s(null),o(new Map),d(0))}}),v=C.useCallback(async()=>{m.current=!1;const _=Math.ceil(l/ce);let A=0;h({isRunning:!0,processed:0,total:l,currentBatch:0,totalBatches:_});for(let k=0;k<_&&!m.current;k++){h(P=>P?{...P,currentBatch:k+1}:null);try{const P=await Tn(ce,t.language);if(P.suggestions.length===0||m.current)break;const O=P.suggestions.filter(N=>N.confidence>=.7).map(N=>({transaction_id:N.transaction_id,category:N.suggested_category}));O.length>0&&(await Nn({approved:O,create_rules:c}),A+=O.length),h(N=>N?{...N,processed:A}:null),await new Promise(N=>setTimeout(N,300))}catch{break}}h(null),n.invalidateQueries({queryKey:["analytics"]}),n.invalidateQueries({queryKey:["transactions"]}),s(null),d(0)},[l,t.language,c,n]),g=()=>{m.current=!0,h(null)},x=(_,A)=>{o(k=>{const P=new Map(k);return P.has(_)?P.delete(_):P.set(_,A),P})},b=()=>{if(!r)return;const _=new Map;r.suggestions.forEach(A=>{_.set(A.transaction_id,A.suggested_category)}),o(_)},j=()=>{o(new Map)};if(f!=null&&f.isRunning){const _=f.total>0?Math.round(f.processed/f.total*100):0;return a.jsx(it,{children:a.jsxs("div",{className:"py-8",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 text-center mb-4",children:e("ai.processingAll")}),a.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-4 mb-2",children:a.jsx("div",{className:"bg-primary-500 h-4 rounded-full transition-all duration-300",style:{width:`${_}%`}})}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center mb-4",children:e("ai.processProgress",{processed:f.processed,total:f.total,batch:f.currentBatch,totalBatches:f.totalBatches})}),a.jsx("div",{className:"text-center",children:a.jsx(nt,{variant:"outline",onClick:g,children:e("cancel")})})]})})}if(!r){const _=l,A=_>250,k=Math.ceil(_/ce)*Ui;return a.jsxs(it,{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:e("ai.categoryCleanup")}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e("ai.categoryCleanupDesc")}),_>0&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:e("ai.remainingOther",{count:_})})]}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsx(nt,{onClick:()=>p.mutate(),disabled:p.isPending,children:p.isPending?a.jsxs(a.Fragment,{children:[a.jsx(pe,{size:"sm",className:"mr-2"}),e("ai.analyzing")]}):e("ai.analyzeOther")}),A&&a.jsx(nt,{variant:"outline",onClick:v,disabled:p.isPending,title:e("ai.analyzeAllCredits",{credits:k.toFixed(1)}),children:e("ai.analyzeAll",{count:_})})]})]}),p.isError&&a.jsx("div",{className:"text-sm text-red-600 dark:text-red-400",children:e("ai.analyzeError")})]})}if(r.suggestions.length===0)return a.jsx(it,{children:a.jsxs("div",{className:"text-center py-8",children:[a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:e("ai.noSuggestions")}),a.jsx(nt,{variant:"outline",onClick:()=>s(null),className:"mt-4",children:e("close")})]})});const S=l-r.suggestions.length,w=S>250;return a.jsxs(it,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:e("ai.categoryCleanup")}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e("ai.foundSuggestions",{count:r.suggestions.length,total:l})})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(nt,{variant:"outline",size:"sm",onClick:b,children:e("ai.selectAll")}),a.jsx(nt,{variant:"outline",size:"sm",onClick:j,children:e("ai.deselectAll")})]})]}),r.new_categories_suggested.length>0&&a.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:a.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e("ai.newCategoriesSuggested"),": ",r.new_categories_suggested.join(", ")]})}),a.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:r.suggestions.map(_=>a.jsx(Wi,{suggestion:_,isSelected:i.has(_.transaction_id),onToggle:x},_.transaction_id))}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[a.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[a.jsx("input",{type:"checkbox",checked:c,onChange:_=>u(_.target.checked),className:"rounded border-gray-300 dark:border-gray-600"}),e("ai.createRulesAuto")]}),a.jsxs("div",{className:"flex gap-2 flex-wrap",children:[a.jsx(nt,{variant:"outline",onClick:()=>s(null),children:e("cancel")}),w&&a.jsx(nt,{variant:"outline",onClick:v,disabled:y.isPending,children:e("ai.analyzeAll",{count:S})}),a.jsx(nt,{onClick:()=>y.mutate(),disabled:i.size===0||y.isPending,children:y.isPending?a.jsxs(a.Fragment,{children:[a.jsx(pe,{size:"sm",className:"mr-2"}),e("ai.applying")]}):e("ai.applySelected",{count:i.size})})]})]}),y.isError&&a.jsx("div",{className:"mt-2 text-sm text-red-600 dark:text-red-400",children:e("ai.applyError")})]})]})}function le({label:e,value:t,change:n,trend:r="neutral",subtitle:s,className:i}){const{t:o}=Y("common"),c=()=>r==="positive"?"text-green-600 dark:text-green-400":r==="negative"?"text-red-600 dark:text-red-400":"text-gray-500 dark:text-gray-400",u=()=>n==null?null:n>0?"↑":n<0?"↓":"→";return a.jsxs("div",{className:z("bg-white dark:bg-gray-800 rounded-xl p-4 shadow-sm","border border-gray-100 dark:border-gray-700",i),children:[a.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:e}),a.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 truncate",children:t}),n!=null&&a.jsxs("div",{className:z("flex items-center gap-1 mt-1",c()),children:[a.jsxs("span",{className:"text-sm font-medium",children:[u()," ",Math.abs(n).toFixed(1),"%"]}),a.jsx("span",{className:"text-xs text-gray-400",children:o("analytics.vsLastPeriod")})]}),s&&a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 truncate",children:s})]})}function Xi({analytics:e,displayCurrency:t="JPY"}){const{t:n}=Y("common"),{total_income:r,total_expense:s,net_cashflow:i,comparison:o,top_category:c}=e,u=()=>o!=null&&o.income_change?o.income_change>0?"positive":"negative":"neutral",l=()=>o!=null&&o.expense_change?o.expense_change<0?"positive":"negative":"neutral",d=()=>o!=null&&o.net_change?o.net_change>0?"positive":"negative":"neutral";return a.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:[a.jsx(le,{label:n("analytics.heroIncome"),value:H(r,t),change:o==null?void 0:o.income_change,trend:u()}),a.jsx(le,{label:n("analytics.heroExpense"),value:H(s,t),change:o==null?void 0:o.expense_change,trend:l()}),a.jsx(le,{label:n("analytics.heroNet"),value:H(i,t),change:o==null?void 0:o.net_change,trend:d()}),a.jsx(le,{label:n("analytics.heroTopCategory"),value:(c==null?void 0:c.name)||"-",subtitle:c?`${H(c.amount,t)} (${c.percentage}%)`:void 0})]})}function qi(e){return Object.prototype.toString.call(e)==="[object Object]"}function Cn(e){return qi(e)||Array.isArray(e)}function Ji(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function We(e,t){const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;const s=JSON.stringify(Object.keys(e.breakpoints||{})),i=JSON.stringify(Object.keys(t.breakpoints||{}));return s!==i?!1:n.every(o=>{const c=e[o],u=t[o];return typeof c=="function"?`${c}`==`${u}`:!Cn(c)||!Cn(u)?c===u:We(c,u)})}function In(e){return e.concat().sort((t,n)=>t.name>n.name?1:-1).map(t=>t.options)}function Qi(e,t){if(e.length!==t.length)return!1;const n=In(e),r=In(t);return n.every((s,i)=>{const o=r[i];return We(s,o)})}function Ge(e){return typeof e=="number"}function Re(e){return typeof e=="string"}function Pe(e){return typeof e=="boolean"}function Dn(e){return Object.prototype.toString.call(e)==="[object Object]"}function L(e){return Math.abs(e)}function Xe(e){return Math.sign(e)}function Gt(e,t){return L(e-t)}function Zi(e,t){if(e===0||t===0||L(e)<=L(t))return 0;const n=Gt(L(e),L(t));return L(n/e)}function to(e){return Math.round(e*100)/100}function Jt(e){return Qt(e).map(Number)}function Z(e){return e[ne(e)]}function ne(e){return Math.max(0,e.length-1)}function qe(e,t){return t===ne(e)}function Mn(e,t=0){return Array.from(Array(e),(n,r)=>t+r)}function Qt(e){return Object.keys(e)}function fr(e,t){return[e,t].reduce((n,r)=>(Qt(r).forEach(s=>{const i=n[s],o=r[s],c=Dn(i)&&Dn(o);n[s]=c?fr(i,o):o}),n),{})}function Ve(e,t){return typeof t.MouseEvent<"u"&&e instanceof t.MouseEvent}function eo(e,t){const n={start:r,center:s,end:i};function r(){return 0}function s(u){return i(u)/2}function i(u){return t-u}function o(u,l){return Re(e)?n[e](u):e(t,u,l)}return{measure:o}}function Zt(){let e=[];function t(s,i,o,c={passive:!0}){let u;if("addEventListener"in s)s.addEventListener(i,o,c),u=()=>s.removeEventListener(i,o,c);else{const l=s;l.addListener(o),u=()=>l.removeListener(o)}return e.push(u),r}function n(){e=e.filter(s=>s())}const r={add:t,clear:n};return r}function no(e,t,n,r){const s=Zt(),i=1e3/60;let o=null,c=0,u=0;function l(){s.add(e,"visibilitychange",()=>{e.hidden&&p()})}function d(){m(),s.clear()}function f(v){if(!u)return;o||(o=v,n(),n());const g=v-o;for(o=v,c+=g;c>=i;)n(),c-=i;const x=c/i;r(x),u&&(u=t.requestAnimationFrame(f))}function h(){u||(u=t.requestAnimationFrame(f))}function m(){t.cancelAnimationFrame(u),o=null,c=0,u=0}function p(){o=null,c=0}return{init:l,destroy:d,start:h,stop:m,update:n,render:r}}function ro(e,t){const n=t==="rtl",r=e==="y",s=r?"y":"x",i=r?"x":"y",o=!r&&n?-1:1,c=d(),u=f();function l(p){const{height:y,width:v}=p;return r?y:v}function d(){return r?"top":n?"right":"left"}function f(){return r?"bottom":n?"left":"right"}function h(p){return p*o}return{scroll:s,cross:i,startEdge:c,endEdge:u,measureSize:l,direction:h}}function jt(e=0,t=0){const n=L(e-t);function r(l){return l<e}function s(l){return l>t}function i(l){return r(l)||s(l)}function o(l){return i(l)?r(l)?e:t:l}function c(l){return n?l-n*Math.ceil((l-t)/n):l}return{length:n,max:t,min:e,constrain:o,reachedAny:i,reachedMax:s,reachedMin:r,removeOffset:c}}function hr(e,t,n){const{constrain:r}=jt(0,e),s=e+1;let i=o(t);function o(h){return n?L((s+h)%s):r(h)}function c(){return i}function u(h){return i=o(h),f}function l(h){return d().set(c()+h)}function d(){return hr(e,c(),n)}const f={get:c,set:u,add:l,clone:d};return f}function so(e,t,n,r,s,i,o,c,u,l,d,f,h,m,p,y,v,g,x){const{cross:b,direction:j}=e,S=["INPUT","SELECT","TEXTAREA"],w={passive:!1},_=Zt(),A=Zt(),k=jt(50,225).constrain(m.measure(20)),P={mouse:300,touch:400},O={mouse:500,touch:600},N=p?43:25;let K=!1,U=0,W=0,X=!1,ht=!1,at=!1,ct=!1;function Kt(E){if(!x)return;function I(V){(Pe(x)||x(E,V))&&Vt(V)}const $=t;_.add($,"dragstart",V=>V.preventDefault(),w).add($,"touchmove",()=>{},w).add($,"touchend",()=>{}).add($,"touchstart",I).add($,"mousedown",I).add($,"touchcancel",R).add($,"contextmenu",R).add($,"click",ut,!0)}function tt(){_.clear(),A.clear()}function At(){const E=ct?n:t;A.add(E,"touchmove",G,w).add(E,"touchend",R).add(E,"mousemove",G,w).add(E,"mouseup",R)}function Et(E){const I=E.nodeName||"";return S.includes(I)}function lt(){return(p?O:P)[ct?"mouse":"touch"]}function Rt(E,I){const $=f.add(Xe(E)*-1),V=d.byDistance(E,!p).distance;return p||L(E)<k?V:v&&I?V*.5:d.byIndex($.get(),0).distance}function Vt(E){const I=Ve(E,r);ct=I,at=p&&I&&!E.buttons&&K,K=Gt(s.get(),o.get())>=2,!(I&&E.button!==0)&&(Et(E.target)||(X=!0,i.pointerDown(E),l.useFriction(0).useDuration(0),s.set(o),At(),U=i.readPoint(E),W=i.readPoint(E,b),h.emit("pointerDown")))}function G(E){if(!Ve(E,r)&&E.touches.length>=2)return R(E);const $=i.readPoint(E),V=i.readPoint(E,b),et=Gt($,U),dt=Gt(V,W);if(!ht&&!ct&&(!E.cancelable||(ht=et>dt,!ht)))return R(E);const vt=i.pointerMove(E);et>y&&(at=!0),l.useFriction(.3).useDuration(.75),c.start(),s.add(j(vt)),E.preventDefault()}function R(E){const $=d.byDistance(0,!1).index!==f.get(),V=i.pointerUp(E)*lt(),et=Rt(j(V),$),dt=Zi(V,et),vt=N-10*dt,pt=g+dt/50;ht=!1,X=!1,A.clear(),l.useDuration(vt).useFriction(pt),u.distance(et,!p),ct=!1,h.emit("pointerUp")}function ut(E){at&&(E.stopPropagation(),E.preventDefault(),at=!1)}function q(){return X}return{init:Kt,destroy:tt,pointerDown:q}}function io(e,t){let r,s;function i(f){return f.timeStamp}function o(f,h){const p=`client${(h||e.scroll)==="x"?"X":"Y"}`;return(Ve(f,t)?f:f.touches[0])[p]}function c(f){return r=f,s=f,o(f)}function u(f){const h=o(f)-o(s),m=i(f)-i(r)>170;return s=f,m&&(r=f),h}function l(f){if(!r||!s)return 0;const h=o(s)-o(r),m=i(f)-i(r),p=i(f)-i(s)>170,y=h/m;return m&&!p&&L(y)>.1?y:0}return{pointerDown:c,pointerMove:u,pointerUp:l,readPoint:o}}function oo(){function e(n){const{offsetTop:r,offsetLeft:s,offsetWidth:i,offsetHeight:o}=n;return{top:r,right:s+i,bottom:r+o,left:s,width:i,height:o}}return{measure:e}}function ao(e){function t(r){return e*(r/100)}return{measure:t}}function co(e,t,n,r,s,i,o){const c=[e].concat(r);let u,l,d=[],f=!1;function h(v){return s.measureSize(o.measure(v))}function m(v){if(!i)return;l=h(e),d=r.map(h);function g(x){for(const b of x){if(f)return;const j=b.target===e,S=r.indexOf(b.target),w=j?l:d[S],_=h(j?e:r[S]);if(L(_-w)>=.5){v.reInit(),t.emit("resize");break}}}u=new ResizeObserver(x=>{(Pe(i)||i(v,x))&&g(x)}),n.requestAnimationFrame(()=>{c.forEach(x=>u.observe(x))})}function p(){f=!0,u&&u.disconnect()}return{init:m,destroy:p}}function lo(e,t,n,r,s,i){let o=0,c=0,u=s,l=i,d=e.get(),f=0;function h(){const w=r.get()-e.get(),_=!u;let A=0;return _?(o=0,n.set(r),e.set(r),A=w):(n.set(e),o+=w/u,o*=l,d+=o,e.add(o),A=d-f),c=Xe(A),f=d,S}function m(){const w=r.get()-t.get();return L(w)<.001}function p(){return u}function y(){return c}function v(){return o}function g(){return b(s)}function x(){return j(i)}function b(w){return u=w,S}function j(w){return l=w,S}const S={direction:y,duration:p,velocity:v,seek:h,settled:m,useBaseFriction:x,useBaseDuration:g,useFriction:j,useDuration:b};return S}function uo(e,t,n,r,s){const i=s.measure(10),o=s.measure(50),c=jt(.1,.99);let u=!1;function l(){return!(u||!e.reachedAny(n.get())||!e.reachedAny(t.get()))}function d(m){if(!l())return;const p=e.reachedMin(t.get())?"min":"max",y=L(e[p]-t.get()),v=n.get()-t.get(),g=c.constrain(y/o);n.subtract(v*g),!m&&L(v)<i&&(n.set(e.constrain(n.get())),r.useDuration(25).useBaseFriction())}function f(m){u=!m}return{shouldConstrain:l,constrain:d,toggleActive:f}}function fo(e,t,n,r,s){const i=jt(-t+e,0),o=f(),c=d(),u=h();function l(p,y){return Gt(p,y)<=1}function d(){const p=o[0],y=Z(o),v=o.lastIndexOf(p),g=o.indexOf(y)+1;return jt(v,g)}function f(){return n.map((p,y)=>{const{min:v,max:g}=i,x=i.constrain(p),b=!y,j=qe(n,y);return b?g:j||l(v,x)?v:l(g,x)?g:x}).map(p=>parseFloat(p.toFixed(3)))}function h(){if(t<=e+s)return[i.max];if(r==="keepSnaps")return o;const{min:p,max:y}=c;return o.slice(p,y)}return{snapsContained:u,scrollContainLimit:c}}function ho(e,t,n){const r=t[0],s=n?r-e:Z(t);return{limit:jt(s,r)}}function po(e,t,n,r){const i=t.min+.1,o=t.max+.1,{reachedMin:c,reachedMax:u}=jt(i,o);function l(h){return h===1?u(n.get()):h===-1?c(n.get()):!1}function d(h){if(!l(h))return;const m=e*(h*-1);r.forEach(p=>p.add(m))}return{loop:d}}function mo(e){const{max:t,length:n}=e;function r(i){const o=i-t;return n?o/-n:0}return{get:r}}function go(e,t,n,r,s){const{startEdge:i,endEdge:o}=e,{groupSlides:c}=s,u=f().map(t.measure),l=h(),d=m();function f(){return c(r).map(y=>Z(y)[o]-y[0][i]).map(L)}function h(){return r.map(y=>n[i]-y[i]).map(y=>-L(y))}function m(){return c(l).map(y=>y[0]).map((y,v)=>y+u[v])}return{snaps:l,snapsAligned:d}}function yo(e,t,n,r,s,i){const{groupSlides:o}=s,{min:c,max:u}=r,l=d();function d(){const h=o(i),m=!e||t==="keepSnaps";return n.length===1?[i]:m?h:h.slice(c,u).map((p,y,v)=>{const g=!y,x=qe(v,y);if(g){const b=Z(v[0])+1;return Mn(b)}if(x){const b=ne(i)-Z(v)[0]+1;return Mn(b,Z(v)[0])}return p})}return{slideRegistry:l}}function xo(e,t,n,r,s){const{reachedAny:i,removeOffset:o,constrain:c}=r;function u(p){return p.concat().sort((y,v)=>L(y)-L(v))[0]}function l(p){const y=e?o(p):c(p),v=t.map((x,b)=>({diff:d(x-y,0),index:b})).sort((x,b)=>L(x.diff)-L(b.diff)),{index:g}=v[0];return{index:g,distance:y}}function d(p,y){const v=[p,p+n,p-n];if(!e)return p;if(!y)return u(v);const g=v.filter(x=>Xe(x)===y);return g.length?u(g):Z(v)-n}function f(p,y){const v=t[p]-s.get(),g=d(v,y);return{index:p,distance:g}}function h(p,y){const v=s.get()+p,{index:g,distance:x}=l(v),b=!e&&i(v);if(!y||b)return{index:g,distance:p};const j=t[g]-x,S=p+d(j,0);return{index:g,distance:S}}return{byDistance:h,byIndex:f,shortcut:d}}function vo(e,t,n,r,s,i,o){function c(f){const h=f.distance,m=f.index!==t.get();i.add(h),h&&(r.duration()?e.start():(e.update(),e.render(1),e.update())),m&&(n.set(t.get()),t.set(f.index),o.emit("select"))}function u(f,h){const m=s.byDistance(f,h);c(m)}function l(f,h){const m=t.clone().set(f),p=s.byIndex(m.get(),h);c(p)}return{distance:u,index:l}}function bo(e,t,n,r,s,i,o,c){const u={passive:!0,capture:!0};let l=0;function d(m){if(!c)return;function p(y){if(new Date().getTime()-l>10)return;o.emit("slideFocusStart"),e.scrollLeft=0;const x=n.findIndex(b=>b.includes(y));Ge(x)&&(s.useDuration(0),r.index(x,0),o.emit("slideFocus"))}i.add(document,"keydown",f,!1),t.forEach((y,v)=>{i.add(y,"focus",g=>{(Pe(c)||c(m,g))&&p(v)},u)})}function f(m){m.code==="Tab"&&(l=new Date().getTime())}return{init:d}}function Yt(e){let t=e;function n(){return t}function r(u){t=o(u)}function s(u){t+=o(u)}function i(u){t-=o(u)}function o(u){return Ge(u)?u:u.get()}return{get:n,set:r,add:s,subtract:i}}function pr(e,t){const n=e.scroll==="x"?o:c,r=t.style;let s=null,i=!1;function o(h){return`translate3d(${h}px,0px,0px)`}function c(h){return`translate3d(0px,${h}px,0px)`}function u(h){if(i)return;const m=to(e.direction(h));m!==s&&(r.transform=n(m),s=m)}function l(h){i=!h}function d(){i||(r.transform="",t.getAttribute("style")||t.removeAttribute("style"))}return{clear:d,to:u,toggleActive:l}}function _o(e,t,n,r,s,i,o,c,u){const d=Jt(s),f=Jt(s).reverse(),h=g().concat(x());function m(_,A){return _.reduce((k,P)=>k-s[P],A)}function p(_,A){return _.reduce((k,P)=>m(k,A)>0?k.concat([P]):k,[])}function y(_){return i.map((A,k)=>({start:A-r[k]+.5+_,end:A+t-.5+_}))}function v(_,A,k){const P=y(A);return _.map(O=>{const N=k?0:-n,K=k?n:0,U=k?"end":"start",W=P[O][U];return{index:O,loopPoint:W,slideLocation:Yt(-1),translate:pr(e,u[O]),target:()=>c.get()>W?N:K}})}function g(){const _=o[0],A=p(f,_);return v(A,n,!1)}function x(){const _=t-o[0]-1,A=p(d,_);return v(A,-n,!0)}function b(){return h.every(({index:_})=>{const A=d.filter(k=>k!==_);return m(A,t)<=.1})}function j(){h.forEach(_=>{const{target:A,translate:k,slideLocation:P}=_,O=A();O!==P.get()&&(k.to(O),P.set(O))})}function S(){h.forEach(_=>_.translate.clear())}return{canLoop:b,clear:S,loop:j,loopPoints:h}}function jo(e,t,n){let r,s=!1;function i(u){if(!n)return;function l(d){for(const f of d)if(f.type==="childList"){u.reInit(),t.emit("slidesChanged");break}}r=new MutationObserver(d=>{s||(Pe(n)||n(u,d))&&l(d)}),r.observe(e,{childList:!0})}function o(){r&&r.disconnect(),s=!0}return{init:i,destroy:o}}function wo(e,t,n,r){const s={};let i=null,o=null,c,u=!1;function l(){c=new IntersectionObserver(p=>{u||(p.forEach(y=>{const v=t.indexOf(y.target);s[v]=y}),i=null,o=null,n.emit("slidesInView"))},{root:e.parentElement,threshold:r}),t.forEach(p=>c.observe(p))}function d(){c&&c.disconnect(),u=!0}function f(p){return Qt(s).reduce((y,v)=>{const g=parseInt(v),{isIntersecting:x}=s[g];return(p&&x||!p&&!x)&&y.push(g),y},[])}function h(p=!0){if(p&&i)return i;if(!p&&o)return o;const y=f(p);return p&&(i=y),p||(o=y),y}return{init:l,destroy:d,get:h}}function So(e,t,n,r,s,i){const{measureSize:o,startEdge:c,endEdge:u}=e,l=n[0]&&s,d=p(),f=y(),h=n.map(o),m=v();function p(){if(!l)return 0;const x=n[0];return L(t[c]-x[c])}function y(){if(!l)return 0;const x=i.getComputedStyle(Z(r));return parseFloat(x.getPropertyValue(`margin-${u}`))}function v(){return n.map((x,b,j)=>{const S=!b,w=qe(j,b);return S?h[b]+d:w?h[b]+f:j[b+1][c]-x[c]}).map(L)}return{slideSizes:h,slideSizesWithGaps:m,startGap:d,endGap:f}}function Ao(e,t,n,r,s,i,o,c,u){const{startEdge:l,endEdge:d,direction:f}=e,h=Ge(n);function m(g,x){return Jt(g).filter(b=>b%x===0).map(b=>g.slice(b,b+x))}function p(g){return g.length?Jt(g).reduce((x,b,j)=>{const S=Z(x)||0,w=S===0,_=b===ne(g),A=s[l]-i[S][l],k=s[l]-i[b][d],P=!r&&w?f(o):0,O=!r&&_?f(c):0,N=L(k-O-(A+P));return j&&N>t+u&&x.push(b),_&&x.push(g.length),x},[]).map((x,b,j)=>{const S=Math.max(j[b-1]||0);return g.slice(S,x)}):[]}function y(g){return h?m(g,n):p(g)}return{groupSlides:y}}function Eo(e,t,n,r,s,i,o){const{align:c,axis:u,direction:l,startIndex:d,loop:f,duration:h,dragFree:m,dragThreshold:p,inViewThreshold:y,slidesToScroll:v,skipSnaps:g,containScroll:x,watchResize:b,watchSlides:j,watchDrag:S,watchFocus:w}=i,_=2,A=oo(),k=A.measure(t),P=n.map(A.measure),O=ro(u,l),N=O.measureSize(k),K=ao(N),U=eo(c,N),W=!f&&!!x,X=f||!!x,{slideSizes:ht,slideSizesWithGaps:at,startGap:ct,endGap:Kt}=So(O,k,P,n,X,s),tt=Ao(O,N,v,f,k,P,ct,Kt,_),{snaps:At,snapsAligned:Et}=go(O,U,k,P,tt),lt=-Z(At)+Z(at),{snapsContained:Rt,scrollContainLimit:Vt}=fo(N,lt,Et,x,_),G=W?Rt:Et,{limit:R}=ho(lt,G,f),ut=hr(ne(G),d,f),q=ut.clone(),M=Jt(n),E=({dragHandler:kt,scrollBody:Ce,scrollBounds:Ie,options:{loop:re}})=>{re||Ie.constrain(kt.pointerDown()),Ce.seek()},I=({scrollBody:kt,translate:Ce,location:Ie,offsetLocation:re,previousLocation:yr,scrollLooper:xr,slideLooper:vr,dragHandler:br,animation:_r,eventHandler:en,scrollBounds:jr,options:{loop:nn}},rn)=>{const sn=kt.settled(),wr=!jr.shouldConstrain(),on=nn?sn:sn&&wr,an=on&&!br.pointerDown();an&&_r.stop();const Sr=Ie.get()*rn+yr.get()*(1-rn);re.set(Sr),nn&&(xr.loop(kt.direction()),vr.loop()),Ce.to(re.get()),an&&en.emit("settle"),on||en.emit("scroll")},$=no(r,s,()=>E(Ne),kt=>I(Ne,kt)),V=.68,et=G[ut.get()],dt=Yt(et),vt=Yt(et),pt=Yt(et),bt=Yt(et),Ht=lo(dt,pt,vt,bt,h,V),Oe=xo(f,G,lt,R,bt),Te=vo($,ut,q,Ht,Oe,bt,o),Qe=mo(R),Ze=Zt(),mr=wo(t,n,o,y),{slideRegistry:tn}=yo(W,x,G,Vt,tt,M),gr=bo(e,n,tn,Te,Ht,Ze,o,w),Ne={ownerDocument:r,ownerWindow:s,eventHandler:o,containerRect:k,slideRects:P,animation:$,axis:O,dragHandler:so(O,e,r,s,bt,io(O,s),dt,$,Te,Ht,Oe,ut,o,K,m,p,g,V,S),eventStore:Ze,percentOfView:K,index:ut,indexPrevious:q,limit:R,location:dt,offsetLocation:pt,previousLocation:vt,options:i,resizeHandler:co(t,o,s,n,O,b,A),scrollBody:Ht,scrollBounds:uo(R,pt,bt,Ht,K),scrollLooper:po(lt,R,pt,[dt,pt,vt,bt]),scrollProgress:Qe,scrollSnapList:G.map(Qe.get),scrollSnaps:G,scrollTarget:Oe,scrollTo:Te,slideLooper:_o(O,N,lt,ht,at,At,G,pt,n),slideFocus:gr,slidesHandler:jo(t,o,j),slidesInView:mr,slideIndexes:M,slideRegistry:tn,slidesToScroll:tt,target:bt,translate:pr(O,t)};return Ne}function ko(){let e={},t;function n(l){t=l}function r(l){return e[l]||[]}function s(l){return r(l).forEach(d=>d(t,l)),u}function i(l,d){return e[l]=r(l).concat([d]),u}function o(l,d){return e[l]=r(l).filter(f=>f!==d),u}function c(){e={}}const u={init:n,emit:s,off:o,on:i,clear:c};return u}const Po={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function Oo(e){function t(i,o){return fr(i,o||{})}function n(i){const o=i.breakpoints||{},c=Qt(o).filter(u=>e.matchMedia(u).matches).map(u=>o[u]).reduce((u,l)=>t(u,l),{});return t(i,c)}function r(i){return i.map(o=>Qt(o.breakpoints||{})).reduce((o,c)=>o.concat(c),[]).map(e.matchMedia)}return{mergeOptions:t,optionsAtMedia:n,optionsMediaQueries:r}}function To(e){let t=[];function n(i,o){return t=o.filter(({options:c})=>e.optionsAtMedia(c).active!==!1),t.forEach(c=>c.init(i,e)),o.reduce((c,u)=>Object.assign(c,{[u.name]:u}),{})}function r(){t=t.filter(i=>i.destroy())}return{init:n,destroy:r}}function _e(e,t,n){const r=e.ownerDocument,s=r.defaultView,i=Oo(s),o=To(i),c=Zt(),u=ko(),{mergeOptions:l,optionsAtMedia:d,optionsMediaQueries:f}=i,{on:h,off:m,emit:p}=u,y=O;let v=!1,g,x=l(Po,_e.globalOptions),b=l(x),j=[],S,w,_;function A(){const{container:M,slides:E}=b;w=(Re(M)?e.querySelector(M):M)||e.children[0];const $=Re(E)?w.querySelectorAll(E):E;_=[].slice.call($||w.children)}function k(M){const E=Eo(e,w,_,r,s,M,u);if(M.loop&&!E.slideLooper.canLoop()){const I=Object.assign({},M,{loop:!1});return k(I)}return E}function P(M,E){v||(x=l(x,M),b=d(x),j=E||j,A(),g=k(b),f([x,...j.map(({options:I})=>I)]).forEach(I=>c.add(I,"change",O)),b.active&&(g.translate.to(g.location.get()),g.animation.init(),g.slidesInView.init(),g.slideFocus.init(q),g.eventHandler.init(q),g.resizeHandler.init(q),g.slidesHandler.init(q),g.options.loop&&g.slideLooper.loop(),w.offsetParent&&_.length&&g.dragHandler.init(q),S=o.init(q,j)))}function O(M,E){const I=tt();N(),P(l({startIndex:I},M),E),u.emit("reInit")}function N(){g.dragHandler.destroy(),g.eventStore.clear(),g.translate.clear(),g.slideLooper.clear(),g.resizeHandler.destroy(),g.slidesHandler.destroy(),g.slidesInView.destroy(),g.animation.destroy(),o.destroy(),c.clear()}function K(){v||(v=!0,c.clear(),N(),u.emit("destroy"),u.clear())}function U(M,E,I){!b.active||v||(g.scrollBody.useBaseFriction().useDuration(E===!0?0:b.duration),g.scrollTo.index(M,I||0))}function W(M){const E=g.index.add(1).get();U(E,M,-1)}function X(M){const E=g.index.add(-1).get();U(E,M,1)}function ht(){return g.index.add(1).get()!==tt()}function at(){return g.index.add(-1).get()!==tt()}function ct(){return g.scrollSnapList}function Kt(){return g.scrollProgress.get(g.offsetLocation.get())}function tt(){return g.index.get()}function At(){return g.indexPrevious.get()}function Et(){return g.slidesInView.get()}function lt(){return g.slidesInView.get(!1)}function Rt(){return S}function Vt(){return g}function G(){return e}function R(){return w}function ut(){return _}const q={canScrollNext:ht,canScrollPrev:at,containerNode:R,internalEngine:Vt,destroy:K,off:m,on:h,emit:p,plugins:Rt,previousScrollSnap:At,reInit:y,rootNode:G,scrollNext:W,scrollPrev:X,scrollProgress:Kt,scrollSnapList:ct,scrollTo:U,selectedScrollSnap:tt,slideNodes:ut,slidesInView:Et,slidesNotInView:lt};return P(t,n),setTimeout(()=>u.emit("init"),0),q}_e.globalOptions=void 0;function Je(e={},t=[]){const n=C.useRef(e),r=C.useRef(t),[s,i]=C.useState(),[o,c]=C.useState(),u=C.useCallback(()=>{s&&s.reInit(n.current,r.current)},[s]);return C.useEffect(()=>{We(n.current,e)||(n.current=e,u())},[e,u]),C.useEffect(()=>{Qi(r.current,t)||(r.current=t,u())},[t,u]),C.useEffect(()=>{if(Ji()&&o){_e.globalOptions=Je.globalOptions;const l=_e(o,n.current,r.current);return i(l),()=>l.destroy()}else i(void 0)},[o,i]),[c,s]}Je.globalOptions=void 0;const No={spike:"⚠️",trend:"📈",unusual:"📊",budget:"💰",saving:"🎉"},Ln={warning:"border-l-amber-500 bg-amber-50 dark:bg-amber-900/20",success:"border-l-green-500 bg-green-50 dark:bg-green-900/20",info:"border-l-blue-500 bg-blue-50 dark:bg-blue-900/20"};function Co({insight:e,displayCurrency:t="JPY",onScrollToChart:n}){const{t:r}=Y("common"),s=Tr(),i=()=>{e.category?s({to:"/transactions",search:{categories:e.category}}):(e.type==="trend"||e.type==="unusual")&&(n==null||n())},o=()=>e.category?r("analytics.viewTransactions",{category:e.category}):e.type==="trend"||e.type==="unusual"?r("analytics.viewBreakdown"):r("analytics.learnMore");return a.jsx("div",{className:z("rounded-xl p-4 border-l-4 min-w-0","bg-white dark:bg-gray-800","shadow-sm",Ln[e.severity]||Ln.info),children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"text-2xl flex-shrink-0",children:No[e.type]||"💡"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-semibold text-gray-900 dark:text-gray-100 truncate",children:e.title}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.message}),e.amount&&a.jsxs("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mt-1",children:[H(e.amount,t),e.percentage_change&&a.jsxs("span",{className:z("ml-2",e.percentage_change>0?"text-red-600":"text-green-600"),children:[e.percentage_change>0?"+":"",e.percentage_change,"%"]})]}),a.jsxs(nt,{variant:"ghost",className:"mt-2 p-0 h-auto text-sm text-primary-600 hover:text-primary-700",onClick:i,children:[o()," →"]})]})]})})}function Io({insights:e,displayCurrency:t="JPY",onScrollToChart:n}){const{t:r}=Y("common"),[s,i]=C.useState(0),[o,c]=Je({loop:!1,align:"start",containScroll:"trimSnaps"}),u=C.useCallback(()=>{c&&i(c.selectedScrollSnap())},[c]);return C.useEffect(()=>{if(c)return u(),c.on("select",u),()=>{c.off("select",u)}},[c,u]),!e||e.length===0?null:a.jsxs("div",{className:"relative",children:[e.length>1&&a.jsx("p",{className:"text-xs text-gray-400 text-center mb-2",children:r("analytics.swipeHint")}),a.jsx("div",{className:"overflow-hidden",ref:o,children:a.jsx("div",{className:"flex gap-3",children:e.map((l,d)=>a.jsx("div",{className:"flex-shrink-0 w-full min-w-0",children:a.jsx(Co,{insight:l,displayCurrency:t,onScrollToChart:n})},`${l.type}-${l.category||d}`))})}),e.length>1&&a.jsx("div",{className:"flex justify-center gap-1.5 mt-3",children:e.map((l,d)=>a.jsx("button",{"aria-label":`Go to insight ${d+1}`,className:z("w-2 h-2 rounded-full transition-all",d===s?"bg-primary-600 w-4":"bg-gray-300 dark:bg-gray-600"),onClick:()=>c==null?void 0:c.scrollTo(d)},d))})]})}function Do({selectedMonth:e,onChange:t,className:n}){const{i18n:r}=Y(),s=u=>{const l=r.language;return l==="ja"?gt(u,"yyyy年M月"):l==="vi"?`Tháng ${gt(u,"M/yyyy")}`:gt(u,"MMMM yyyy")},i=()=>{t(de(e,1))},o=()=>{const u=un(e,1);u<=new Date&&t(u)},c=un(e,1)>new Date;return a.jsxs("div",{className:z("flex items-center gap-2",n),children:[a.jsx("button",{onClick:i,className:z("p-2 rounded-lg text-gray-600 dark:text-gray-400","hover:bg-gray-100 dark:hover:bg-gray-700","transition-colors"),"aria-label":"Previous month",children:"←"}),a.jsx("span",{className:"min-w-[140px] text-center font-medium text-gray-900 dark:text-gray-100",children:s(e)}),a.jsx("button",{onClick:o,disabled:c,className:z("p-2 rounded-lg text-gray-600 dark:text-gray-400","hover:bg-gray-100 dark:hover:bg-gray-700","transition-colors",c&&"opacity-50 cursor-not-allowed"),"aria-label":"Next month",children:"→"})]})}const Mo=[{value:"current-month",labelKey:"analytics.currentMonth"},{value:"3-months",labelKey:"analytics.3months"},{value:"6-months",labelKey:"analytics.6months"},{value:"1-year",labelKey:"analytics.1year"}];function Lo({selected:e,onChange:t,className:n}){const{t:r}=Y("common");return a.jsx("div",{className:z("inline-flex rounded-lg bg-gray-100 dark:bg-gray-800 p-1",n),children:Mo.map(({value:s,labelKey:i})=>a.jsx("button",{onClick:()=>t(s),className:z("px-3 py-1.5 text-sm font-medium rounded-md transition-all",s===e?"bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"),children:r(i)},s))})}function Bo(e,t){const n=Nr(t),r=gt(n>new Date?new Date:n,"yyyy-MM-dd");switch(e){case"current-month":return{start:gt(se(t),"yyyy-MM-dd"),end:r};case"3-months":return{start:gt(de(se(t),2),"yyyy-MM-dd"),end:r};case"6-months":return{start:gt(de(se(t),5),"yyyy-MM-dd"),end:r};case"1-year":return{start:gt(de(se(t),11),"yyyy-MM-dd"),end:r};default:return Cr()}}function $o(){const{t:e}=Y("common"),t=C.useRef(null),[n,r]=C.useState(new Date),[s,i]=C.useState("current-month"),[o,c]=C.useState(!1),u=Bo(s,n),{data:l,isLoading:d}=ue({queryKey:["analytics",u],queryFn:()=>Ir(u)}),{data:f}=ue({queryKey:["insights"],queryFn:Bn}),{data:h}=ue({queryKey:["goals"],queryFn:Dr}),m=h&&h.length>0?Math.round(h[0].target_amount/(h[0].years*12)):null,p=g=>{i(g)},y=g=>{r(g)},v=C.useCallback(()=>{var g;(g=t.current)==null||g.scrollIntoView({behavior:"smooth"})},[]);return a.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-6 sm:py-8",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100",children:e("analytics.title")}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:e("analytics.subtitle")})]}),a.jsxs("div",{className:"mb-6 space-y-3",children:[a.jsx(Do,{selectedMonth:n,onChange:y,className:"justify-center"}),a.jsx("div",{className:"flex justify-center",children:a.jsx(Lo,{selected:s,onChange:p})})]}),d?a.jsx("div",{className:"flex justify-center py-12",children:a.jsx(pe,{size:"lg"})}):a.jsxs("div",{className:"space-y-6",children:[l&&a.jsx(Xi,{analytics:l}),(f==null?void 0:f.insights)&&f.insights.length>0&&a.jsx(Io,{insights:f.insights,onScrollToChart:v}),a.jsxs("div",{ref:t,className:"space-y-6",children:[a.jsxs(it,{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:e("analytics.incomeVsExpense")}),a.jsx(Me,{className:"h-64 sm:h-80",children:l!=null&&l.monthly_trends&&l.monthly_trends.length>0?a.jsx(ws,{data:l.monthly_trends}):a.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:e("analytics.noData")})})]}),a.jsxs(it,{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:e("analytics.categoryBreakdown")}),a.jsx(Me,{className:"h-64 sm:h-80",children:l!=null&&l.category_breakdown&&l.category_breakdown.length>0?a.jsx(As,{data:l.category_breakdown}):a.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:e("analytics.noData")})})]}),a.jsxs(it,{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:e("analytics.monthlyCashFlow")}),a.jsx("div",{className:"h-64 sm:h-80",children:l!=null&&l.monthly_trends&&l.monthly_trends.length>0?l.monthly_trends.length<3?a.jsx(ks,{data:l.monthly_trends,savingsGoal:m}):a.jsx(Me,{className:"h-full",children:a.jsx(Es,{data:l.monthly_trends,dataKey:"net"})}):a.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:e("analytics.noData")})})]})]}),a.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-xl overflow-hidden",children:[a.jsxs("button",{onClick:()=>c(!o),className:z("w-full px-4 py-3 flex items-center justify-between","bg-gray-50 dark:bg-gray-800","text-left font-medium text-gray-900 dark:text-gray-100"),children:[a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx("span",{children:"🤖"}),e("analytics.aiTools")]}),a.jsx("span",{className:z("transform transition-transform",o?"rotate-180":""),children:"▼"})]}),o&&a.jsxs("div",{className:"p-4 space-y-4 bg-white dark:bg-gray-900",children:[a.jsx(Gi,{}),a.jsx(Yi,{})]})]})]})]})}const Ho=Mr("/analytics")({component:$o});export{Ho as Route};

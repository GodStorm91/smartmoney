import{j as e,e as ct}from"./vendor-router-DONIM_LE.js";import{r as b,a as Ne,R as A}from"./vendor-react-Cwh1aMWO.js";import{b as oe,u as Z,c as D}from"./vendor-query-B0NEAgzV.js";import{i as ce,x as T,C as H,v as Q,B as P,P as dt,j,T as Oe,f as ie,X as ze,a7 as Ce,I as B,a8 as ut,a9 as xe,aa as gt,ab as Be,R as mt,ac as Ue,ad as xt,ae as ht,af as pt,ag as Ke,ah as yt,ai as we,aj as Se,t as te,ak as bt,G as ft,al as vt,am as kt}from"./index-8QQOl6s4.js";import{C as Ee,c as jt,d as Nt,s as Ct,a as wt,b as St,e as J,f as Et,g as _t,R as Mt}from"./crypto-DmJ5gCGB.js";import{S as me}from"./Select-VOr_uKjK.js";import{P as Rt,R as Pt}from"./RecurringTransactionsList-BAPUeFV8.js";import{u as K}from"./vendor-i18n-CNDlYvyf.js";import{T as ve}from"./tag-WPaal5cj.js";import{u as At,a as Tt,b as It,c as Lt}from"./useCategories-CcWulFHo.js";import{P as Dt}from"./pencil-BmgcPZfM.js";import{S as Ft}from"./Switch-Du0tPjWK.js";import{M as Ot}from"./mail-CjZANIxp.js";import{C as zt}from"./crown-RAnA9Pxz.js";import{Z as Bt,C as Ut}from"./zap-CvGhK5pC.js";import{M as Kt}from"./map-pin-CpjHPoPC.js";import{u as qt,g as Qt}from"./benchmark-service-C-mfJvVq.js";import{D as Te}from"./download-BM16G5XZ.js";import"./vendor-charts-BwEA5mzu.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],$t=ce("link-2",Ht);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],Gt=ce("monitor",Wt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],qe=ce("palette",Vt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Xt=ce("save",Yt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],_e=ce("smartphone",Jt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],ea=ce("wand-sparkles",Zt);async function ta(){return(await T.get("/api/category-rules/")).data.rules}async function aa(t){return(await T.post("/api/category-rules/",t)).data}async function sa(t){await T.delete(`/api/category-rules/${t}`)}async function ra(t=!0){return(await T.post("/api/category-rules/apply",{dry_run:t})).data}async function na(){return(await T.get("/api/category-rules/suggest")).data.suggestions}async function ia(){return(await T.post("/api/category-rules/seed-defaults")).data}const la={contains:"categoryRules.contains",starts_with:"categoryRules.startsWith",exact:"categoryRules.exact"},oa=["Food","Shopping","Transportation","Utilities","Entertainment","Healthcare","Education","Groceries","Dining","Cafe","Convenience","Transfer","Investment","Clothing","Other"];function ca(){const{t}=K("common"),c=oe(),[i,d]=b.useState(null),[g,u]=b.useState(!1),[p,y]=b.useState(!1),[a,r]=b.useState(null),[s,o]=b.useState(""),[n,x]=b.useState("Other"),[l,h]=b.useState("contains"),{data:m,isLoading:E}=Z({queryKey:["category-rules"],queryFn:ta}),{data:N,isLoading:f}=Z({queryKey:["category-rules-suggestions"],queryFn:na,enabled:p}),C=D({mutationFn:sa,onSuccess:()=>{c.invalidateQueries({queryKey:["category-rules"]}),d(null)}}),_=D({mutationFn:aa,onSuccess:()=>{c.invalidateQueries({queryKey:["category-rules"]}),o(""),x("Other"),h("contains"),u(!1)}}),I=D({mutationFn:ia,onSuccess:()=>{c.invalidateQueries({queryKey:["category-rules"]})}}),F=D({mutationFn:k=>ra(k),onSuccess:(k,$)=>{$?r({count:k.affected_count,applied:!1}):(c.invalidateQueries({queryKey:["transactions"]}),c.invalidateQueries({queryKey:["analytics"]}),r({count:k.affected_count,applied:!0}))}}),O=k=>{confirm(t("confirmDelete"))&&(d(k),C.mutate(k))},q=()=>{s.trim()&&_.mutate({keyword:s.trim(),category:n,match_type:l,priority:10})},U=k=>{_.mutate({keyword:k.keyword,category:k.suggested_category,match_type:"contains",priority:10})};return E?e.jsxs(H,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-5 h-5 text-purple-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("categoryRules.title")})]}),e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(Q,{size:"md"})})]}):e.jsxs(Ee,{title:t("categoryRules.title"),badge:(m==null?void 0:m.length)||0,children:[e.jsxs("div",{className:"flex items-center justify-end gap-2 mb-4",children:[(!m||m.length===0)&&e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>I.mutate(),disabled:I.isPending,children:[e.jsx(ea,{className:"w-4 h-4 mr-1"}),I.isPending?t("loading"):t("categoryRules.seedDefaults")]}),e.jsxs(P,{variant:"outline",size:"sm",onClick:()=>u(!g),children:[e.jsx(dt,{className:"w-4 h-4 mr-1"}),t("categoryRules.addRule")]})]}),g&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsx("input",{type:"text",placeholder:t("categoryRules.keyword"),value:s,onChange:k=>o(k.target.value),className:j("h-10 px-3 border rounded-lg text-sm","bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100","border-gray-300")}),e.jsx("select",{value:n,onChange:k=>x(k.target.value),className:j("h-10 px-3 border rounded-lg text-sm","bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100","border-gray-300"),children:oa.map(k=>e.jsx("option",{value:k,children:k},k))}),e.jsxs("select",{value:l,onChange:k=>h(k.target.value),className:j("h-10 px-3 border rounded-lg text-sm","bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100","border-gray-300"),children:[e.jsx("option",{value:"contains",children:t("categoryRules.contains")}),e.jsx("option",{value:"starts_with",children:t("categoryRules.startsWith")}),e.jsx("option",{value:"exact",children:t("categoryRules.exact")})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>u(!1),children:t("cancel")}),e.jsx(P,{size:"sm",onClick:q,disabled:!s.trim()||_.isPending,children:_.isPending?t("saving"):t("save")})]})]}),m&&m.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2 mb-6",children:m.map(k=>e.jsxs("div",{className:j("flex items-center justify-between p-3 rounded-lg border",k.is_active?"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700":"bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-800 opacity-60"),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("code",{className:"px-2 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded text-sm truncate max-w-[150px]",children:k.keyword}),e.jsx("span",{className:"text-gray-400",children:"â†’"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100 font-medium",children:k.category}),e.jsxs("span",{className:"text-xs text-gray-400 dark:text-gray-500 hidden sm:inline",children:["(",t(la[k.match_type]),")"]})]}),e.jsx("button",{onClick:()=>O(k.id),disabled:i===k.id,className:"p-2 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/30 text-red-600 transition-colors",children:i===k.id?e.jsx(Q,{size:"sm"}):e.jsx(Oe,{className:"w-4 h-4"})})]},k.id))}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("categoryRules.applyDescription")}),a&&e.jsx("p",{className:j("text-sm mt-1",a.applied?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"),children:a.applied?t("categoryRules.appliedCount",{count:a.count}):t("categoryRules.previewCount",{count:a.count})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>F.mutate(!0),disabled:F.isPending,children:F.isPending?t("loading"):t("categoryRules.preview")}),e.jsxs(P,{size:"sm",onClick:()=>F.mutate(!1),disabled:F.isPending||(a==null?void 0:a.count)===0,children:[e.jsx(Rt,{className:"w-4 h-4 mr-1"}),t("categoryRules.applyNow")]})]})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ve,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t("categoryRules.noRules")}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:t("categoryRules.noRulesDescription")})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[e.jsx("button",{onClick:()=>y(!p),className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:t(p?"categoryRules.hideSuggestions":"categoryRules.showSuggestions")}),p&&e.jsx("div",{className:"mt-4 space-y-2",children:f?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx(Q,{size:"sm"})}):N&&N.length>0?N.map((k,$)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("code",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded text-sm truncate max-w-[150px]",children:k.keyword}),e.jsx("span",{className:"text-gray-400",children:"â†’"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:k.suggested_category}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",k.count,"x)"]})]}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>U(k),disabled:_.isPending,children:e.jsx(ie,{className:"w-4 h-4"})})]},$)):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:t("categoryRules.noSuggestions")})})]})]})}const da=["ðŸ“","ðŸ ","ðŸ½ï¸","ðŸš—","ðŸ’¡","ðŸ“±","ðŸŽ¬","ðŸ›ï¸","ðŸ¥","ðŸ“¦","ðŸ’°","ðŸŽ","ðŸ“ˆ","ðŸ’¼","ðŸ”„","âœˆï¸","ðŸŽ“","ðŸ’³","ðŸ¦","ðŸŽ®","â˜•","ðŸ•","ðŸšŒ","â›½","ðŸ’Š","ðŸ‹ï¸","ðŸ•","ðŸ‘¶","ðŸ’…","ðŸ“š"];function ua({isOpen:t,onClose:c,defaultType:i="expense",onCreated:d}){const{t:g}=K("common"),u=At(),[p,y]=b.useState(""),[a,r]=b.useState("ðŸ“"),[s,o]=b.useState(i),[n,x]=b.useState(""),l=async E=>{var f,C;E.preventDefault(),x("");const N=p.trim();if(!N){x(g("category.errors.nameRequired","Name is required"));return}try{const I=`custom_${(await u.mutateAsync({name:N,icon:a,type:s})).id}`;d==null||d(I),h()}catch(_){x(((C=(f=_.response)==null?void 0:f.data)==null?void 0:C.detail)||g("category.errors.createFailed","Failed to create category"))}},h=()=>{y(""),r("ðŸ“"),o(i),x(""),c()};if(!t)return null;const m=e.jsxs("div",{className:"fixed inset-0 z-[100001] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:h}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:g("category.createTitle","Create Category")}),e.jsx("button",{onClick:h,className:"p-2.5 -mr-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(ze,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:g("category.name","Category Name")}),e.jsx("input",{type:"text",value:p,onChange:E=>y(E.target.value),placeholder:g("category.namePlaceholder","e.g., Subscriptions"),maxLength:50,className:"w-full h-10 px-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-gray-100",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:g("category.icon","Icon")}),e.jsx("div",{className:"grid grid-cols-10 gap-1",children:da.map(E=>e.jsx("button",{type:"button",onClick:()=>r(E),className:j("w-8 h-8 text-lg rounded flex items-center justify-center",a===E?"bg-primary-100 dark:bg-primary-900 border-2 border-primary-500":"bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"),children:E},E))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:g("category.type","Type")}),e.jsxs("div",{className:"flex rounded-lg bg-gray-100 dark:bg-gray-700 p-1",children:[e.jsx("button",{type:"button",onClick:()=>o("expense"),className:j("flex-1 py-2 rounded-md text-sm font-medium transition-colors",s==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-gray-300"),children:g("transaction.expense","Expense")}),e.jsx("button",{type:"button",onClick:()=>o("income"),className:j("flex-1 py-2 rounded-md text-sm font-medium transition-colors",s==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-gray-300"),children:g("transaction.income","Income")})]})]}),n&&e.jsx("p",{className:"text-sm text-red-500",children:n}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:h,className:"flex-1 h-10 border border-gray-300 dark:border-gray-600 rounded-lg font-medium text-gray-700 dark:text-gray-300",children:g("cancel","Cancel")}),e.jsx("button",{type:"submit",disabled:u.isPending,className:"flex-1 h-10 bg-blue-500 text-white rounded-lg font-medium disabled:opacity-50",children:u.isPending?"...":g("create","Create")})]})]})]})]});return typeof document>"u"?null:Ne.createPortal(m,document.body)}const ga=["ðŸ“","ðŸ ","ðŸ½ï¸","ðŸš—","ðŸ’¡","ðŸ“±","ðŸŽ¬","ðŸ›ï¸","ðŸ¥","ðŸ“¦","ðŸ’°","ðŸŽ","ðŸ“ˆ","ðŸ’¼","ðŸ”„","âœˆï¸","ðŸŽ“","ðŸ’³","ðŸ¦","ðŸŽ®","â˜•","ðŸ•","ðŸšŒ","â›½","ðŸ’Š","ðŸ‹ï¸","ðŸ•","ðŸ‘¶","ðŸ’…","ðŸ“š"];function ma({isOpen:t,onClose:c,category:i}){const{t:d}=K("common"),g=oe(),[u,p]=b.useState(""),[y,a]=b.useState("ðŸ“"),[r,s]=b.useState(""),[o,n]=b.useState(null);b.useEffect(()=>{i&&(p(i.name),a(i.icon),s(""),n(null))},[i]);const x=D({mutationFn:N=>Tt(i.id,N),onSuccess:N=>{n(N.affected_transactions),g.invalidateQueries({queryKey:["categories"]}),g.invalidateQueries({queryKey:["transactions"]}),setTimeout(()=>{h()},1500)},onError:N=>{var C,_;s(((_=(C=N.response)==null?void 0:C.data)==null?void 0:_.detail)||d("category.errors.updateFailed","Failed to update category"))}}),l=async N=>{N.preventDefault(),s("");const f=u.trim();if(!f){s(d("category.errors.nameRequired","Name is required"));return}const C={};if(f!==(i==null?void 0:i.name)&&(C.name=f),y!==(i==null?void 0:i.icon)&&(C.icon=y),Object.keys(C).length===0){h();return}x.mutate(C)},h=()=>{p(""),a("ðŸ“"),s(""),n(null),c()};if(!t||!i)return null;const m=u.trim()!==i.name,E=e.jsxs("div",{className:"fixed inset-0 z-[100001] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:h}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:d("category.editTitle","Edit Category")}),e.jsx("button",{onClick:h,className:"p-2.5 -mr-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(ze,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),o!==null&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-800 dark:text-green-200",children:[d("category.updateSuccess","Category updated!"),o>0&&e.jsx("span",{className:"block mt-1 text-green-600 dark:text-green-300",children:d("category.transactionsUpdated","{{count}} transactions updated",{count:o})})]})}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("category.name","Category Name")}),e.jsx("input",{type:"text",value:u,onChange:N=>p(N.target.value),placeholder:d("category.namePlaceholder","e.g., Subscriptions"),maxLength:50,className:"w-full h-10 px-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-gray-100",autoFocus:!0})]}),m&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-800 rounded-lg",children:[e.jsx(Ce,{className:"w-4 h-4 text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:d("category.cascadeWarning","All transactions with this category will be updated to the new name.")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("category.icon","Icon")}),e.jsx("div",{className:"grid grid-cols-10 gap-1",children:ga.map(N=>e.jsx("button",{type:"button",onClick:()=>a(N),className:j("w-8 h-8 text-lg rounded flex items-center justify-center",y===N?"bg-primary-100 dark:bg-primary-900 border-2 border-primary-500":"bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"),children:N},N))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("category.type","Type")}),e.jsx("div",{className:j("h-10 px-3 flex items-center rounded-lg text-sm font-medium",i.type==="expense"?"bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-300":"bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300"),children:i.type==="expense"?d("transaction.expense","Expense"):d("transaction.income","Income")})]}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:h,className:"flex-1 h-10 border border-gray-300 dark:border-gray-600 rounded-lg font-medium text-gray-700 dark:text-gray-300",children:d("cancel","Cancel")}),e.jsx("button",{type:"submit",disabled:x.isPending||o!==null,className:"flex-1 h-10 bg-blue-500 text-white rounded-lg font-medium disabled:opacity-50",children:x.isPending?"...":d("save","Save")})]})]})]})]});return typeof document>"u"?null:Ne.createPortal(E,document.body)}function xa(){const{t}=K("common"),{data:c,isLoading:i}=It(),d=Lt(),g=b.useMemo(()=>{if(!c)return[];const l=[];for(const h of c.expense??[])for(const m of h.children??[])m.is_system||l.push({id:m.id,name:m.name,icon:m.icon,type:"expense"});for(const h of c.income??[])for(const m of h.children??[])m.is_system||l.push({id:m.id,name:m.name,icon:m.icon,type:"income"});return l},[c]),[u,p]=b.useState(!1),[y,a]=b.useState(null),[r,s]=b.useState(null),o=async l=>{try{await d.mutateAsync(l),s(null)}catch(h){console.error("Failed to delete category:",h)}},n=g.filter(l=>l.type==="expense"),x=g.filter(l=>l.type==="income");return e.jsxs(e.Fragment,{children:[e.jsxs(Ee,{title:t("settings.categoryManagement"),badge:g.length,children:[i?e.jsx("div",{className:"py-4 text-center text-gray-400",children:t("loading")}):g.length===0?e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-center py-4",children:t("settings.noCategories")}):e.jsxs("div",{className:"space-y-4",children:[n.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:t("transaction.expense","Expense")}),e.jsx("div",{className:"space-y-2",children:n.map(l=>e.jsx(Ie,{category:l,onEdit:()=>a(l),onDelete:()=>s(l.id),isDeleting:d.isPending&&r===l.id,showDeleteConfirm:r===l.id,onConfirmDelete:()=>o(l.id),onCancelDelete:()=>s(null)},l.id))})]}),x.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:t("transaction.income","Income")}),e.jsx("div",{className:"space-y-2",children:x.map(l=>e.jsx(Ie,{category:l,onEdit:()=>a(l),onDelete:()=>s(l.id),isDeleting:d.isPending&&r===l.id,showDeleteConfirm:r===l.id,onConfirmDelete:()=>o(l.id),onCancelDelete:()=>s(null)},l.id))})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(P,{variant:"outline",onClick:()=>p(!0),children:t("settings.addCategory")})})]}),e.jsx(ua,{isOpen:u,onClose:()=>p(!1)}),e.jsx(ma,{isOpen:!!y,onClose:()=>a(null),category:y})]})}function Ie({category:t,onEdit:c,onDelete:i,isDeleting:d,showDeleteConfirm:g,onConfirmDelete:u,onCancelDelete:p}){const{t:y}=K("common");return g?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[e.jsx("span",{className:"text-sm text-red-800 dark:text-red-200",children:y("category.deleteConfirm","Delete this category?")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:p,className:"px-3 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:y("cancel")}),e.jsx("button",{onClick:u,disabled:d,className:"px-3 py-1 text-sm bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50",children:d?"...":y("delete")})]})]}):e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:t.icon}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:t.name})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:c,className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded",title:y("edit"),children:e.jsx(Dt,{size:16})}),e.jsx("button",{onClick:i,className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded",title:y("delete"),children:e.jsx(Oe,{size:16})})]})]})}const Le=["eth","bsc","polygon"];function ha(){const{t}=K("common"),c=oe(),[i,d]=b.useState(!1),[g,u]=b.useState(""),[p,y]=b.useState(""),[a,r]=b.useState(["eth","bsc","polygon"]),[s,o]=b.useState(!1),[n,x]=b.useState("polygon"),[l,h]=b.useState(""),[m,E]=b.useState(""),[N,f]=b.useState(""),[C,_]=b.useState(null),{data:I,isLoading:F}=Z({queryKey:["crypto-wallets"],queryFn:Et}),{data:O,isLoading:q}=Z({queryKey:["reward-contracts"],queryFn:_t}),U=D({mutationFn:jt,onSuccess:()=>{c.invalidateQueries({queryKey:["crypto-wallets"]}),d(!1),z()}}),k=D({mutationFn:Nt,onSuccess:()=>{c.invalidateQueries({queryKey:["crypto-wallets"]})}}),$=D({mutationFn:Ct,onSuccess:()=>{c.invalidateQueries({queryKey:["crypto-wallets"]}),c.invalidateQueries({queryKey:["dashboard-summary"]}),_(null)},onError:()=>{_(null)}}),Y=D({mutationFn:wt,onSuccess:()=>{c.invalidateQueries({queryKey:["reward-contracts"]}),o(!1),se()}}),M=D({mutationFn:St,onSuccess:()=>{c.invalidateQueries({queryKey:["reward-contracts"]})}}),z=()=>{u(""),y(""),r(["eth","bsc","polygon"])},se=()=>{x("polygon"),h(""),E(""),f("")},W=()=>{if(!g||!g.match(/^0x[a-fA-F0-9]{40}$/)){alert(t("crypto.invalidAddress"));return}U.mutate({wallet_address:g,label:p||void 0,chains:a})},G=v=>{_(v),$.mutate(v)},ee=()=>{if(!l||!l.match(/^0x[a-fA-F0-9]{40}$/)){alert(t("crypto.invalidAddress"));return}Y.mutate({chain_id:n,contract_address:l,label:m||void 0,token_symbol:N||void 0})},V=v=>{r(L=>L.includes(v)?L.filter(re=>re!==v):[...L,v])};return F||q?e.jsx(H,{children:e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(Q,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(H,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("crypto.wallets")}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>d(!i),children:t(i?"cancel":"crypto.addWallet")})]}),i&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-4",children:[e.jsx(B,{label:t("crypto.walletAddress"),placeholder:"0x...",value:g,onChange:v=>u(v.target.value)}),e.jsx(B,{label:t("crypto.walletLabel"),placeholder:t("crypto.labelPlaceholder"),value:p,onChange:v=>y(v.target.value)}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t("crypto.chains")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Le.map(v=>e.jsxs("button",{type:"button",onClick:()=>V(v),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${a.includes(v)?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:[J[v].icon," ",J[v].name]},v))})]}),e.jsx(P,{onClick:W,disabled:U.isPending,className:"w-full",children:U.isPending?t("loading"):t("crypto.addWallet")})]}),e.jsx("div",{className:"space-y-3",children:I&&I.length>0?I.map(v=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:v.label||t("crypto.unnamedWallet")}),e.jsx("div",{className:"flex gap-1",children:v.chains.map(L=>e.jsx("span",{title:J[L].name,children:J[L].icon},L))})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono truncate",children:v.wallet_address})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx(P,{variant:"outline",size:"sm",onClick:()=>G(v.id),disabled:C===v.id,children:C===v.id?e.jsx(Q,{size:"sm"}):t("crypto.sync")}),e.jsx("button",{onClick:()=>{confirm(t("crypto.confirmDeleteWallet"))&&k.mutate(v.id)},className:"text-red-600 hover:text-red-700 text-sm",children:t("delete")})]})]},v.id)):e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-center py-4",children:t("crypto.noWallets")})})]}),e.jsxs(H,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("crypto.rewardContracts")}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("crypto.rewardContractsDescription")})]}),e.jsx(P,{variant:"outline",size:"sm",onClick:()=>o(!s),children:t(s?"cancel":"crypto.addContract")})]}),s&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t("crypto.chain")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Le.map(v=>e.jsxs("button",{type:"button",onClick:()=>x(v),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${n===v?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:[J[v].icon," ",J[v].name]},v))})]}),e.jsx(B,{label:t("crypto.contractAddress"),placeholder:"0x...",value:l,onChange:v=>h(v.target.value)}),e.jsx(B,{label:t("crypto.contractLabel"),placeholder:t("crypto.contractLabelPlaceholder"),value:m,onChange:v=>E(v.target.value)}),e.jsx(B,{label:t("crypto.tokenSymbol"),placeholder:"STEER",value:N,onChange:v=>f(v.target.value)}),e.jsx(P,{onClick:ee,disabled:Y.isPending,className:"w-full",children:Y.isPending?t("loading"):t("crypto.addContract")})]}),e.jsx("div",{className:"space-y-3",children:O&&O.length>0?O.map(v=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{title:J[v.chain_id].name,children:J[v.chain_id].icon}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:v.label||t("crypto.unnamedContract")}),v.token_symbol&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 text-xs rounded",children:v.token_symbol})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono truncate",children:v.contract_address})]}),e.jsx("button",{onClick:()=>{confirm(t("crypto.confirmDeleteContract"))&&M.mutate(v.id)},className:"text-red-600 hover:text-red-700 text-sm ml-4",children:t("delete")})]},v.id)):e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-center py-4",children:t("crypto.noContracts")})})]})]})}function pa(){const{t}=K("common"),c=oe(),{data:i,isLoading:d,error:g}=Z({queryKey:["anomalyConfig"],queryFn:gt}),u=D({mutationFn:n=>ut(n),onSuccess:()=>{c.invalidateQueries({queryKey:["anomalyConfig"]})}}),[p,y]=b.useState({sensitivity:"medium",large_transaction_threshold:1e4,unusual_spending_percent:50,recurring_change_percent:20,duplicate_charge_hours:24,enabled_types:["large_transaction","category_shift","duplicate"]});b.useEffect(()=>{i&&y({sensitivity:i.sensitivity,large_transaction_threshold:i.large_transaction_threshold,unusual_spending_percent:i.unusual_spending_percent,recurring_change_percent:i.recurring_change_percent,duplicate_charge_hours:i.duplicate_charge_hours,enabled_types:i.enabled_types||["large_transaction","category_shift","duplicate"]})},[i]);const a=()=>{u.mutate(p)},r=n=>{y(x=>{const l=x.enabled_types||[],h=l.includes(n)?l.filter(m=>m!==n):[...l,n];return{...x,enabled_types:h}})},s=[{key:"large_transaction",label:t("anomaly.type.large_transaction")},{key:"category_shift",label:t("anomaly.type.category_shift")},{key:"duplicate",label:t("anomaly.type.duplicate")},{key:"recurring_change",label:t("anomaly.type.recurring_change")},{key:"ml_detected",label:t("anomaly.type.ml_detected")}],o=[{value:"low",label:t("anomaly.config.sensitivityOptions.low")},{value:"medium",label:t("anomaly.config.sensitivityOptions.medium")},{value:"high",label:t("anomaly.config.sensitivityOptions.high")}];return d?e.jsx(H,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/3"}),e.jsx("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded"})]})}):g?e.jsxs(H,{className:"p-6 text-center text-gray-500",children:[e.jsx(Ce,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:t("common.noData")})]}):e.jsxs(H,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(xe,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold",children:t("anomaly.config.title")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(me,{label:t("anomaly.config.sensitivity"),value:p.sensitivity,onChange:n=>y({...p,sensitivity:n.target.value}),options:o}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(B,{type:"number",label:t("anomaly.config.largeTransactionThreshold"),value:p.large_transaction_threshold,onChange:n=>y({...p,large_transaction_threshold:parseInt(n.target.value)||0})}),e.jsx(B,{type:"number",label:t("anomaly.config.unusualSpendingPercent"),value:p.unusual_spending_percent,onChange:n=>y({...p,unusual_spending_percent:parseInt(n.target.value)||0})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(B,{type:"number",label:t("anomaly.config.recurringChangePercent"),value:p.recurring_change_percent,onChange:n=>y({...p,recurring_change_percent:parseInt(n.target.value)||0})}),e.jsx(B,{type:"number",label:t("anomaly.config.duplicateChargeHours"),value:p.duplicate_charge_hours,onChange:n=>y({...p,duplicate_charge_hours:parseInt(n.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:t("anomaly.config.enabledTypes")}),e.jsx("div",{className:"space-y-3",children:s.map(n=>{const x=(p.enabled_types||[]).includes(n.key);return e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:n.label}),e.jsx(Ft,{checked:x,onChange:()=>r(n.key)})]},n.key)})})]}),e.jsx(P,{onClick:a,disabled:u.isPending,className:"w-full",children:u.isPending?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"animate-spin",children:"â³"}),t("common.saving")]}):e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Xt,{className:"w-4 h-4"}),t("anomaly.config.save")]})}),u.isSuccess&&e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 text-center",children:t("anomaly.config.saved")})]})]})}const fe={async getNotifications(t){const c=new URLSearchParams;return t!=null&&t.unreadOnly&&c.append("unread_only","true"),t!=null&&t.limit&&c.append("limit",String(t.limit)),t!=null&&t.offset&&c.append("offset",String(t.offset)),t!=null&&t.type&&c.append("type",t.type),(await T.get(`/api/notifications?${c}`)).data},async getUnreadCount(){return(await T.get("/api/notifications/unread/count")).data},async markAsRead(t){return(await T.put(`/api/notifications/${t}/read`,{})).data},async markAllAsRead(){return(await T.put("/api/notifications/read-all",{})).data},async deleteNotification(t){return(await T.delete(`/api/notifications/${t}`)).data},async cleanupOldNotifications(t=30){return(await T.post("/api/notifications/cleanup",{days_old:t})).data},async getPreferences(){return(await T.get("/api/notifications/preferences")).data},async updatePreference(t,c,i){return(await T.put(`/api/notifications/preferences/${t}`,{enabled:c,settings:i})).data},async subscribePush(t){return(await T.post("/api/notifications/push/subscribe",t)).data},async unsubscribePush(){return(await T.post("/api/notifications/push/unsubscribe",{})).data}};function ya(){return typeof window>"u"?!1:"serviceWorker"in navigator&&"PushManager"in window}async function ba(){return typeof window>"u"?"denied":await Notification.requestPermission()}function fa(){return""}function va(){const{t}=K("common"),c=oe(),[i,d]=b.useState(!1),[g,u]=b.useState(!1),{data:p,isLoading:y}=Z({queryKey:["notification-preferences"],queryFn:fe.getPreferences}),a=D({mutationFn:({channel:l,enabled:h,settings:m})=>fe.updatePreference(l,h,m),onSuccess:()=>{c.invalidateQueries({queryKey:["notification-preferences"]})}}),r=(p==null?void 0:p.preferences)||[];b.useEffect(()=>{(async()=>{if(ya()){const h=await Notification.permission;d(h==="granted")}})()},[]);const s=(l,h)=>{a.mutate({channel:l,enabled:!h})},o=async()=>{u(!0);try{if(await ba()==="granted"&&(d(!0),"serviceWorker"in navigator&&"PushManager"in window)){const m=await(await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:fa()});await fe.subscribePush(m.toJSON())}}catch(l){console.error("Failed to enable push notifications:",l)}finally{u(!1)}},n=l=>r.find(h=>h.channel===l),x=[{id:"push",icon:_e,label:t("notifications.channels.push"),description:t("notifications.channels.pushDescription"),getEnabled:()=>i,onToggle:o},{id:"email",icon:Ot,label:t("notifications.channels.email"),description:t("notifications.channels.emailDescription"),getEnabled:()=>{var l;return((l=n("email"))==null?void 0:l.enabled)??!0},onToggle:()=>{var l;return s("email",((l=n("email"))==null?void 0:l.enabled)??!0)}},{id:"in_app",icon:Be,label:t("notifications.channels.inApp"),description:t("notifications.channels.inAppDescription"),getEnabled:()=>{var l;return((l=n("in_app"))==null?void 0:l.enabled)??!0},onToggle:()=>{var l;return s("in_app",((l=n("in_app"))==null?void 0:l.enabled)??!0)}}];return y?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(Q,{size:"lg"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(H,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(xe,{className:"w-5 h-5 text-primary-600 dark:text-primary-400"}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:t("notifications.channels.title")})]}),e.jsx("div",{className:"space-y-4",children:x.map(l=>{const h=l.icon,m=l.getEnabled();return e.jsxs("div",{className:j("flex items-center justify-between p-3 rounded-lg border transition-colors",m?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:j("p-2 rounded-lg",m?"bg-green-100 dark:bg-green-900/50":"bg-gray-200 dark:bg-gray-600"),children:e.jsx(h,{className:j("w-5 h-5",m?"text-green-600 dark:text-green-400":"text-gray-500 dark:text-gray-400")})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:l.label}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:l.description})]})]}),e.jsx("button",{onClick:l.onToggle,disabled:l.id==="push"&&g,className:j("relative inline-flex h-7 w-12 items-center rounded-full transition-colors flex-shrink-0",m?"bg-green-500":"bg-gray-300 dark:bg-gray-600"),children:e.jsx("span",{className:j("inline-block h-5 w-5 transform rounded-full bg-white transition-transform shadow-sm",m?"translate-x-6":"translate-x-1")})})]},l.id)})})]}),e.jsxs(H,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:t("notifications.types.title")}),e.jsx("div",{className:"space-y-3",children:[{key:"budget_alert",label:t("notifications.types.budget")},{key:"bill_reminder",label:t("notifications.types.bills")},{key:"anomaly_detected",label:t("notifications.types.anomalies")},{key:"goal_milestone",label:t("notifications.types.goals")},{key:"savings_tip",label:t("notifications.types.savings")},{key:"burn_rate_warning",label:t("notifications.types.burnRate")}].map(l=>{const h=n(l.key),m=(h==null?void 0:h.enabled)??!0;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:l.label}),e.jsx("button",{onClick:()=>s(l.key,!m),className:j("relative inline-flex h-6 w-11 items-center rounded-full transition-colors",m?"bg-primary-600":"bg-gray-300 dark:bg-gray-600"),children:e.jsx("span",{className:j("inline-block h-4 w-4 transform rounded-full bg-white transition-transform",m?"translate-x-6":"translate-x-1")})})]},l.key)})})]}),e.jsxs(H,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:t("notifications.quietHours.title")}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("notifications.quietHours.description")})}),e.jsxs(P,{variant:"outline",size:"sm",children:[e.jsx(mt,{className:"w-4 h-4 mr-2"}),t("notifications.quietHours.configure")]})]})]})]})}const ka={default:"appearance.themes.default","catppuccin-latte":"appearance.themes.catppuccinLatte","catppuccin-frappe":"appearance.themes.catppuccinFrappe","catppuccin-macchiato":"appearance.themes.catppuccinMacchiato","catppuccin-mocha":"appearance.themes.catppuccinMocha",dracula:"appearance.themes.dracula","dracula-light":"appearance.themes.draculaLight"},ja={default:"Default","catppuccin-latte":"Catppuccin Latte","catppuccin-frappe":"Catppuccin Frappe","catppuccin-macchiato":"Catppuccin Macchiato","catppuccin-mocha":"Catppuccin Mocha",dracula:"Dracula","dracula-light":"Dracula Light"};function Na(){const{t}=K("common"),{colorTheme:c,setColorTheme:i}=Ue();return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:xt.map(d=>{const g=c===d.id,{base:u,surface:p,text:y,primary:a}=d.preview;return e.jsxs("button",{onClick:()=>i(d.id),className:j("relative flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all",g?"border-primary-500 ring-2 ring-primary-500/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"),children:[e.jsx("div",{className:"w-full aspect-[4/3] rounded-lg overflow-hidden border border-black/10",style:{backgroundColor:u},children:e.jsxs("div",{className:"p-2 h-full flex flex-col gap-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:a}}),e.jsx("div",{className:"h-1.5 rounded-full flex-1",style:{backgroundColor:y,opacity:.3}})]}),e.jsx("div",{className:"flex-1 rounded",style:{backgroundColor:p},children:e.jsxs("div",{className:"p-1.5 flex flex-col gap-1",children:[e.jsx("div",{className:"h-1 rounded-full w-3/4",style:{backgroundColor:y,opacity:.5}}),e.jsx("div",{className:"h-1 rounded-full w-1/2",style:{backgroundColor:y,opacity:.3}}),e.jsx("div",{className:"h-1.5 rounded-full w-2/5 mt-0.5",style:{backgroundColor:a}})]})})]})}),e.jsx("span",{className:j("text-xs font-medium truncate w-full text-center",g?"text-primary-700 dark:text-primary-300":"text-gray-600 dark:text-gray-400"),children:t(ka[d.id],ja[d.id])}),g&&e.jsx("div",{className:"absolute top-1.5 right-1.5 w-5 h-5 rounded-full bg-primary-500 flex items-center justify-center",children:e.jsx(ie,{className:"w-3 h-3 text-white"})})]},d.id)})})}const Ca=[{code:"ja",nameKey:"language.japanese",flag:"ðŸ‡¯ðŸ‡µ"},{code:"en",nameKey:"language.english",flag:"ðŸ‡ºðŸ‡¸"},{code:"vi",nameKey:"language.vietnamese",flag:"ðŸ‡»ðŸ‡³"}];function wa(){const{t,i18n:c}=K("common"),{theme:i,setTheme:d,accentColor:g,setAccentColor:u,colorTheme:p,tier:y,setTier:a}=Ue(),r=[{id:"light",icon:ht,label:t("appearance.light","Light")},{id:"dark",icon:pt,label:t("appearance.dark","Dark")},{id:"system",icon:Gt,label:t("appearance.system","System")}],s=[{id:"pro",icon:zt,label:t("appearance.pro","Pro"),desc:t("appearance.proDesc","Full access, all items visible")},{id:"lite",icon:Bt,label:t("appearance.lite","Lite"),desc:t("appearance.liteDesc","Simplified view, fewer items per page")}],o={green:t("appearance.colors.emerald","Emerald"),blue:t("appearance.colors.ocean","Ocean"),purple:t("appearance.colors.royal","Royal"),orange:t("appearance.colors.sunset","Sunset"),rose:t("appearance.colors.rose","Rose"),teal:t("appearance.colors.teal","Teal")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[e.jsx(Ke,{className:"w-4 h-4 text-primary-500"}),t("appearance.language","Language")]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Ca.map(({code:n,nameKey:x,flag:l})=>e.jsxs("button",{onClick:()=>c.changeLanguage(n),className:j("flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all",c.language===n?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"),children:[e.jsx("span",{className:"text-2xl",children:l}),e.jsx("span",{className:j("text-xs font-medium",c.language===n?"text-primary-700 dark:text-primary-300":"text-gray-600 dark:text-gray-400"),children:t(x)})]},n))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:t("appearance.themeMode","Theme Mode")}),p!=="default"?e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 italic",children:t("appearance.themeControlled","Controlled by theme")}):e.jsx("div",{className:"grid grid-cols-3 gap-2",children:r.map(({id:n,icon:x,label:l})=>e.jsxs("button",{onClick:()=>d(n),className:j("flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all",i===n?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"),children:[e.jsx(x,{className:j("w-5 h-5",i===n?"text-primary-600 dark:text-primary-400":"text-gray-500 dark:text-gray-400")}),e.jsx("span",{className:j("text-xs font-medium",i===n?"text-primary-700 dark:text-primary-300":"text-gray-600 dark:text-gray-400"),children:l})]},n))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:t("appearance.colorTheme","Color Theme")}),e.jsx(Na,{})]}),p==="default"&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:t("appearance.accentColor","Accent Color")}),e.jsx("div",{className:"flex flex-wrap gap-3",children:yt.map(n=>e.jsxs("button",{onClick:()=>u(n.id),className:"group flex flex-col items-center gap-1.5",title:o[n.id]||n.label,children:[e.jsx("div",{className:j("w-10 h-10 rounded-full transition-all ring-offset-2 ring-offset-white dark:ring-offset-gray-900",g===n.id?"ring-2 ring-gray-900 dark:ring-white scale-110":"ring-1 ring-gray-200 dark:ring-gray-700 group-hover:scale-105"),style:{backgroundColor:n.preview}}),e.jsx("span",{className:j("text-[10px] font-medium",g===n.id?"text-gray-900 dark:text-gray-100":"text-gray-500 dark:text-gray-500"),children:o[n.id]||n.label})]},n.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:t("appearance.displayMode","Display Mode")}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:s.map(({id:n,icon:x,label:l,desc:h})=>e.jsxs("button",{onClick:()=>a(n),className:j("flex flex-col items-start gap-2 p-4 rounded-xl border-2 transition-all text-left",y===n?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{className:j("w-4 h-4",y===n?"text-primary-600 dark:text-primary-400":"text-gray-500")}),e.jsx("span",{className:j("text-sm font-semibold",y===n?"text-primary-700 dark:text-primary-300":"text-gray-700 dark:text-gray-300"),children:l})]}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:h})]},n))})]})]})}const Sa=[{value:"01",label:"åŒ—æµ·é“"},{value:"02",label:"é’æ£®çœŒ"},{value:"03",label:"å²©æ‰‹çœŒ"},{value:"04",label:"å®®åŸŽçœŒ"},{value:"05",label:"ç§‹ç”°çœŒ"},{value:"06",label:"å±±å½¢çœŒ"},{value:"07",label:"ç¦å³¶çœŒ"},{value:"08",label:"èŒ¨åŸŽçœŒ"},{value:"09",label:"æ ƒæœ¨çœŒ"},{value:"10",label:"ç¾¤é¦¬çœŒ"},{value:"11",label:"åŸ¼çŽ‰çœŒ"},{value:"12",label:"åƒè‘‰çœŒ"},{value:"13",label:"æ±äº¬éƒ½"},{value:"14",label:"ç¥žå¥ˆå·çœŒ"},{value:"15",label:"æ–°æ½ŸçœŒ"},{value:"16",label:"å¯Œå±±çœŒ"},{value:"17",label:"çŸ³å·çœŒ"},{value:"18",label:"ç¦äº•çœŒ"},{value:"19",label:"å±±æ¢¨çœŒ"},{value:"20",label:"é•·é‡ŽçœŒ"},{value:"21",label:"å²é˜œçœŒ"},{value:"22",label:"é™å²¡çœŒ"},{value:"23",label:"æ„›çŸ¥çœŒ"},{value:"24",label:"ä¸‰é‡çœŒ"},{value:"25",label:"æ»‹è³€çœŒ"},{value:"26",label:"äº¬éƒ½åºœ"},{value:"27",label:"å¤§é˜ªåºœ"},{value:"28",label:"å…µåº«çœŒ"},{value:"29",label:"å¥ˆè‰¯çœŒ"},{value:"30",label:"å’Œæ­Œå±±çœŒ"},{value:"31",label:"é³¥å–çœŒ"},{value:"32",label:"å³¶æ ¹çœŒ"},{value:"33",label:"å²¡å±±çœŒ"},{value:"34",label:"åºƒå³¶çœŒ"},{value:"35",label:"å±±å£çœŒ"},{value:"36",label:"å¾³å³¶çœŒ"},{value:"37",label:"é¦™å·çœŒ"},{value:"38",label:"æ„›åª›çœŒ"},{value:"39",label:"é«˜çŸ¥çœŒ"},{value:"40",label:"ç¦å²¡çœŒ"},{value:"41",label:"ä½è³€çœŒ"},{value:"42",label:"é•·å´ŽçœŒ"},{value:"43",label:"ç†Šæœ¬çœŒ"},{value:"44",label:"å¤§åˆ†çœŒ"},{value:"45",label:"å®®å´ŽçœŒ"},{value:"46",label:"é¹¿å…å³¶çœŒ"},{value:"47",label:"æ²–ç¸„çœŒ"}],Ea=[{value:"1",label:"~300ä¸‡å††"},{value:"2",label:"300~500ä¸‡å††"},{value:"3",label:"500~700ä¸‡å††"},{value:"4",label:"700~1000ä¸‡å††"},{value:"5",label:"1000ä¸‡å††~"}],_a=[{value:"1",label:"1äºº"},{value:"2",label:"2äºº"},{value:"3",label:"3äºº"},{value:"4",label:"4äºº"},{value:"5",label:"5äººä»¥ä¸Š"}];function Ma({profile:t,onSave:c,isLoading:i}){const{t:d}=K("common"),[g,u]=b.useState("2"),[p,y]=b.useState("13"),[a,r]=b.useState("3");b.useEffect(()=>{t&&(u(String(t.family_size)),y(t.prefecture),r(t.annual_income_bracket))},[t]);const s=n=>{n.preventDefault(),c({family_size:parseInt(g),prefecture:p,annual_income_bracket:a})},o=t?g!==String(t.family_size)||p!==t.prefecture||a!==t.annual_income_bracket:!0;return e.jsxs("form",{onSubmit:s,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(we,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"}),d("benchmark.familySize","Family size")]}),e.jsx(me,{value:g,onChange:n=>u(n.target.value),options:_a,disabled:i})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(Kt,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"}),d("benchmark.prefecture","Prefecture")]}),e.jsx(me,{value:p,onChange:n=>y(n.target.value),options:Sa,disabled:i})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(Se,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"}),d("benchmark.annualIncome","Annual income bracket")]}),e.jsx(me,{value:a,onChange:n=>r(n.target.value),options:Ea,disabled:i})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsx(P,{type:"submit",disabled:!o||i,className:j("min-w-[120px]",!o&&"opacity-50 cursor-not-allowed"),children:i?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),d("common.saving","Saving...")]}):d("common.save","Save")})})]})}async function Ra(){return(await T.post("/api/export/ios/link")).data}async function Pa(t){const c=new URLSearchParams;t!=null&&t.startDate&&c.set("start_date",t.startDate),t!=null&&t.endDate&&c.set("end_date",t.endDate);const i=`/api/export/csv${c.toString()?`?${c}`:""}`,d=await T.get(i,{responseType:"blob"}),g=d.headers["content-disposition"];let u=`smartmoney-transactions-${new Date().toISOString().slice(0,10)}.csv`;if(g){const r=g.match(/filename="?([^";\n]+)"?/);r!=null&&r[1]&&(u=r[1])}const p=new Blob([d.data],{type:"text/csv;charset=utf-8;"}),y=window.URL.createObjectURL(p),a=document.createElement("a");a.href=y,a.download=u,document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(y)}async function Aa(){const t=await T.get("/api/export/ios",{responseType:"blob"}),c=t.headers["content-disposition"];let i=`smartmoney-export-${new Date().toISOString().slice(0,10)}.json`;if(c){const p=c.match(/filename="?([^";\n]+)"?/);p!=null&&p[1]&&(i=p[1])}const d=new Blob([t.data],{type:"application/json"}),g=window.URL.createObjectURL(d),u=document.createElement("a");u.href=g,u.download=i,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(g)}var Ta=Object.defineProperty,pe=Object.getOwnPropertySymbols,Qe=Object.prototype.hasOwnProperty,He=Object.prototype.propertyIsEnumerable,De=(t,c,i)=>c in t?Ta(t,c,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[c]=i,ke=(t,c)=>{for(var i in c||(c={}))Qe.call(c,i)&&De(t,i,c[i]);if(pe)for(var i of pe(c))He.call(c,i)&&De(t,i,c[i]);return t},je=(t,c)=>{var i={};for(var d in t)Qe.call(t,d)&&c.indexOf(d)<0&&(i[d]=t[d]);if(t!=null&&pe)for(var d of pe(t))c.indexOf(d)<0&&He.call(t,d)&&(i[d]=t[d]);return i};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var ae;(t=>{const c=class w{constructor(a,r,s,o){if(this.version=a,this.errorCorrectionLevel=r,this.modules=[],this.isFunction=[],a<w.MIN_VERSION||a>w.MAX_VERSION)throw new RangeError("Version value out of range");if(o<-1||o>7)throw new RangeError("Mask value out of range");this.size=a*4+17;let n=[];for(let l=0;l<this.size;l++)n.push(!1);for(let l=0;l<this.size;l++)this.modules.push(n.slice()),this.isFunction.push(n.slice());this.drawFunctionPatterns();const x=this.addEccAndInterleave(s);if(this.drawCodewords(x),o==-1){let l=1e9;for(let h=0;h<8;h++){this.applyMask(h),this.drawFormatBits(h);const m=this.getPenaltyScore();m<l&&(o=h,l=m),this.applyMask(h)}}g(0<=o&&o<=7),this.mask=o,this.applyMask(o),this.drawFormatBits(o),this.isFunction=[]}static encodeText(a,r){const s=t.QrSegment.makeSegments(a);return w.encodeSegments(s,r)}static encodeBinary(a,r){const s=t.QrSegment.makeBytes(a);return w.encodeSegments([s],r)}static encodeSegments(a,r,s=1,o=40,n=-1,x=!0){if(!(w.MIN_VERSION<=s&&s<=o&&o<=w.MAX_VERSION)||n<-1||n>7)throw new RangeError("Invalid value");let l,h;for(l=s;;l++){const f=w.getNumDataCodewords(l,r)*8,C=p.getTotalBits(a,l);if(C<=f){h=C;break}if(l>=o)throw new RangeError("Data too long")}for(const f of[w.Ecc.MEDIUM,w.Ecc.QUARTILE,w.Ecc.HIGH])x&&h<=w.getNumDataCodewords(l,f)*8&&(r=f);let m=[];for(const f of a){i(f.mode.modeBits,4,m),i(f.numChars,f.mode.numCharCountBits(l),m);for(const C of f.getData())m.push(C)}g(m.length==h);const E=w.getNumDataCodewords(l,r)*8;g(m.length<=E),i(0,Math.min(4,E-m.length),m),i(0,(8-m.length%8)%8,m),g(m.length%8==0);for(let f=236;m.length<E;f^=253)i(f,8,m);let N=[];for(;N.length*8<m.length;)N.push(0);return m.forEach((f,C)=>N[C>>>3]|=f<<7-(C&7)),new w(l,r,N,n)}getModule(a,r){return 0<=a&&a<this.size&&0<=r&&r<this.size&&this.modules[r][a]}getModules(){return this.modules}drawFunctionPatterns(){for(let s=0;s<this.size;s++)this.setFunctionModule(6,s,s%2==0),this.setFunctionModule(s,6,s%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const a=this.getAlignmentPatternPositions(),r=a.length;for(let s=0;s<r;s++)for(let o=0;o<r;o++)s==0&&o==0||s==0&&o==r-1||s==r-1&&o==0||this.drawAlignmentPattern(a[s],a[o]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(a){const r=this.errorCorrectionLevel.formatBits<<3|a;let s=r;for(let n=0;n<10;n++)s=s<<1^(s>>>9)*1335;const o=(r<<10|s)^21522;g(o>>>15==0);for(let n=0;n<=5;n++)this.setFunctionModule(8,n,d(o,n));this.setFunctionModule(8,7,d(o,6)),this.setFunctionModule(8,8,d(o,7)),this.setFunctionModule(7,8,d(o,8));for(let n=9;n<15;n++)this.setFunctionModule(14-n,8,d(o,n));for(let n=0;n<8;n++)this.setFunctionModule(this.size-1-n,8,d(o,n));for(let n=8;n<15;n++)this.setFunctionModule(8,this.size-15+n,d(o,n));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let a=this.version;for(let s=0;s<12;s++)a=a<<1^(a>>>11)*7973;const r=this.version<<12|a;g(r>>>18==0);for(let s=0;s<18;s++){const o=d(r,s),n=this.size-11+s%3,x=Math.floor(s/3);this.setFunctionModule(n,x,o),this.setFunctionModule(x,n,o)}}drawFinderPattern(a,r){for(let s=-4;s<=4;s++)for(let o=-4;o<=4;o++){const n=Math.max(Math.abs(o),Math.abs(s)),x=a+o,l=r+s;0<=x&&x<this.size&&0<=l&&l<this.size&&this.setFunctionModule(x,l,n!=2&&n!=4)}}drawAlignmentPattern(a,r){for(let s=-2;s<=2;s++)for(let o=-2;o<=2;o++)this.setFunctionModule(a+o,r+s,Math.max(Math.abs(o),Math.abs(s))!=1)}setFunctionModule(a,r,s){this.modules[r][a]=s,this.isFunction[r][a]=!0}addEccAndInterleave(a){const r=this.version,s=this.errorCorrectionLevel;if(a.length!=w.getNumDataCodewords(r,s))throw new RangeError("Invalid argument");const o=w.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][r],n=w.ECC_CODEWORDS_PER_BLOCK[s.ordinal][r],x=Math.floor(w.getNumRawDataModules(r)/8),l=o-x%o,h=Math.floor(x/o);let m=[];const E=w.reedSolomonComputeDivisor(n);for(let f=0,C=0;f<o;f++){let _=a.slice(C,C+h-n+(f<l?0:1));C+=_.length;const I=w.reedSolomonComputeRemainder(_,E);f<l&&_.push(0),m.push(_.concat(I))}let N=[];for(let f=0;f<m[0].length;f++)m.forEach((C,_)=>{(f!=h-n||_>=l)&&N.push(C[f])});return g(N.length==x),N}drawCodewords(a){if(a.length!=Math.floor(w.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let r=0;for(let s=this.size-1;s>=1;s-=2){s==6&&(s=5);for(let o=0;o<this.size;o++)for(let n=0;n<2;n++){const x=s-n,h=(s+1&2)==0?this.size-1-o:o;!this.isFunction[h][x]&&r<a.length*8&&(this.modules[h][x]=d(a[r>>>3],7-(r&7)),r++)}}g(r==a.length*8)}applyMask(a){if(a<0||a>7)throw new RangeError("Mask value out of range");for(let r=0;r<this.size;r++)for(let s=0;s<this.size;s++){let o;switch(a){case 0:o=(s+r)%2==0;break;case 1:o=r%2==0;break;case 2:o=s%3==0;break;case 3:o=(s+r)%3==0;break;case 4:o=(Math.floor(s/3)+Math.floor(r/2))%2==0;break;case 5:o=s*r%2+s*r%3==0;break;case 6:o=(s*r%2+s*r%3)%2==0;break;case 7:o=((s+r)%2+s*r%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[r][s]&&o&&(this.modules[r][s]=!this.modules[r][s])}}getPenaltyScore(){let a=0;for(let n=0;n<this.size;n++){let x=!1,l=0,h=[0,0,0,0,0,0,0];for(let m=0;m<this.size;m++)this.modules[n][m]==x?(l++,l==5?a+=w.PENALTY_N1:l>5&&a++):(this.finderPenaltyAddHistory(l,h),x||(a+=this.finderPenaltyCountPatterns(h)*w.PENALTY_N3),x=this.modules[n][m],l=1);a+=this.finderPenaltyTerminateAndCount(x,l,h)*w.PENALTY_N3}for(let n=0;n<this.size;n++){let x=!1,l=0,h=[0,0,0,0,0,0,0];for(let m=0;m<this.size;m++)this.modules[m][n]==x?(l++,l==5?a+=w.PENALTY_N1:l>5&&a++):(this.finderPenaltyAddHistory(l,h),x||(a+=this.finderPenaltyCountPatterns(h)*w.PENALTY_N3),x=this.modules[m][n],l=1);a+=this.finderPenaltyTerminateAndCount(x,l,h)*w.PENALTY_N3}for(let n=0;n<this.size-1;n++)for(let x=0;x<this.size-1;x++){const l=this.modules[n][x];l==this.modules[n][x+1]&&l==this.modules[n+1][x]&&l==this.modules[n+1][x+1]&&(a+=w.PENALTY_N2)}let r=0;for(const n of this.modules)r=n.reduce((x,l)=>x+(l?1:0),r);const s=this.size*this.size,o=Math.ceil(Math.abs(r*20-s*10)/s)-1;return g(0<=o&&o<=9),a+=o*w.PENALTY_N4,g(0<=a&&a<=2568888),a}getAlignmentPatternPositions(){if(this.version==1)return[];{const a=Math.floor(this.version/7)+2,r=this.version==32?26:Math.ceil((this.version*4+4)/(a*2-2))*2;let s=[6];for(let o=this.size-7;s.length<a;o-=r)s.splice(1,0,o);return s}}static getNumRawDataModules(a){if(a<w.MIN_VERSION||a>w.MAX_VERSION)throw new RangeError("Version number out of range");let r=(16*a+128)*a+64;if(a>=2){const s=Math.floor(a/7)+2;r-=(25*s-10)*s-55,a>=7&&(r-=36)}return g(208<=r&&r<=29648),r}static getNumDataCodewords(a,r){return Math.floor(w.getNumRawDataModules(a)/8)-w.ECC_CODEWORDS_PER_BLOCK[r.ordinal][a]*w.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][a]}static reedSolomonComputeDivisor(a){if(a<1||a>255)throw new RangeError("Degree out of range");let r=[];for(let o=0;o<a-1;o++)r.push(0);r.push(1);let s=1;for(let o=0;o<a;o++){for(let n=0;n<r.length;n++)r[n]=w.reedSolomonMultiply(r[n],s),n+1<r.length&&(r[n]^=r[n+1]);s=w.reedSolomonMultiply(s,2)}return r}static reedSolomonComputeRemainder(a,r){let s=r.map(o=>0);for(const o of a){const n=o^s.shift();s.push(0),r.forEach((x,l)=>s[l]^=w.reedSolomonMultiply(x,n))}return s}static reedSolomonMultiply(a,r){if(a>>>8||r>>>8)throw new RangeError("Byte out of range");let s=0;for(let o=7;o>=0;o--)s=s<<1^(s>>>7)*285,s^=(r>>>o&1)*a;return g(s>>>8==0),s}finderPenaltyCountPatterns(a){const r=a[1];g(r<=this.size*3);const s=r>0&&a[2]==r&&a[3]==r*3&&a[4]==r&&a[5]==r;return(s&&a[0]>=r*4&&a[6]>=r?1:0)+(s&&a[6]>=r*4&&a[0]>=r?1:0)}finderPenaltyTerminateAndCount(a,r,s){return a&&(this.finderPenaltyAddHistory(r,s),r=0),r+=this.size,this.finderPenaltyAddHistory(r,s),this.finderPenaltyCountPatterns(s)}finderPenaltyAddHistory(a,r){r[0]==0&&(a+=this.size),r.pop(),r.unshift(a)}};c.MIN_VERSION=1,c.MAX_VERSION=40,c.PENALTY_N1=3,c.PENALTY_N2=3,c.PENALTY_N3=40,c.PENALTY_N4=10,c.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],c.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=c;function i(y,a,r){if(a<0||a>31||y>>>a)throw new RangeError("Value out of range");for(let s=a-1;s>=0;s--)r.push(y>>>s&1)}function d(y,a){return(y>>>a&1)!=0}function g(y){if(!y)throw new Error("Assertion error")}const u=class R{constructor(a,r,s){if(this.mode=a,this.numChars=r,this.bitData=s,r<0)throw new RangeError("Invalid argument");this.bitData=s.slice()}static makeBytes(a){let r=[];for(const s of a)i(s,8,r);return new R(R.Mode.BYTE,a.length,r)}static makeNumeric(a){if(!R.isNumeric(a))throw new RangeError("String contains non-numeric characters");let r=[];for(let s=0;s<a.length;){const o=Math.min(a.length-s,3);i(parseInt(a.substring(s,s+o),10),o*3+1,r),s+=o}return new R(R.Mode.NUMERIC,a.length,r)}static makeAlphanumeric(a){if(!R.isAlphanumeric(a))throw new RangeError("String contains unencodable characters in alphanumeric mode");let r=[],s;for(s=0;s+2<=a.length;s+=2){let o=R.ALPHANUMERIC_CHARSET.indexOf(a.charAt(s))*45;o+=R.ALPHANUMERIC_CHARSET.indexOf(a.charAt(s+1)),i(o,11,r)}return s<a.length&&i(R.ALPHANUMERIC_CHARSET.indexOf(a.charAt(s)),6,r),new R(R.Mode.ALPHANUMERIC,a.length,r)}static makeSegments(a){return a==""?[]:R.isNumeric(a)?[R.makeNumeric(a)]:R.isAlphanumeric(a)?[R.makeAlphanumeric(a)]:[R.makeBytes(R.toUtf8ByteArray(a))]}static makeEci(a){let r=[];if(a<0)throw new RangeError("ECI assignment value out of range");if(a<128)i(a,8,r);else if(a<16384)i(2,2,r),i(a,14,r);else if(a<1e6)i(6,3,r),i(a,21,r);else throw new RangeError("ECI assignment value out of range");return new R(R.Mode.ECI,0,r)}static isNumeric(a){return R.NUMERIC_REGEX.test(a)}static isAlphanumeric(a){return R.ALPHANUMERIC_REGEX.test(a)}getData(){return this.bitData.slice()}static getTotalBits(a,r){let s=0;for(const o of a){const n=o.mode.numCharCountBits(r);if(o.numChars>=1<<n)return 1/0;s+=4+n+o.bitData.length}return s}static toUtf8ByteArray(a){a=encodeURI(a);let r=[];for(let s=0;s<a.length;s++)a.charAt(s)!="%"?r.push(a.charCodeAt(s)):(r.push(parseInt(a.substring(s+1,s+3),16)),s+=2);return r}};u.NUMERIC_REGEX=/^[0-9]*$/,u.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,u.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let p=u;t.QrSegment=u})(ae||(ae={}));(t=>{(c=>{const i=class{constructor(g,u){this.ordinal=g,this.formatBits=u}};i.LOW=new i(0,1),i.MEDIUM=new i(1,0),i.QUARTILE=new i(2,3),i.HIGH=new i(3,2),c.Ecc=i})(t.QrCode||(t.QrCode={}))})(ae||(ae={}));(t=>{(c=>{const i=class{constructor(g,u){this.modeBits=g,this.numBitsCharCount=u}numCharCountBits(g){return this.numBitsCharCount[Math.floor((g+7)/17)]}};i.NUMERIC=new i(1,[10,12,14]),i.ALPHANUMERIC=new i(2,[9,11,13]),i.BYTE=new i(4,[8,16,16]),i.KANJI=new i(8,[8,10,12]),i.ECI=new i(7,[0,0,0]),c.Mode=i})(t.QrSegment||(t.QrSegment={}))})(ae||(ae={}));var le=ae;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Ia={L:le.QrCode.Ecc.LOW,M:le.QrCode.Ecc.MEDIUM,Q:le.QrCode.Ecc.QUARTILE,H:le.QrCode.Ecc.HIGH},$e=128,We="L",Ge="#FFFFFF",Ve="#000000",Ye=!1,Xe=1,La=4,Da=0,Fa=.1;function Je(t,c=0){const i=[];return t.forEach(function(d,g){let u=null;d.forEach(function(p,y){if(!p&&u!==null){i.push(`M${u+c} ${g+c}h${y-u}v1H${u+c}z`),u=null;return}if(y===d.length-1){if(!p)return;u===null?i.push(`M${y+c},${g+c} h1v1H${y+c}z`):i.push(`M${u+c},${g+c} h${y+1-u}v1H${u+c}z`);return}p&&u===null&&(u=y)})}),i.join("")}function Ze(t,c){return t.slice().map((i,d)=>d<c.y||d>=c.y+c.h?i:i.map((g,u)=>u<c.x||u>=c.x+c.w?g:!1))}function Oa(t,c,i,d){if(d==null)return null;const g=t.length+i*2,u=Math.floor(c*Fa),p=g/c,y=(d.width||u)*p,a=(d.height||u)*p,r=d.x==null?t.length/2-y/2:d.x*p,s=d.y==null?t.length/2-a/2:d.y*p,o=d.opacity==null?1:d.opacity;let n=null;if(d.excavate){let l=Math.floor(r),h=Math.floor(s),m=Math.ceil(y+r-l),E=Math.ceil(a+s-h);n={x:l,y:h,w:m,h:E}}const x=d.crossOrigin;return{x:r,y:s,h:a,w:y,excavation:n,opacity:o,crossOrigin:x}}function za(t,c){return c!=null?Math.max(Math.floor(c),0):t?La:Da}function et({value:t,level:c,minVersion:i,includeMargin:d,marginSize:g,imageSettings:u,size:p,boostLevel:y}){let a=A.useMemo(()=>{const l=(Array.isArray(t)?t:[t]).reduce((h,m)=>(h.push(...le.QrSegment.makeSegments(m)),h),[]);return le.QrCode.encodeSegments(l,Ia[c],i,void 0,void 0,y)},[t,c,i,y]);const{cells:r,margin:s,numCells:o,calculatedImageSettings:n}=A.useMemo(()=>{let x=a.getModules();const l=za(d,g),h=x.length+l*2,m=Oa(x,p,l,u);return{cells:x,margin:l,numCells:h,calculatedImageSettings:m}},[a,p,u,d,g]);return{qrcode:a,margin:s,cells:r,numCells:o,calculatedImageSettings:n}}var Ba=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Ua=A.forwardRef(function(c,i){const d=c,{value:g,size:u=$e,level:p=We,bgColor:y=Ge,fgColor:a=Ve,includeMargin:r=Ye,minVersion:s=Xe,boostLevel:o,marginSize:n,imageSettings:x}=d,h=je(d,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:m}=h,E=je(h,["style"]),N=x==null?void 0:x.src,f=A.useRef(null),C=A.useRef(null),_=A.useCallback(M=>{f.current=M,typeof i=="function"?i(M):i&&(i.current=M)},[i]),[I,F]=A.useState(!1),{margin:O,cells:q,numCells:U,calculatedImageSettings:k}=et({value:g,level:p,minVersion:s,boostLevel:o,includeMargin:r,marginSize:n,imageSettings:x,size:u});A.useEffect(()=>{if(f.current!=null){const M=f.current,z=M.getContext("2d");if(!z)return;let se=q;const W=C.current,G=k!=null&&W!==null&&W.complete&&W.naturalHeight!==0&&W.naturalWidth!==0;G&&k.excavation!=null&&(se=Ze(q,k.excavation));const ee=window.devicePixelRatio||1;M.height=M.width=u*ee;const V=u/U*ee;z.scale(V,V),z.fillStyle=y,z.fillRect(0,0,U,U),z.fillStyle=a,Ba?z.fill(new Path2D(Je(se,O))):q.forEach(function(v,L){v.forEach(function(re,ne){re&&z.fillRect(ne+O,L+O,1,1)})}),k&&(z.globalAlpha=k.opacity),G&&z.drawImage(W,k.x+O,k.y+O,k.w,k.h)}}),A.useEffect(()=>{F(!1)},[N]);const $=ke({height:u,width:u},m);let Y=null;return N!=null&&(Y=A.createElement("img",{src:N,key:N,style:{display:"none"},onLoad:()=>{F(!0)},ref:C,crossOrigin:k==null?void 0:k.crossOrigin})),A.createElement(A.Fragment,null,A.createElement("canvas",ke({style:$,height:u,width:u,ref:_,role:"img"},E)),Y)});Ua.displayName="QRCodeCanvas";var tt=A.forwardRef(function(c,i){const d=c,{value:g,size:u=$e,level:p=We,bgColor:y=Ge,fgColor:a=Ve,includeMargin:r=Ye,minVersion:s=Xe,boostLevel:o,title:n,marginSize:x,imageSettings:l}=d,h=je(d,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:m,cells:E,numCells:N,calculatedImageSettings:f}=et({value:g,level:p,minVersion:s,boostLevel:o,includeMargin:r,marginSize:x,imageSettings:l,size:u});let C=E,_=null;l!=null&&f!=null&&(f.excavation!=null&&(C=Ze(E,f.excavation)),_=A.createElement("image",{href:l.src,height:f.h,width:f.w,x:f.x+m,y:f.y+m,preserveAspectRatio:"none",opacity:f.opacity,crossOrigin:f.crossOrigin}));const I=Je(C,m);return A.createElement("svg",ke({height:u,width:u,viewBox:`0 0 ${N} ${N}`,ref:i,role:"img"},h),!!n&&A.createElement("title",null,n),A.createElement("path",{fill:y,d:`M0,0 h${N}v${N}H0z`,shapeRendering:"crispEdges"}),A.createElement("path",{fill:a,d:I,shapeRendering:"crispEdges"}),_)});tt.displayName="QRCodeSVG";const at={appearance:{bg:"bg-violet-100 dark:bg-violet-900/30",text:"text-violet-600 dark:text-violet-400",activeBg:"bg-violet-100 dark:bg-violet-900/30",activeText:"text-violet-700 dark:text-violet-400"},general:{bg:"bg-primary-100 dark:bg-primary-900/30",text:"text-primary-600 dark:text-primary-400",activeBg:"bg-primary-100 dark:bg-primary-900/30",activeText:"text-primary-700 dark:text-primary-400"},household:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-600 dark:text-blue-400",activeBg:"bg-blue-100 dark:bg-blue-900/30",activeText:"text-blue-700 dark:text-blue-400"},budget:{bg:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-600 dark:text-emerald-400",activeBg:"bg-emerald-100 dark:bg-emerald-900/30",activeText:"text-emerald-700 dark:text-emerald-400"},categories:{bg:"bg-amber-100 dark:bg-amber-900/30",text:"text-amber-600 dark:text-amber-400",activeBg:"bg-amber-100 dark:bg-amber-900/30",activeText:"text-amber-700 dark:text-amber-400"},sources:{bg:"bg-indigo-100 dark:bg-indigo-900/30",text:"text-indigo-600 dark:text-indigo-400",activeBg:"bg-indigo-100 dark:bg-indigo-900/30",activeText:"text-indigo-700 dark:text-indigo-400"},recurring:{bg:"bg-teal-100 dark:bg-teal-900/30",text:"text-teal-600 dark:text-teal-400",activeBg:"bg-teal-100 dark:bg-teal-900/30",activeText:"text-teal-700 dark:text-teal-400"},notifications:{bg:"bg-rose-100 dark:bg-rose-900/30",text:"text-rose-600 dark:text-rose-400",activeBg:"bg-rose-100 dark:bg-rose-900/30",activeText:"text-rose-700 dark:text-rose-400"},crypto:{bg:"bg-cyan-100 dark:bg-cyan-900/30",text:"text-cyan-600 dark:text-cyan-400",activeBg:"bg-cyan-100 dark:bg-cyan-900/30",activeText:"text-cyan-700 dark:text-cyan-400"},anomaly:{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-600 dark:text-orange-400",activeBg:"bg-orange-100 dark:bg-orange-900/30",activeText:"text-orange-700 dark:text-orange-400"},export:{bg:"bg-sky-100 dark:bg-sky-900/30",text:"text-sky-600 dark:text-sky-400",activeBg:"bg-sky-100 dark:bg-sky-900/30",activeText:"text-sky-700 dark:text-sky-400"}},Ka=[{id:"appearance",labelKey:"settings.sections.appearance",icon:qe},{id:"general",labelKey:"settings.sections.general",icon:xe},{id:"household",labelKey:"settings.sections.household",icon:we},{id:"budget",labelKey:"settings.sections.budget",icon:Se},{id:"categories",labelKey:"settings.sections.categories",icon:ve},{id:"sources",labelKey:"settings.sections.sources",icon:ft},{id:"recurring",labelKey:"settings.sections.recurring",icon:Mt},{id:"notifications",labelKey:"settings.sections.notifications",icon:Be},{id:"crypto",labelKey:"settings.sections.crypto",icon:Ke},{id:"anomaly",labelKey:"anomaly.title",icon:Ce},{id:"export",labelKey:"settings.sections.export",icon:_e}];function qa(){var Pe,Ae;const{t}=K("common"),c=oe(),[i,d]=b.useState("appearance"),[g,u]=b.useState(!1),[p,y]=b.useState(!1),[a,r]=b.useState(!1),[s,o]=b.useState(null),[n,x]=b.useState(null),[l,h]=b.useState(!1),[m,E]=b.useState(!1),[N,f]=b.useState(""),[C,_]=b.useState(!1),[I,F]=b.useState(!1),[O,q]=b.useState(!1),[U,k]=b.useState(""),[$,Y]=b.useState(""),{data:M,isLoading:z}=Z({queryKey:["settings"],queryFn:kt}),{data:se}=Z({queryKey:["household-profile"],queryFn:Qt}),W=D({mutationFn:qt,onSuccess:()=>{c.invalidateQueries({queryKey:["household-profile"]}),c.invalidateQueries({queryKey:["benchmark-comparison"]}),te.success(t("settings.profileSaved","Household profile saved successfully"))},onError:S=>{console.error("Failed to save household profile:",S),te.error(t("settings.profileSaveError","Failed to save household profile"))}}),[G,ee]=b.useState("JPY"),[V,v]=b.useState(25),[L,re]=b.useState(!1),[ne,Me]=b.useState(!0),[he,Re]=b.useState(1e6);b.useEffect(()=>{M&&(ee(M.currency),v(M.base_date),re(M.budget_carry_over),Me(M.budget_email_alerts),Re(M.large_transaction_threshold))},[M]),b.useEffect(()=>{if(M){const S=G!==M.currency||V!==M.base_date||L!==M.budget_carry_over||ne!==M.budget_email_alerts||he!==M.large_transaction_threshold;u(S)}},[G,V,L,ne,he,M]);const ye=D({mutationFn:bt,onSuccess:()=>{c.invalidateQueries({queryKey:["settings"]}),c.invalidateQueries({queryKey:["dashboard-summary"]}),c.invalidateQueries({queryKey:["transactions"]}),c.invalidateQueries({queryKey:["analytics"]}),u(!1)},onError:S=>{console.error("Failed to save settings:",S)}}),st=()=>{ye.mutate({currency:G,base_date:V,budget_carry_over:L,budget_email_alerts:ne,large_transaction_threshold:he})},rt=async()=>{y(!0),r(!1);try{await Aa(),r(!0),setTimeout(()=>r(!1),3e3)}catch{te.error(t("settings.export.error"))}finally{y(!1)}},nt=async()=>{F(!0),q(!1);try{await Pa({startDate:U||void 0,endDate:$||void 0}),q(!0),setTimeout(()=>q(!1),3e3)}catch{te.error(t("export.csvError","Failed to export CSV"))}finally{F(!1)}},it=async()=>{h(!0),o(null),E(!1),_(!1);try{const S=await Ra();o(S.url),x(new Date(S.expiresAt))}catch{te.error(t("settings.export.generateFailed","Failed to generate link"))}finally{h(!1)}},lt=async()=>{if(s)try{await navigator.clipboard.writeText(s),E(!0),setTimeout(()=>E(!1),2e3)}catch{te.error(t("settings.export.copyFailed","Failed to copy link"))}};if(b.useEffect(()=>{if(!n)return;const S=setInterval(()=>{const de=new Date,ue=n.getTime()-de.getTime();if(ue<=0){f(""),_(!0),x(null),te.info(t("settings.export.linkExpired")),clearInterval(S);return}const X=Math.floor(ue/6e4),ot=Math.floor(ue%6e4/1e3);f(t("settings.export.linkExpires",{minutes:X,seconds:ot}))},1e3);return()=>clearInterval(S)},[n,t]),z)return e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(Q,{size:"lg"})});const be={JPY:t("settings.currencyJPY"),USD:t("settings.currencyUSD"),VND:t("settings.currencyVND")};return e.jsxs("div",{className:"min-h-screen pb-32",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-4",children:[e.jsxs("h1",{className:"text-2xl font-extrabold text-gray-900 dark:text-white flex items-center gap-2.5 tracking-tight",children:[e.jsx(xe,{className:"w-5 h-5 text-primary-600"}),t("settings.title")]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:t("settings.subtitle")})]}),e.jsx("div",{className:"border-t border-gray-100 dark:border-gray-800",children:e.jsx("div",{className:"max-w-2xl mx-auto px-4",children:e.jsx("div",{className:"flex gap-1 overflow-x-auto py-2 scrollbar-hide -mb-2",children:Ka.map(S=>{const de=S.icon,ue=i===S.id,X=at[S.id];return e.jsxs("button",{onClick:()=>d(S.id),className:j("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-semibold whitespace-nowrap transition-colors",ue?j(X==null?void 0:X.activeBg,X==null?void 0:X.activeText):"text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"),children:[e.jsx(de,{className:"w-3.5 h-3.5"}),t(S.labelKey)]},S.id)})})})})]}),e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-4 space-y-4",children:[e.jsx("div",{className:j("space-y-4",i!=="appearance"&&"hidden"),children:e.jsx(ge,{sectionId:"appearance",icon:qe,title:t("appearance.title","Appearance"),description:t("appearance.subtitle","Theme, colors, and display preferences"),children:e.jsx(wa,{})})}),e.jsx("div",{className:j("space-y-4",i!=="general"&&"hidden"),children:e.jsx(ge,{sectionId:"general",icon:xe,title:t("settings.general"),description:t("settings.generalDescription","Currency and basic preferences"),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(me,{label:t("settings.currency"),value:G,onChange:S=>ee(S.target.value),options:[{value:"JPY",label:be.JPY},{value:"USD",label:be.USD},{value:"VND",label:be.VND}]}),e.jsx(B,{type:"number",label:t("settings.payday"),value:V,onChange:S=>v(parseInt(S.target.value,10)),min:1,max:31}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 -mt-2",children:t("settings.paydayDescription")})]})})}),e.jsx("div",{className:j("space-y-4",i!=="household"&&"hidden"),children:e.jsx(ge,{sectionId:"household",icon:we,title:t("settings.householdProfile","Household Profile"),description:t("settings.householdProfileDescription","Family size, prefecture, and income bracket for spending benchmarks"),children:e.jsx(Ma,{profile:se||null,onSave:S=>W.mutate(S),isLoading:W.isPending})})}),e.jsx("div",{className:j("space-y-4",i!=="budget"&&"hidden"),children:e.jsx(ge,{sectionId:"budget",icon:Se,title:t("settings.budgetSettings"),description:t("settings.budgetDescription","Budget behavior and alerts"),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Fe,{label:t("settings.budgetCarryOver"),description:t("settings.budgetCarryOverDescription"),checked:L,onChange:re}),e.jsx(Fe,{label:t("settings.budgetEmailAlerts"),description:t("settings.budgetEmailAlertsDescription"),checked:ne,onChange:Me}),e.jsxs("div",{className:"pt-2",children:[e.jsx("label",{className:"font-medium text-gray-900 dark:text-white block mb-2",children:t("settings.largeTransactionThreshold")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:t("settings.largeTransactionThresholdDescription")}),e.jsx(B,{type:"number",value:he,onChange:S=>Re(parseInt(S.target.value,10)||0),min:0,step:1e5}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:t("settings.largeTransactionThresholdHint")})]})]})})}),e.jsx("div",{className:j("space-y-4",i!=="categories"&&"hidden"),children:e.jsx(xa,{})}),e.jsx("div",{className:j("space-y-4",i!=="sources"&&"hidden"),children:e.jsxs(Ee,{title:t("settings.paymentSourceManagement"),badge:((Pe=M==null?void 0:M.sources)==null?void 0:Pe.length)||0,children:[e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:((Ae=M==null?void 0:M.sources)==null?void 0:Ae.map((S,de)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-indigo-50/50 dark:bg-indigo-900/10 border border-indigo-100 dark:border-indigo-900/20 rounded-xl",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:S}),e.jsx("button",{className:"text-red-500 hover:text-red-600 dark:text-red-400 dark:hover:text-red-300 text-xs font-semibold",children:t("settings.delete")})]},de)))||e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-center py-4",children:t("settings.noSources")})}),e.jsx("div",{className:"mt-4",children:e.jsx(P,{variant:"outline",children:t("settings.addSource")})})]})}),e.jsx("div",{className:j("space-y-4",i!=="recurring"&&"hidden"),children:e.jsx(Pt,{})}),e.jsx("div",{className:j("space-y-4",i!=="notifications"&&"hidden"),children:e.jsx(va,{})}),e.jsx("div",{className:j("space-y-4",i!=="crypto"&&"hidden"),children:e.jsx(ha,{})}),e.jsx("div",{className:j("space-y-4",i!=="anomaly"&&"hidden"),children:e.jsx(pa,{})}),e.jsx("div",{className:j("space-y-4",i!=="export"&&"hidden"),children:e.jsx(ge,{sectionId:"export",icon:_e,title:t("settings.export.title"),description:t("settings.export.description"),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("settings.export.instructions")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(P,{onClick:rt,disabled:p,className:"flex-1",size:"lg",children:p?e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:"sm",className:"mr-2"}),t("settings.export.exporting")]}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"w-4 h-4 mr-2"}),t("settings.export.button")]})}),e.jsx(P,{onClick:it,disabled:l,variant:"outline",className:"flex-1",size:"lg",children:l?e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:"sm",className:"mr-2"}),t("settings.export.generatingLink")]}):e.jsxs(e.Fragment,{children:[e.jsx($t,{className:"w-4 h-4 mr-2"}),t("settings.export.generateLink")]})})]}),a&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[e.jsx(ie,{className:"w-4 h-4"}),t("settings.export.success")]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:t("export.csv","Export CSV")}),e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsx(B,{type:"date",value:U,onChange:S=>k(S.target.value),label:t("export.startDate","Start Date")}),e.jsx(B,{type:"date",value:$,onChange:S=>Y(S.target.value),label:t("export.endDate","End Date")})]}),e.jsx(P,{onClick:nt,disabled:I,variant:"outline",className:"w-full",size:"lg",children:I?e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:"sm",className:"mr-2"}),t("settings.export.exporting")]}):e.jsxs(e.Fragment,{children:[e.jsx(Te,{className:"w-4 h-4 mr-2"}),t("export.csv","Export CSV")]})}),O&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400 mt-2",children:[e.jsx(ie,{className:"w-4 h-4"}),t("export.csvSuccess","CSV exported successfully")]})]}),s&&!C&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-green-600 dark:text-green-400",children:[e.jsx(vt,{className:"w-4 h-4"}),t("settings.export.linkGenerated")]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:s,className:"flex-1 px-3 py-2 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-gray-100 select-all",onClick:S=>S.target.select()}),e.jsx(P,{onClick:lt,variant:"outline",size:"sm",children:m?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4 mr-1"}),t("settings.export.linkCopied")]}):e.jsxs(e.Fragment,{children:[e.jsx(Ut,{className:"w-4 h-4 mr-1"}),t("settings.export.copyLink")]})})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"p-3 bg-white rounded-lg",children:e.jsx(tt,{value:s,size:180})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t("settings.export.scanQR")})]}),N&&e.jsx("p",{className:"text-xs text-center text-amber-600 dark:text-amber-400",children:N})]}),C&&e.jsx("div",{className:"mt-4 p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:e.jsx("p",{className:"text-sm text-center text-red-600 dark:text-red-400",children:t("settings.export.linkExpired")})})]})})}),e.jsx(ca,{})]}),g&&typeof document<"u"&&Ne.createPortal(e.jsx("div",{className:"fixed bottom-20 left-0 right-0 p-4 bg-white/90 dark:bg-gray-900/90 backdrop-blur-lg border-t border-gray-200 dark:border-gray-700 z-40",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(P,{onClick:st,disabled:ye.isPending,className:"w-full",size:"lg",children:ye.isPending?e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:"sm",className:"mr-2"}),t("saving")]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),t("settings.saveSettings")]})})})}),document.body)]})}function ge({icon:t,title:c,description:i,children:d,className:g,sectionId:u}){const p=u?at[u]:null;return e.jsxs(H,{className:j("shadow-card",g),children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:j("p-2 rounded-xl",(p==null?void 0:p.bg)||"bg-primary-100 dark:bg-primary-900/30"),children:e.jsx(t,{className:j("w-5 h-5",(p==null?void 0:p.text)||"text-primary-600 dark:text-primary-400")})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-gray-900 dark:text-gray-100",children:c}),i&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i})]})]}),d]})}function Fe({label:t,description:c,checked:i,onChange:d}){return e.jsxs("div",{className:"flex items-start justify-between py-2",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("label",{className:"font-semibold text-gray-900 dark:text-white block",children:t}),c&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-0.5",children:c})]}),e.jsx("button",{onClick:()=>d(!i),className:j("relative inline-flex h-7 w-12 items-center rounded-full transition-colors flex-shrink-0",i?"bg-emerald-500 dark:bg-emerald-600":"bg-gray-300 dark:bg-gray-600"),children:e.jsx("span",{className:j("inline-block h-5 w-5 transform rounded-full bg-white transition-transform shadow-md",i?"translate-x-6":"translate-x-1")})})]})}const us=ct("/settings")({component:qa});export{us as Route};

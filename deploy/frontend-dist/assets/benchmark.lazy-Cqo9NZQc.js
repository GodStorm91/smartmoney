import{u as b,j as e,C as o,bc as k,as as w,bd as C,B as S,aj as B,be as z,bf as E,at as U,a0 as T,N as P,am as X,aT as y,m as N,aB as F,aA as D,D as A,bg as L,F as O,aI as W,k as $}from"./index-BG3V53Zm.js";import{M as G}from"./map-pin-A_8T1VUZ.js";import{R as Q,B as J,E as _,o as V}from"./generateCategoricalChart-OHS7fmG5.js";import{B as Z}from"./BarChart-DhvWEnU2.js";import{X as ee,Y as se}from"./YAxis-bfxb-hpB.js";import{L as ae}from"./lightbulb-DwEPNCzK.js";import{g as re,a as te}from"./benchmark-service-DCVMwDSp.js";const ne={"01":"北海道","02":"青森県","03":"岩手県","04":"宮城県","05":"秋田県","06":"山形県","07":"福島県","08":"茨城県","09":"栃木県",10:"群馬県",11:"埼玉県",12:"千葉県",13:"東京都",14:"神奈川県",15:"新潟県",16:"富山県",17:"石川県",18:"福井県",19:"山梨県",20:"長野県",21:"岐阜県",22:"静岡県",23:"愛知県",24:"三重県",25:"滋賀県",26:"京都府",27:"大阪府",28:"兵庫県",29:"奈良県",30:"和歌山県",31:"鳥取県",32:"島根県",33:"岡山県",34:"広島県",35:"山口県",36:"徳島県",37:"香川県",38:"愛媛県",39:"高知県",40:"福岡県",41:"佐賀県",42:"長崎県",43:"熊本県",44:"大分県",45:"宮崎県",46:"鹿児島県",47:"沖縄県"},ie={1:"~300万円",2:"300~500万円",3:"500~700万円",4:"700~1000万円",5:"1000万円~"};function ce({profile:s}){const{t:a}=b("common");if(!s)return e.jsx(o,{className:"bg-gradient-to-br from-gray-50 to-white dark:from-gray-800 dark:to-gray-900 border-dashed",children:e.jsx(k,{children:e.jsxs("div",{className:"text-center py-6",children:[e.jsx(w,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:a("benchmark.noProfile","Set up your household profile to see comparisons")}),e.jsx(C,{to:"/settings",children:e.jsxs(S,{variant:"outline",size:"sm",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),a("benchmark.setupProfile","Set up profile")]})})]})})});const t=ne[s.prefecture]||s.prefecture,r=ie[s.annual_income_bracket]||s.annual_income_bracket;return e.jsxs(o,{variant:"elevated",className:"border-primary-200 dark:border-primary-800",children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(E,{className:"text-base font-semibold text-gray-900 dark:text-gray-100",children:a("benchmark.yourProfile","Your Household Profile")}),e.jsx(C,{to:"/settings",children:e.jsxs(S,{variant:"ghost",size:"sm",className:"text-xs",children:[e.jsx(B,{className:"w-3 h-3 mr-1"}),a("common.edit","Edit")]})})]})}),e.jsx(k,{children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary-50 dark:bg-primary-900/20",children:e.jsx(w,{className:"w-5 h-5 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-0.5",children:a("benchmark.familySize","Family size")}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",children:[s.family_size===5?"5+":s.family_size," ",a("benchmark.people","people")]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary-50 dark:bg-primary-900/20",children:e.jsx(G,{className:"w-5 h-5 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-0.5",children:a("benchmark.prefecture","Prefecture")}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",children:t})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-primary-50 dark:bg-primary-900/20",children:e.jsx(U,{className:"w-5 h-5 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-0.5",children:a("benchmark.annualIncome","Annual income")}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",children:r})]})]})]})})]})}function de({comparison:s}){const{t:a}=b("common"),{currency:t}=T(),{data:r}=P(),{resolvedTheme:c}=X(),n=c==="dark",p=n?"#1e1e2e":"#fff",g=n?"#45475a":"#E5E7EB",x=n?"#cdd6f4":"#374151",i="hsl(var(--primary-600))",M="#9ca3af",I=s.map(d=>({category:d.category,user:d.user_amount,benchmark:d.benchmark_amount,difference_pct:d.difference_pct,status:d.status})),Y=d=>{const{x:h,y:m,width:f,height:j,index:u}=d,l=s[u];if(!l)return null;const v=l.difference_pct,H=l.status==="over",K=l.status==="under",R=h+f+12;return e.jsx("g",{children:e.jsxs("text",{x:R,y:m+j/2,fill:H?"#ef4444":K?"#22c55e":"#6b7280",textAnchor:"start",dominantBaseline:"middle",fontSize:11,fontWeight:600,children:[v>0?"+":"",v.toFixed(0),"%"]})})},q=Math.max(300,s.length*70);return e.jsxs("div",{className:"w-full",children:[e.jsx(Q,{width:"100%",height:q,children:e.jsxs(Z,{data:I,layout:"vertical",margin:{top:10,right:80,left:10,bottom:10},children:[e.jsx(ee,{type:"number",hide:!0}),e.jsx(se,{type:"category",dataKey:"category",width:110,tick:{fill:x,fontSize:12},axisLine:!1,tickLine:!1}),e.jsx(J,{contentStyle:{backgroundColor:p,border:`1px solid ${g}`,borderRadius:"8px",fontSize:"14px",color:x},content:({active:d,payload:h})=>{if(!d||!(h!=null&&h[0]))return null;const m=h[0].payload,f=m.user,j=m.benchmark,u=m.difference_pct,l=m.status;return e.jsxs("div",{className:"p-3 rounded-lg shadow-lg",style:{backgroundColor:p,border:`1px solid ${g}`},children:[e.jsx("p",{className:"font-semibold mb-2",children:m.category}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("span",{className:"text-primary-600 dark:text-primary-400",children:[a("benchmark.yourSpending","Your spending"),":"]}),e.jsx("span",{className:"font-medium",children:y(f,t,(r==null?void 0:r.rates)||{},!1)})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:[a("benchmark.avgSpending","Average"),":"]}),e.jsx("span",{className:"font-medium",children:y(j,t,(r==null?void 0:r.rates)||{},!1)})]}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600 flex items-center justify-between gap-4",children:[e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[a("benchmark.difference","Difference"),":"]}),e.jsxs("span",{className:N("text-xs font-semibold flex items-center gap-1",l==="over"?"text-expense-600 dark:text-expense-300":l==="under"?"text-income-600 dark:text-income-300":"text-gray-600 dark:text-gray-400"),children:[l==="over"&&e.jsx(F,{className:"w-3 h-3"}),l==="under"&&e.jsx(D,{className:"w-3 h-3"}),u>0?"+":"",u.toFixed(1),"%"]})]})]})]})}}),e.jsx(_,{dataKey:"benchmark",fill:M,radius:[0,4,4,0],maxBarSize:18,isAnimationActive:!0,animationDuration:600}),e.jsx(_,{dataKey:"user",fill:i,radius:[0,4,4,0],maxBarSize:18,isAnimationActive:!0,animationDuration:800,animationBegin:200,children:e.jsx(V,{content:Y})})]})}),e.jsxs("div",{className:"flex items-center justify-center gap-6 mt-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded",style:{backgroundColor:i}}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:a("benchmark.yourSpending","Your spending")})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-gray-400"}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:a("benchmark.avgSpending","Average")})]})]})]})}function le({insights:s,overCategories:a,underCategories:t}){const{t:r}=b("common");return e.jsxs(o,{variant:"glass",className:"border-primary-100 dark:border-primary-900/30",children:[e.jsx(z,{children:e.jsxs(E,{className:"flex items-center gap-2 text-base text-gray-900 dark:text-gray-100",children:[e.jsx(ae,{className:"w-5 h-5 text-yellow-500"}),r("benchmark.insights","Insights")]})}),e.jsxs(k,{children:[e.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none mb-4",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed",children:s})}),(a.length>0||t.length>0)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:[a.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-expense-600 dark:text-expense-300",children:[e.jsx(F,{className:"w-4 h-4"}),r("benchmark.spendingMore","Spending more than average")]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:a.map(c=>e.jsx("span",{className:N("px-2.5 py-1 text-xs font-medium rounded-full","bg-expense-50 dark:bg-expense-900/20 text-expense-600 dark:text-expense-300","border border-expense-300 dark:border-expense-900"),children:c},c))})]}),t.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-income-600 dark:text-income-300",children:[e.jsx(D,{className:"w-4 h-4"}),r("benchmark.spendingLess","Spending less than average")]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:t.map(c=>e.jsx("span",{className:N("px-2.5 py-1 text-xs font-medium rounded-full","bg-income-50 dark:bg-income-900/20 text-income-600 dark:text-income-300","border border-income-300 dark:border-income-900"),children:c},c))})]})]}),a.length===0&&t.length===0&&!s&&e.jsx("div",{className:"text-center py-6 text-gray-400 dark:text-gray-500 text-sm",children:r("benchmark.noInsights","No insights available yet. Add more transactions to generate insights.")})]})]})}function me(){const{t:s}=b("common"),{currency:a}=T(),{data:t}=P(),{data:r,isLoading:c}=A({queryKey:["household-profile"],queryFn:re}),{data:n,isLoading:p,error:g}=A({queryKey:["benchmark-comparison"],queryFn:te,enabled:!!r}),x=c||p;return e.jsxs("div",{className:"max-w-3xl mx-auto px-4 py-6 sm:py-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(L,{className:"w-7 h-7 text-primary-600 dark:text-primary-400"}),s("benchmark.title","Spending Benchmark")]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:s("benchmark.subtitle","Compare your spending against national averages")})]}),e.jsx("div",{className:"mb-6",children:e.jsx(ce,{profile:r||null})}),x&&e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(O,{size:"lg"})}),g&&e.jsx(o,{className:"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(W,{className:"w-5 h-5 text-red-600 dark:text-red-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-900 dark:text-red-200",children:s("benchmark.errorTitle","Failed to load comparison data")}),e.jsx("p",{className:"text-xs text-red-700 dark:text-red-300 mt-1",children:s("benchmark.errorMessage","Please ensure you have transactions recorded and try again.")})]})]})}),!x&&!r&&e.jsx(o,{className:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(L,{className:"w-12 h-12 text-blue-600 dark:text-blue-400 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-blue-900 dark:text-blue-200 font-medium mb-1",children:s("benchmark.setupRequired","Set up your household profile")}),e.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:s("benchmark.setupHint","Go to Settings to configure your family size, prefecture, and income bracket.")})]})}),!x&&!g&&n&&e.jsxs("div",{className:"space-y-6",children:[e.jsx(o,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:s("benchmark.yourTotal","Your Total (3mo avg)")}),e.jsx("p",{className:"text-2xl font-bold text-primary-600 dark:text-primary-400",children:y(n.total_user,a,(t==null?void 0:t.rates)||{},!1)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:s("benchmark.avgTotal","National Average")}),e.jsx("p",{className:"text-2xl font-bold text-gray-500 dark:text-gray-400",children:y(n.total_benchmark,a,(t==null?void 0:t.rates)||{},!1)})]})]})}),e.jsxs(o,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-4",children:s("benchmark.categoryComparison","Category Comparison")}),e.jsx(de,{comparison:n.comparison})]}),n.insights&&e.jsx(le,{insights:n.insights,overCategories:n.comparison.filter(i=>i.status==="over").map(i=>i.category),underCategories:n.comparison.filter(i=>i.status==="under").map(i=>i.category)})]})]})}const be=$("/benchmark")({component:me});export{be as Route};

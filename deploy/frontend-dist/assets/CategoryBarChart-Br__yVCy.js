import{j as t}from"./vendor-tanstack-DOuiVnRb.js";import{r as D}from"./vendor-react-B9eo89kj.js";import{p as E,a4 as S,ac as A,Y as F,c as b}from"./index-COcbc7mT.js";import{u as T}from"./vendor-i18n-CtQU9zWU.js";import{R as L,g as O,X as R,Y as $,T as z,B as _,f as K,e as M}from"./vendor-recharts-BfEtinVu.js";import{v as Y,r as U,u as X}from"./vendor-icons-Boynwk5e.js";import"./vendor-date-fteVm545.js";const m=7,x=["#4CAF50","#2196F3","#FF9800","#9C27B0","#F44336","#00BCD4","#FFEB3B","#795548","#607D8B"];function H({changePercent:r}){if(r==null)return null;const o=r>0,h=Math.abs(r)>=20;return r===0?t.jsxs("span",{className:"inline-flex items-center gap-0.5 text-xs text-gray-500 dark:text-gray-400",children:[t.jsx(Y,{className:"w-3 h-3"}),t.jsx("span",{children:"0%"})]}):t.jsxs("span",{className:b("inline-flex items-center gap-0.5 text-xs font-medium",o?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400",h&&"font-bold"),children:[o?t.jsx(U,{className:"w-3 h-3"}):t.jsx(X,{className:"w-3 h-3"}),t.jsxs("span",{children:[o?"+":"",r.toFixed(0),"%"]})]})}function P({data:r}){const{t:o}=T("common"),{currency:h}=E(),{data:u}=S(),{resolvedTheme:B}=A(),g=B==="dark",[p,v]=D.useState(!1),j=g?"#1e1e2e":"#fff",C=g?"#45475a":"#E5E7EB",f=g?"#cdd6f4":"#374151",l=r.reduce((s,e)=>s+e.amount,0),c=[...r].sort((s,e)=>e.amount-s.amount),y=(()=>{if(c.length<=m||p)return c.map((n,i)=>({...n,percentage:l>0?n.amount/l*100:0,color:x[i%x.length]}));const s=c.slice(0,m),e=c.slice(m),a=e.reduce((n,i)=>n+i.amount,0),d=s.map((n,i)=>({...n,percentage:l>0?n.amount/l*100:0,color:x[i%x.length]}));return e.length>0&&d.push({category:`${o("analytics.otherCategories")} (${e.length})`,amount:a,percentage:l>0?a/l*100:0,color:"#9E9E9E",isOther:!0,otherCount:e.length}),d})(),k=c.length>m,w=s=>{const{x:e,y:a,width:d,height:n,value:i}=s;return t.jsxs("text",{x:e+d+8,y:a+n/2,fill:f,textAnchor:"start",dominantBaseline:"middle",fontSize:12,children:[i.toFixed(1),"%"]})},N=Math.max(200,y.length*32);return t.jsxs("div",{className:"w-full",children:[t.jsx(L,{width:"100%",height:N,children:t.jsxs(O,{data:y,layout:"vertical",margin:{top:5,right:60,left:0,bottom:5},children:[t.jsx(R,{type:"number",hide:!0,domain:[0,100]}),t.jsx($,{type:"category",dataKey:"category",width:100,tick:{fill:f,fontSize:12},axisLine:!1,tickLine:!1}),t.jsx(z,{contentStyle:{backgroundColor:j,border:`1px solid ${C}`,borderRadius:"8px",fontSize:"14px",color:f},content:({active:s,payload:e})=>{if(!s||!(e!=null&&e[0]))return null;const a=e[0].payload,d=a.change_percent!==null&&a.change_percent!==void 0;return t.jsxs("div",{className:"p-3 rounded-lg shadow-lg",style:{backgroundColor:j,border:`1px solid ${C}`},children:[t.jsx("p",{className:"font-medium mb-1",children:a.category}),t.jsx("p",{className:"text-sm",children:F(a.amount,h,(u==null?void 0:u.rates)||{},!1)}),d&&t.jsxs("div",{className:"mt-1 pt-1 border-t border-gray-200 dark:border-gray-600",children:[t.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[o("analytics.vsPrevious"),": "]}),t.jsx(H,{changePercent:a.change_percent})]})]})}}),t.jsxs(_,{dataKey:"percentage",radius:[0,4,4,0],maxBarSize:24,isAnimationActive:!0,animationBegin:0,animationDuration:800,animationEasing:"ease-out",children:[y.map((s,e)=>t.jsx(K,{fill:s.color},`cell-${e}`)),t.jsx(M,{dataKey:"percentage",content:w})]})]})}),k&&t.jsx("button",{onClick:()=>v(!p),className:b("w-full mt-2 py-2 px-4 text-sm font-medium rounded-lg transition-colors","text-primary-600 dark:text-primary-400","hover:bg-primary-50 dark:hover:bg-primary-900/20"),children:p?o("analytics.showLessCategories"):o("analytics.showAllCategories",{count:c.length})})]})}export{P as CategoryBarChart};

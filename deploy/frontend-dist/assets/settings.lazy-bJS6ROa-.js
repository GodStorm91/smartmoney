import{h as Je}from"./vendor-router-CjTheb1B.js";import{r as f,j as e,a as ve,R as A}from"./vendor-react-CezGY3Eh.js";import{b as ne,u as Z,c as D}from"./vendor-query-Dt5Hl5qC.js";import{i as ae,v as I,C as U,r as $,B as R,P as Ze,j as k,T as Ae,f as de,X as Ie,I as Q,a4 as et,a5 as ge,a6 as tt,a7 as Fe,R as at,a8 as Le,a9 as st,aa as rt,ab as nt,ac as Te,ad as it,ae as je,af as Ne,t as se,ag as lt,D as ot,ah as ct,ai as dt}from"./index-BaDR0x1b.js";import{C as ke,c as ut,d as gt,s as mt,a as ht,b as xt,e as J,f as pt,g as yt}from"./crypto-BmDXYGqC.js";import{S as ue}from"./Select-nmni1BR4.js";import{P as ft,R as bt}from"./RecurringTransactionsList-Be4RKqKq.js";import{u as B}from"./vendor-i18n-DHVoooz2.js";import{T as ye}from"./tag-DUNY7dto.js";import{u as vt,a as jt,b as Nt,c as kt}from"./useCategories-RmSVdELm.js";import{T as Ce}from"./triangle-alert-CRUpnPBz.js";import{P as Ct}from"./pencil-DlEsTBgJ.js";import{S as wt}from"./Switch-lNmC0zCA.js";import{M as St}from"./mail-DOzwdCPl.js";import{C as Et}from"./crown-BAtKxydI.js";import{Z as _t,C as Mt}from"./zap--u-pxzMB.js";import{M as Pt}from"./map-pin-xCLFDvDo.js";import{u as Rt,g as At}from"./benchmark-service-BzmspXb7.js";import{D as It}from"./download-C7rRDKmq.js";import"./vendor-charts-Co6UKelL.js";import"./chevron-down-9pup0Dd4.js";import"./recurring-service-BdhlCCMD.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],Lt=ae("link-2",Ft);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],Dt=ae("monitor",Tt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],De=ae("palette",Ot);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],Kt=ae("repeat",zt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],qt=ae("save",Bt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],we=ae("smartphone",Qt);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],Ht=ae("wand-sparkles",Ut);async function Wt(){return(await I.get("/api/category-rules/")).data.rules}async function $t(t){return(await I.post("/api/category-rules/",t)).data}async function Gt(t){await I.delete(`/api/category-rules/${t}`)}async function Yt(t=!0){return(await I.post("/api/category-rules/apply",{dry_run:t})).data}async function Vt(){return(await I.get("/api/category-rules/suggest")).data.suggestions}async function Xt(){return(await I.post("/api/category-rules/seed-defaults")).data}const Jt={contains:"categoryRules.contains",starts_with:"categoryRules.startsWith",exact:"categoryRules.exact"},Zt=["Food","Shopping","Transportation","Utilities","Entertainment","Healthcare","Education","Groceries","Dining","Cafe","Convenience","Transfer","Investment","Clothing","Other"];function ea(){const{t}=B("common"),c=ne(),[i,d]=f.useState(null),[m,g]=f.useState(!1),[p,y]=f.useState(!1),[a,r]=f.useState(null),[s,l]=f.useState(""),[n,u]=f.useState("Other"),[o,x]=f.useState("contains"),{data:h,isLoading:E}=Z({queryKey:["category-rules"],queryFn:Wt}),{data:N,isLoading:b}=Z({queryKey:["category-rules-suggestions"],queryFn:Vt,enabled:p}),C=D({mutationFn:Gt,onSuccess:()=>{c.invalidateQueries({queryKey:["category-rules"]}),d(null)}}),_=D({mutationFn:$t,onSuccess:()=>{c.invalidateQueries({queryKey:["category-rules"]}),l(""),u("Other"),x("contains"),g(!1)}}),S=D({mutationFn:Xt,onSuccess:()=>{c.invalidateQueries({queryKey:["category-rules"]})}}),z=D({mutationFn:v=>Yt(v),onSuccess:(v,K)=>{K?r({count:v.affected_count,applied:!1}):(c.invalidateQueries({queryKey:["transactions"]}),c.invalidateQueries({queryKey:["analytics"]}),r({count:v.affected_count,applied:!0}))}}),O=v=>{confirm(t("confirmDelete"))&&(d(v),C.mutate(v))},H=()=>{s.trim()&&_.mutate({keyword:s.trim(),category:n,match_type:o,priority:10})},F=v=>{_.mutate({keyword:v.keyword,category:v.suggested_category,match_type:"contains",priority:10})};return E?e.jsxs(U,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-purple-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("categoryRules.title")})]}),e.jsx("div",{className:"flex justify-center py-8",children:e.jsx($,{size:"md"})})]}):e.jsxs(ke,{title:t("categoryRules.title"),badge:(h==null?void 0:h.length)||0,children:[e.jsxs("div",{className:"flex items-center justify-end gap-2 mb-4",children:[(!h||h.length===0)&&e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>S.mutate(),disabled:S.isPending,children:[e.jsx(Ht,{className:"w-4 h-4 mr-1"}),S.isPending?t("loading"):t("categoryRules.seedDefaults")]}),e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>g(!m),children:[e.jsx(Ze,{className:"w-4 h-4 mr-1"}),t("categoryRules.addRule")]})]}),m&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsx("input",{type:"text",placeholder:t("categoryRules.keyword"),value:s,onChange:v=>l(v.target.value),className:k("h-10 px-3 border rounded-lg text-sm","bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100","border-gray-300")}),e.jsx("select",{value:n,onChange:v=>u(v.target.value),className:k("h-10 px-3 border rounded-lg text-sm","bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100","border-gray-300"),children:Zt.map(v=>e.jsx("option",{value:v,children:v},v))}),e.jsxs("select",{value:o,onChange:v=>x(v.target.value),className:k("h-10 px-3 border rounded-lg text-sm","bg-white dark:bg-gray-700 dark:border-gray-600 dark:text-gray-100","border-gray-300"),children:[e.jsx("option",{value:"contains",children:t("categoryRules.contains")}),e.jsx("option",{value:"starts_with",children:t("categoryRules.startsWith")}),e.jsx("option",{value:"exact",children:t("categoryRules.exact")})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(R,{variant:"outline",size:"sm",onClick:()=>g(!1),children:t("cancel")}),e.jsx(R,{size:"sm",onClick:H,disabled:!s.trim()||_.isPending,children:_.isPending?t("saving"):t("save")})]})]}),h&&h.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-2 mb-6",children:h.map(v=>e.jsxs("div",{className:k("flex items-center justify-between p-3 rounded-lg border",v.is_active?"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700":"bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-800 opacity-60"),children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("code",{className:"px-2 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded text-sm truncate max-w-[150px]",children:v.keyword}),e.jsx("span",{className:"text-gray-400",children:"â†’"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100 font-medium",children:v.category}),e.jsxs("span",{className:"text-xs text-gray-400 dark:text-gray-500 hidden sm:inline",children:["(",t(Jt[v.match_type]),")"]})]}),e.jsx("button",{onClick:()=>O(v.id),disabled:i===v.id,className:"p-2 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/30 text-red-600 transition-colors",children:i===v.id?e.jsx($,{size:"sm"}):e.jsx(Ae,{className:"w-4 h-4"})})]},v.id))}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("categoryRules.applyDescription")}),a&&e.jsx("p",{className:k("text-sm mt-1",a.applied?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"),children:a.applied?t("categoryRules.appliedCount",{count:a.count}):t("categoryRules.previewCount",{count:a.count})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{variant:"outline",size:"sm",onClick:()=>z.mutate(!0),disabled:z.isPending,children:z.isPending?t("loading"):t("categoryRules.preview")}),e.jsxs(R,{size:"sm",onClick:()=>z.mutate(!1),disabled:z.isPending||(a==null?void 0:a.count)===0,children:[e.jsx(ft,{className:"w-4 h-4 mr-1"}),t("categoryRules.applyNow")]})]})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ye,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t("categoryRules.noRules")}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1",children:t("categoryRules.noRulesDescription")})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4 mt-4",children:[e.jsx("button",{onClick:()=>y(!p),className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:t(p?"categoryRules.hideSuggestions":"categoryRules.showSuggestions")}),p&&e.jsx("div",{className:"mt-4 space-y-2",children:b?e.jsx("div",{className:"flex justify-center py-4",children:e.jsx($,{size:"sm"})}):N&&N.length>0?N.map((v,K)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("code",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded text-sm truncate max-w-[150px]",children:v.keyword}),e.jsx("span",{className:"text-gray-400",children:"â†’"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:v.suggested_category}),e.jsxs("span",{className:"text-xs text-gray-400",children:["(",v.count,"x)"]})]}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>F(v),disabled:_.isPending,children:e.jsx(de,{className:"w-4 h-4"})})]},K)):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:t("categoryRules.noSuggestions")})})]})]})}const ta=["ğŸ“","ğŸ ","ğŸ½ï¸","ğŸš—","ğŸ’¡","ğŸ“±","ğŸ¬","ğŸ›ï¸","ğŸ¥","ğŸ“¦","ğŸ’°","ğŸ","ğŸ“ˆ","ğŸ’¼","ğŸ”„","âœˆï¸","ğŸ“","ğŸ’³","ğŸ¦","ğŸ®","â˜•","ğŸ•","ğŸšŒ","â›½","ğŸ’Š","ğŸ‹ï¸","ğŸ•","ğŸ‘¶","ğŸ’…","ğŸ“š"];function aa({isOpen:t,onClose:c,defaultType:i="expense",onCreated:d}){const{t:m}=B("common"),g=vt(),[p,y]=f.useState(""),[a,r]=f.useState("ğŸ“"),[s,l]=f.useState(i),[n,u]=f.useState(""),o=async E=>{var b,C;E.preventDefault(),u("");const N=p.trim();if(!N){u(m("category.errors.nameRequired","Name is required"));return}try{const S=`custom_${(await g.mutateAsync({name:N,icon:a,type:s})).id}`;d==null||d(S),x()}catch(_){u(((C=(b=_.response)==null?void 0:b.data)==null?void 0:C.detail)||m("category.errors.createFailed","Failed to create category"))}},x=()=>{y(""),r("ğŸ“"),l(i),u(""),c()};if(!t)return null;const h=e.jsxs("div",{className:"fixed inset-0 z-[100001] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:x}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:m("category.createTitle","Create Category")}),e.jsx("button",{onClick:x,className:"p-2.5 -mr-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(Ie,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("category.name","Category Name")}),e.jsx("input",{type:"text",value:p,onChange:E=>y(E.target.value),placeholder:m("category.namePlaceholder","e.g., Subscriptions"),maxLength:50,className:"w-full h-10 px-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-gray-100",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("category.icon","Icon")}),e.jsx("div",{className:"grid grid-cols-10 gap-1",children:ta.map(E=>e.jsx("button",{type:"button",onClick:()=>r(E),className:k("w-8 h-8 text-lg rounded flex items-center justify-center",a===E?"bg-primary-100 dark:bg-primary-900 border-2 border-primary-500":"bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"),children:E},E))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:m("category.type","Type")}),e.jsxs("div",{className:"flex rounded-lg bg-gray-100 dark:bg-gray-700 p-1",children:[e.jsx("button",{type:"button",onClick:()=>l("expense"),className:k("flex-1 py-2 rounded-md text-sm font-medium transition-colors",s==="expense"?"bg-red-500 text-white":"text-gray-600 dark:text-gray-300"),children:m("transaction.expense","Expense")}),e.jsx("button",{type:"button",onClick:()=>l("income"),className:k("flex-1 py-2 rounded-md text-sm font-medium transition-colors",s==="income"?"bg-green-500 text-white":"text-gray-600 dark:text-gray-300"),children:m("transaction.income","Income")})]})]}),n&&e.jsx("p",{className:"text-sm text-red-500",children:n}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:x,className:"flex-1 h-10 border border-gray-300 dark:border-gray-600 rounded-lg font-medium text-gray-700 dark:text-gray-300",children:m("cancel","Cancel")}),e.jsx("button",{type:"submit",disabled:g.isPending,className:"flex-1 h-10 bg-blue-500 text-white rounded-lg font-medium disabled:opacity-50",children:g.isPending?"...":m("create","Create")})]})]})]})]});return typeof document>"u"?null:ve.createPortal(h,document.body)}const sa=["ğŸ“","ğŸ ","ğŸ½ï¸","ğŸš—","ğŸ’¡","ğŸ“±","ğŸ¬","ğŸ›ï¸","ğŸ¥","ğŸ“¦","ğŸ’°","ğŸ","ğŸ“ˆ","ğŸ’¼","ğŸ”„","âœˆï¸","ğŸ“","ğŸ’³","ğŸ¦","ğŸ®","â˜•","ğŸ•","ğŸšŒ","â›½","ğŸ’Š","ğŸ‹ï¸","ğŸ•","ğŸ‘¶","ğŸ’…","ğŸ“š"];function ra({isOpen:t,onClose:c,category:i}){const{t:d}=B("common"),m=ne(),[g,p]=f.useState(""),[y,a]=f.useState("ğŸ“"),[r,s]=f.useState(""),[l,n]=f.useState(null);f.useEffect(()=>{i&&(p(i.name),a(i.icon),s(""),n(null))},[i]);const u=D({mutationFn:N=>jt(i.id,N),onSuccess:N=>{n(N.affected_transactions),m.invalidateQueries({queryKey:["categories"]}),m.invalidateQueries({queryKey:["transactions"]}),setTimeout(()=>{x()},1500)},onError:N=>{var C,_;s(((_=(C=N.response)==null?void 0:C.data)==null?void 0:_.detail)||d("category.errors.updateFailed","Failed to update category"))}}),o=async N=>{N.preventDefault(),s("");const b=g.trim();if(!b){s(d("category.errors.nameRequired","Name is required"));return}const C={};if(b!==(i==null?void 0:i.name)&&(C.name=b),y!==(i==null?void 0:i.icon)&&(C.icon=y),Object.keys(C).length===0){x();return}u.mutate(C)},x=()=>{p(""),a("ğŸ“"),s(""),n(null),c()};if(!t||!i)return null;const h=g.trim()!==i.name,E=e.jsxs("div",{className:"fixed inset-0 z-[100001] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:x}),e.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl w-full max-w-sm p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:d("category.editTitle","Edit Category")}),e.jsx("button",{onClick:x,className:"p-2.5 -mr-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(Ie,{size:20,className:"text-gray-500 dark:text-gray-400"})})]}),l!==null&&e.jsx("div",{className:"mb-4 p-3 bg-green-50 dark:bg-green-900/30 border border-green-200 dark:border-green-800 rounded-lg",children:e.jsxs("p",{className:"text-sm text-green-800 dark:text-green-200",children:[d("category.updateSuccess","Category updated!"),l>0&&e.jsx("span",{className:"block mt-1 text-green-600 dark:text-green-300",children:d("category.transactionsUpdated","{{count}} transactions updated",{count:l})})]})}),e.jsxs("form",{onSubmit:o,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("category.name","Category Name")}),e.jsx("input",{type:"text",value:g,onChange:N=>p(N.target.value),placeholder:d("category.namePlaceholder","e.g., Subscriptions"),maxLength:50,className:"w-full h-10 px-3 border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-gray-100",autoFocus:!0})]}),h&&e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-amber-50 dark:bg-amber-900/30 border border-amber-200 dark:border-amber-800 rounded-lg",children:[e.jsx(Ce,{className:"w-4 h-4 text-amber-600 dark:text-amber-400 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-amber-800 dark:text-amber-200",children:d("category.cascadeWarning","All transactions with this category will be updated to the new name.")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("category.icon","Icon")}),e.jsx("div",{className:"grid grid-cols-10 gap-1",children:sa.map(N=>e.jsx("button",{type:"button",onClick:()=>a(N),className:k("w-8 h-8 text-lg rounded flex items-center justify-center",y===N?"bg-primary-100 dark:bg-primary-900 border-2 border-primary-500":"bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"),children:N},N))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:d("category.type","Type")}),e.jsx("div",{className:k("h-10 px-3 flex items-center rounded-lg text-sm font-medium",i.type==="expense"?"bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-300":"bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300"),children:i.type==="expense"?d("transaction.expense","Expense"):d("transaction.income","Income")})]}),r&&e.jsx("p",{className:"text-sm text-red-500",children:r}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:x,className:"flex-1 h-10 border border-gray-300 dark:border-gray-600 rounded-lg font-medium text-gray-700 dark:text-gray-300",children:d("cancel","Cancel")}),e.jsx("button",{type:"submit",disabled:u.isPending||l!==null,className:"flex-1 h-10 bg-blue-500 text-white rounded-lg font-medium disabled:opacity-50",children:u.isPending?"...":d("save","Save")})]})]})]})]});return typeof document>"u"?null:ve.createPortal(E,document.body)}function na(){const{t}=B("common"),{data:c=[],isLoading:i}=Nt(),d=kt(),[m,g]=f.useState(!1),[p,y]=f.useState(null),[a,r]=f.useState(null),s=async u=>{try{await d.mutateAsync(u),r(null)}catch(o){console.error("Failed to delete category:",o)}},l=c.filter(u=>u.type==="expense"),n=c.filter(u=>u.type==="income");return e.jsxs(e.Fragment,{children:[e.jsxs(ke,{title:t("settings.categoryManagement"),badge:c.length,children:[i?e.jsx("div",{className:"py-4 text-center text-gray-400",children:t("loading")}):c.length===0?e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-center py-4",children:t("settings.noCategories")}):e.jsxs("div",{className:"space-y-4",children:[l.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:t("transaction.expense","Expense")}),e.jsx("div",{className:"space-y-2",children:l.map(u=>e.jsx(_e,{category:u,onEdit:()=>y(u),onDelete:()=>r(u.id),isDeleting:d.isPending&&a===u.id,showDeleteConfirm:a===u.id,onConfirmDelete:()=>s(u.id),onCancelDelete:()=>r(null)},u.id))})]}),n.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:t("transaction.income","Income")}),e.jsx("div",{className:"space-y-2",children:n.map(u=>e.jsx(_e,{category:u,onEdit:()=>y(u),onDelete:()=>r(u.id),isDeleting:d.isPending&&a===u.id,showDeleteConfirm:a===u.id,onConfirmDelete:()=>s(u.id),onCancelDelete:()=>r(null)},u.id))})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(R,{variant:"outline",onClick:()=>g(!0),children:t("settings.addCategory")})})]}),e.jsx(aa,{isOpen:m,onClose:()=>g(!1)}),e.jsx(ra,{isOpen:!!p,onClose:()=>y(null),category:p})]})}function _e({category:t,onEdit:c,onDelete:i,isDeleting:d,showDeleteConfirm:m,onConfirmDelete:g,onCancelDelete:p}){const{t:y}=B("common");return m?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[e.jsx("span",{className:"text-sm text-red-800 dark:text-red-200",children:y("category.deleteConfirm","Delete this category?")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:p,className:"px-3 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:y("cancel")}),e.jsx("button",{onClick:g,disabled:d,className:"px-3 py-1 text-sm bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50",children:d?"...":y("delete")})]})]}):e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:t.icon}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:t.name})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:c,className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded",title:y("edit"),children:e.jsx(Ct,{size:16})}),e.jsx("button",{onClick:i,className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/30 rounded",title:y("delete"),children:e.jsx(Ae,{size:16})})]})]})}const Me=["eth","bsc","polygon"];function ia(){const{t}=B("common"),c=ne(),[i,d]=f.useState(!1),[m,g]=f.useState(""),[p,y]=f.useState(""),[a,r]=f.useState(["eth","bsc","polygon"]),[s,l]=f.useState(!1),[n,u]=f.useState("polygon"),[o,x]=f.useState(""),[h,E]=f.useState(""),[N,b]=f.useState(""),[C,_]=f.useState(null),{data:S,isLoading:z}=Z({queryKey:["crypto-wallets"],queryFn:pt}),{data:O,isLoading:H}=Z({queryKey:["reward-contracts"],queryFn:yt}),F=D({mutationFn:ut,onSuccess:()=>{c.invalidateQueries({queryKey:["crypto-wallets"]}),d(!1),T()}}),v=D({mutationFn:gt,onSuccess:()=>{c.invalidateQueries({queryKey:["crypto-wallets"]})}}),K=D({mutationFn:mt,onSuccess:()=>{c.invalidateQueries({queryKey:["crypto-wallets"]}),c.invalidateQueries({queryKey:["dashboard-summary"]}),_(null)},onError:()=>{_(null)}}),G=D({mutationFn:ht,onSuccess:()=>{c.invalidateQueries({queryKey:["reward-contracts"]}),l(!1),Y()}}),L=D({mutationFn:xt,onSuccess:()=>{c.invalidateQueries({queryKey:["reward-contracts"]})}}),T=()=>{g(""),y(""),r(["eth","bsc","polygon"])},Y=()=>{u("polygon"),x(""),E(""),b("")},W=()=>{if(!m||!m.match(/^0x[a-fA-F0-9]{40}$/)){alert(t("crypto.invalidAddress"));return}F.mutate({wallet_address:m,label:p||void 0,chains:a})},V=j=>{_(j),K.mutate(j)},ee=()=>{if(!o||!o.match(/^0x[a-fA-F0-9]{40}$/)){alert(t("crypto.invalidAddress"));return}G.mutate({chain_id:n,contract_address:o,label:h||void 0,token_symbol:N||void 0})},X=j=>{r(q=>q.includes(j)?q.filter(ie=>ie!==j):[...q,j])};return z||H?e.jsx(U,{children:e.jsx("div",{className:"flex justify-center py-8",children:e.jsx($,{})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(U,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("crypto.wallets")}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>d(!i),children:t(i?"cancel":"crypto.addWallet")})]}),i&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-4",children:[e.jsx(Q,{label:t("crypto.walletAddress"),placeholder:"0x...",value:m,onChange:j=>g(j.target.value)}),e.jsx(Q,{label:t("crypto.walletLabel"),placeholder:t("crypto.labelPlaceholder"),value:p,onChange:j=>y(j.target.value)}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t("crypto.chains")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Me.map(j=>e.jsxs("button",{type:"button",onClick:()=>X(j),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${a.includes(j)?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:[J[j].icon," ",J[j].name]},j))})]}),e.jsx(R,{onClick:W,disabled:F.isPending,className:"w-full",children:F.isPending?t("loading"):t("crypto.addWallet")})]}),e.jsx("div",{className:"space-y-3",children:S&&S.length>0?S.map(j=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:j.label||t("crypto.unnamedWallet")}),e.jsx("div",{className:"flex gap-1",children:j.chains.map(q=>e.jsx("span",{title:J[q].name,children:J[q].icon},q))})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono truncate",children:j.wallet_address})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx(R,{variant:"outline",size:"sm",onClick:()=>V(j.id),disabled:C===j.id,children:C===j.id?e.jsx($,{size:"sm"}):t("crypto.sync")}),e.jsx("button",{onClick:()=>{confirm(t("crypto.confirmDeleteWallet"))&&v.mutate(j.id)},className:"text-red-600 hover:text-red-700 text-sm",children:t("delete")})]})]},j.id)):e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-center py-4",children:t("crypto.noWallets")})})]}),e.jsxs(U,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t("crypto.rewardContracts")}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t("crypto.rewardContractsDescription")})]}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>l(!s),children:t(s?"cancel":"crypto.addContract")})]}),s&&e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:t("crypto.chain")}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Me.map(j=>e.jsxs("button",{type:"button",onClick:()=>u(j),className:`px-3 py-1.5 rounded-full text-sm font-medium transition-colors ${n===j?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:[J[j].icon," ",J[j].name]},j))})]}),e.jsx(Q,{label:t("crypto.contractAddress"),placeholder:"0x...",value:o,onChange:j=>x(j.target.value)}),e.jsx(Q,{label:t("crypto.contractLabel"),placeholder:t("crypto.contractLabelPlaceholder"),value:h,onChange:j=>E(j.target.value)}),e.jsx(Q,{label:t("crypto.tokenSymbol"),placeholder:"STEER",value:N,onChange:j=>b(j.target.value)}),e.jsx(R,{onClick:ee,disabled:G.isPending,className:"w-full",children:G.isPending?t("loading"):t("crypto.addContract")})]}),e.jsx("div",{className:"space-y-3",children:O&&O.length>0?O.map(j=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{title:J[j.chain_id].name,children:J[j.chain_id].icon}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:j.label||t("crypto.unnamedContract")}),j.token_symbol&&e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 text-xs rounded",children:j.token_symbol})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono truncate",children:j.contract_address})]}),e.jsx("button",{onClick:()=>{confirm(t("crypto.confirmDeleteContract"))&&L.mutate(j.id)},className:"text-red-600 hover:text-red-700 text-sm ml-4",children:t("delete")})]},j.id)):e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-center py-4",children:t("crypto.noContracts")})})]})]})}function la(){const{t}=B("common"),c=ne(),{data:i,isLoading:d,error:m}=Z({queryKey:["anomalyConfig"],queryFn:tt}),g=D({mutationFn:n=>et(n),onSuccess:()=>{c.invalidateQueries({queryKey:["anomalyConfig"]})}}),[p,y]=f.useState({sensitivity:"medium",large_transaction_threshold:1e4,unusual_spending_percent:50,recurring_change_percent:20,duplicate_charge_hours:24,enabled_types:["large_transaction","category_shift","duplicate"]});f.useEffect(()=>{i&&y({sensitivity:i.sensitivity,large_transaction_threshold:i.large_transaction_threshold,unusual_spending_percent:i.unusual_spending_percent,recurring_change_percent:i.recurring_change_percent,duplicate_charge_hours:i.duplicate_charge_hours,enabled_types:i.enabled_types||["large_transaction","category_shift","duplicate"]})},[i]);const a=()=>{g.mutate(p)},r=n=>{y(u=>{const o=u.enabled_types||[],x=o.includes(n)?o.filter(h=>h!==n):[...o,n];return{...u,enabled_types:x}})},s=[{key:"large_transaction",label:t("anomaly.type.large_transaction")},{key:"category_shift",label:t("anomaly.type.category_shift")},{key:"duplicate",label:t("anomaly.type.duplicate")},{key:"recurring_change",label:t("anomaly.type.recurring_change")},{key:"ml_detected",label:t("anomaly.type.ml_detected")}],l=[{value:"low",label:t("anomaly.config.sensitivityOptions.low")},{value:"medium",label:t("anomaly.config.sensitivityOptions.medium")},{value:"high",label:t("anomaly.config.sensitivityOptions.high")}];return d?e.jsx(U,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-1/3"}),e.jsx("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded"}),e.jsx("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded"})]})}):m?e.jsxs(U,{className:"p-6 text-center text-gray-500",children:[e.jsx(Ce,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:t("common.noData")})]}):e.jsxs(U,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(ge,{className:"w-5 h-5 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold",children:t("anomaly.config.title")})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(ue,{label:t("anomaly.config.sensitivity"),value:p.sensitivity,onChange:n=>y({...p,sensitivity:n.target.value}),options:l}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Q,{type:"number",label:t("anomaly.config.largeTransactionThreshold"),value:p.large_transaction_threshold,onChange:n=>y({...p,large_transaction_threshold:parseInt(n.target.value)||0})}),e.jsx(Q,{type:"number",label:t("anomaly.config.unusualSpendingPercent"),value:p.unusual_spending_percent,onChange:n=>y({...p,unusual_spending_percent:parseInt(n.target.value)||0})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Q,{type:"number",label:t("anomaly.config.recurringChangePercent"),value:p.recurring_change_percent,onChange:n=>y({...p,recurring_change_percent:parseInt(n.target.value)||0})}),e.jsx(Q,{type:"number",label:t("anomaly.config.duplicateChargeHours"),value:p.duplicate_charge_hours,onChange:n=>y({...p,duplicate_charge_hours:parseInt(n.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:t("anomaly.config.enabledTypes")}),e.jsx("div",{className:"space-y-3",children:s.map(n=>{const u=(p.enabled_types||[]).includes(n.key);return e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gray-50 dark:bg-gray-800/50",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:n.label}),e.jsx(wt,{checked:u,onChange:()=>r(n.key)})]},n.key)})})]}),e.jsx(R,{onClick:a,disabled:g.isPending,className:"w-full",children:g.isPending?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"animate-spin",children:"â³"}),t("common.saving")]}):e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4"}),t("anomaly.config.save")]})}),g.isSuccess&&e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 text-center",children:t("anomaly.config.saved")})]})]})}const pe={async getNotifications(t){const c=new URLSearchParams;return t!=null&&t.unreadOnly&&c.append("unread_only","true"),t!=null&&t.limit&&c.append("limit",String(t.limit)),t!=null&&t.offset&&c.append("offset",String(t.offset)),t!=null&&t.type&&c.append("type",t.type),(await I.get(`/api/notifications?${c}`)).data},async getUnreadCount(){return(await I.get("/api/notifications/unread/count")).data},async markAsRead(t){return(await I.put(`/api/notifications/${t}/read`,{})).data},async markAllAsRead(){return(await I.put("/api/notifications/read-all",{})).data},async deleteNotification(t){return(await I.delete(`/api/notifications/${t}`)).data},async cleanupOldNotifications(t=30){return(await I.post("/api/notifications/cleanup",{days_old:t})).data},async getPreferences(){return(await I.get("/api/notifications/preferences")).data},async updatePreference(t,c,i){return(await I.put(`/api/notifications/preferences/${t}`,{enabled:c,settings:i})).data},async subscribePush(t){return(await I.post("/api/notifications/push/subscribe",t)).data},async unsubscribePush(){return(await I.post("/api/notifications/push/unsubscribe",{})).data}};function oa(){return typeof window>"u"?!1:"serviceWorker"in navigator&&"PushManager"in window}async function ca(){return typeof window>"u"?"denied":await Notification.requestPermission()}function da(){return""}function ua(){const{t}=B("common"),c=ne(),[i,d]=f.useState(!1),[m,g]=f.useState(!1),{data:p,isLoading:y}=Z({queryKey:["notification-preferences"],queryFn:pe.getPreferences}),a=D({mutationFn:({channel:o,enabled:x,settings:h})=>pe.updatePreference(o,x,h),onSuccess:()=>{c.invalidateQueries({queryKey:["notification-preferences"]})}}),r=(p==null?void 0:p.preferences)||[];f.useEffect(()=>{(async()=>{if(oa()){const x=await Notification.permission;d(x==="granted")}})()},[]);const s=(o,x)=>{a.mutate({channel:o,enabled:!x})},l=async()=>{g(!0);try{if(await ca()==="granted"&&(d(!0),"serviceWorker"in navigator&&"PushManager"in window)){const h=await(await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:da()});await pe.subscribePush(h.toJSON())}}catch(o){console.error("Failed to enable push notifications:",o)}finally{g(!1)}},n=o=>r.find(x=>x.channel===o),u=[{id:"push",icon:we,label:t("notifications.channels.push"),description:t("notifications.channels.pushDescription"),getEnabled:()=>i,onToggle:l},{id:"email",icon:St,label:t("notifications.channels.email"),description:t("notifications.channels.emailDescription"),getEnabled:()=>{var o;return((o=n("email"))==null?void 0:o.enabled)??!0},onToggle:()=>{var o;return s("email",((o=n("email"))==null?void 0:o.enabled)??!0)}},{id:"in_app",icon:Fe,label:t("notifications.channels.inApp"),description:t("notifications.channels.inAppDescription"),getEnabled:()=>{var o;return((o=n("in_app"))==null?void 0:o.enabled)??!0},onToggle:()=>{var o;return s("in_app",((o=n("in_app"))==null?void 0:o.enabled)??!0)}}];return y?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx($,{size:"lg"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(U,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ge,{className:"w-5 h-5 text-primary-600 dark:text-primary-400"}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:t("notifications.channels.title")})]}),e.jsx("div",{className:"space-y-4",children:u.map(o=>{const x=o.icon,h=o.getEnabled();return e.jsxs("div",{className:k("flex items-center justify-between p-3 rounded-lg border transition-colors",h?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-gray-50 dark:bg-gray-700/50 border-gray-200 dark:border-gray-600"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:k("p-2 rounded-lg",h?"bg-green-100 dark:bg-green-900/50":"bg-gray-200 dark:bg-gray-600"),children:e.jsx(x,{className:k("w-5 h-5",h?"text-green-600 dark:text-green-400":"text-gray-500 dark:text-gray-400")})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:o.label}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:o.description})]})]}),e.jsx("button",{onClick:o.onToggle,disabled:o.id==="push"&&m,className:k("relative inline-flex h-7 w-12 items-center rounded-full transition-colors flex-shrink-0",h?"bg-green-500":"bg-gray-300 dark:bg-gray-600"),children:e.jsx("span",{className:k("inline-block h-5 w-5 transform rounded-full bg-white transition-transform shadow-sm",h?"translate-x-6":"translate-x-1")})})]},o.id)})})]}),e.jsxs(U,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:t("notifications.types.title")}),e.jsx("div",{className:"space-y-3",children:[{key:"budget_alert",label:t("notifications.types.budget")},{key:"bill_reminder",label:t("notifications.types.bills")},{key:"anomaly_detected",label:t("notifications.types.anomalies")},{key:"goal_milestone",label:t("notifications.types.goals")},{key:"savings_tip",label:t("notifications.types.savings")},{key:"burn_rate_warning",label:t("notifications.types.burnRate")}].map(o=>{const x=n(o.key),h=(x==null?void 0:x.enabled)??!0;return e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:o.label}),e.jsx("button",{onClick:()=>s(o.key,!h),className:k("relative inline-flex h-6 w-11 items-center rounded-full transition-colors",h?"bg-primary-600":"bg-gray-300 dark:bg-gray-600"),children:e.jsx("span",{className:k("inline-block h-4 w-4 transform rounded-full bg-white transition-transform",h?"translate-x-6":"translate-x-1")})})]},o.key)})})]}),e.jsxs(U,{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:t("notifications.quietHours.title")}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("notifications.quietHours.description")})}),e.jsxs(R,{variant:"outline",size:"sm",children:[e.jsx(at,{className:"w-4 h-4 mr-2"}),t("notifications.quietHours.configure")]})]})]})]})}const ga={default:"appearance.themes.default","catppuccin-latte":"appearance.themes.catppuccinLatte","catppuccin-frappe":"appearance.themes.catppuccinFrappe","catppuccin-macchiato":"appearance.themes.catppuccinMacchiato","catppuccin-mocha":"appearance.themes.catppuccinMocha",dracula:"appearance.themes.dracula","dracula-light":"appearance.themes.draculaLight"},ma={default:"Default","catppuccin-latte":"Catppuccin Latte","catppuccin-frappe":"Catppuccin Frappe","catppuccin-macchiato":"Catppuccin Macchiato","catppuccin-mocha":"Catppuccin Mocha",dracula:"Dracula","dracula-light":"Dracula Light"};function ha(){const{t}=B("common"),{colorTheme:c,setColorTheme:i}=Le();return e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:st.map(d=>{const m=c===d.id,{base:g,surface:p,text:y,primary:a}=d.preview;return e.jsxs("button",{onClick:()=>i(d.id),className:k("relative flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all",m?"border-primary-500 ring-2 ring-primary-500/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"),children:[e.jsx("div",{className:"w-full aspect-[4/3] rounded-lg overflow-hidden border border-black/10",style:{backgroundColor:g},children:e.jsxs("div",{className:"p-2 h-full flex flex-col gap-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:a}}),e.jsx("div",{className:"h-1.5 rounded-full flex-1",style:{backgroundColor:y,opacity:.3}})]}),e.jsx("div",{className:"flex-1 rounded",style:{backgroundColor:p},children:e.jsxs("div",{className:"p-1.5 flex flex-col gap-1",children:[e.jsx("div",{className:"h-1 rounded-full w-3/4",style:{backgroundColor:y,opacity:.5}}),e.jsx("div",{className:"h-1 rounded-full w-1/2",style:{backgroundColor:y,opacity:.3}}),e.jsx("div",{className:"h-1.5 rounded-full w-2/5 mt-0.5",style:{backgroundColor:a}})]})})]})}),e.jsx("span",{className:k("text-xs font-medium truncate w-full text-center",m?"text-primary-700 dark:text-primary-300":"text-gray-600 dark:text-gray-400"),children:t(ga[d.id],ma[d.id])}),m&&e.jsx("div",{className:"absolute top-1.5 right-1.5 w-5 h-5 rounded-full bg-primary-500 flex items-center justify-center",children:e.jsx(de,{className:"w-3 h-3 text-white"})})]},d.id)})})}const xa=[{code:"ja",nameKey:"language.japanese",flag:"ğŸ‡¯ğŸ‡µ"},{code:"en",nameKey:"language.english",flag:"ğŸ‡ºğŸ‡¸"},{code:"vi",nameKey:"language.vietnamese",flag:"ğŸ‡»ğŸ‡³"}];function pa(){const{t,i18n:c}=B("common"),{theme:i,setTheme:d,accentColor:m,setAccentColor:g,colorTheme:p,tier:y,setTier:a}=Le(),r=[{id:"light",icon:rt,label:t("appearance.light","Light")},{id:"dark",icon:nt,label:t("appearance.dark","Dark")},{id:"system",icon:Dt,label:t("appearance.system","System")}],s=[{id:"pro",icon:Et,label:t("appearance.pro","Pro"),desc:t("appearance.proDesc","Full access, all items visible")},{id:"lite",icon:_t,label:t("appearance.lite","Lite"),desc:t("appearance.liteDesc","Simplified view, fewer items per page")}],l={green:t("appearance.colors.emerald","Emerald"),blue:t("appearance.colors.ocean","Ocean"),purple:t("appearance.colors.royal","Royal"),orange:t("appearance.colors.sunset","Sunset"),rose:t("appearance.colors.rose","Rose"),teal:t("appearance.colors.teal","Teal")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4 text-primary-500"}),t("appearance.language","Language")]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:xa.map(({code:n,nameKey:u,flag:o})=>e.jsxs("button",{onClick:()=>c.changeLanguage(n),className:k("flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all",c.language===n?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"),children:[e.jsx("span",{className:"text-2xl",children:o}),e.jsx("span",{className:k("text-xs font-medium",c.language===n?"text-primary-700 dark:text-primary-300":"text-gray-600 dark:text-gray-400"),children:t(u)})]},n))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:t("appearance.themeMode","Theme Mode")}),p!=="default"?e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 italic",children:t("appearance.themeControlled","Controlled by theme")}):e.jsx("div",{className:"grid grid-cols-3 gap-2",children:r.map(({id:n,icon:u,label:o})=>e.jsxs("button",{onClick:()=>d(n),className:k("flex flex-col items-center gap-2 p-3 rounded-xl border-2 transition-all",i===n?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"),children:[e.jsx(u,{className:k("w-5 h-5",i===n?"text-primary-600 dark:text-primary-400":"text-gray-500 dark:text-gray-400")}),e.jsx("span",{className:k("text-xs font-medium",i===n?"text-primary-700 dark:text-primary-300":"text-gray-600 dark:text-gray-400"),children:o})]},n))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:t("appearance.colorTheme","Color Theme")}),e.jsx(ha,{})]}),p==="default"&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:t("appearance.accentColor","Accent Color")}),e.jsx("div",{className:"flex flex-wrap gap-3",children:it.map(n=>e.jsxs("button",{onClick:()=>g(n.id),className:"group flex flex-col items-center gap-1.5",title:l[n.id]||n.label,children:[e.jsx("div",{className:k("w-10 h-10 rounded-full transition-all ring-offset-2 ring-offset-white dark:ring-offset-gray-900",m===n.id?"ring-2 ring-gray-900 dark:ring-white scale-110":"ring-1 ring-gray-200 dark:ring-gray-700 group-hover:scale-105"),style:{backgroundColor:n.preview}}),e.jsx("span",{className:k("text-[10px] font-medium",m===n.id?"text-gray-900 dark:text-gray-100":"text-gray-500 dark:text-gray-500"),children:l[n.id]||n.label})]},n.id))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 mb-3",children:t("appearance.displayMode","Display Mode")}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:s.map(({id:n,icon:u,label:o,desc:x})=>e.jsxs("button",{onClick:()=>a(n),className:k("flex flex-col items-start gap-2 p-4 rounded-xl border-2 transition-all text-left",y===n?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:k("w-4 h-4",y===n?"text-primary-600 dark:text-primary-400":"text-gray-500")}),e.jsx("span",{className:k("text-sm font-semibold",y===n?"text-primary-700 dark:text-primary-300":"text-gray-700 dark:text-gray-300"),children:o})]}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:x})]},n))})]})]})}const ya=[{value:"01",label:"åŒ—æµ·é“"},{value:"02",label:"é’æ£®çœŒ"},{value:"03",label:"å²©æ‰‹çœŒ"},{value:"04",label:"å®®åŸçœŒ"},{value:"05",label:"ç§‹ç”°çœŒ"},{value:"06",label:"å±±å½¢çœŒ"},{value:"07",label:"ç¦å³¶çœŒ"},{value:"08",label:"èŒ¨åŸçœŒ"},{value:"09",label:"æ ƒæœ¨çœŒ"},{value:"10",label:"ç¾¤é¦¬çœŒ"},{value:"11",label:"åŸ¼ç‰çœŒ"},{value:"12",label:"åƒè‘‰çœŒ"},{value:"13",label:"æ±äº¬éƒ½"},{value:"14",label:"ç¥å¥ˆå·çœŒ"},{value:"15",label:"æ–°æ½ŸçœŒ"},{value:"16",label:"å¯Œå±±çœŒ"},{value:"17",label:"çŸ³å·çœŒ"},{value:"18",label:"ç¦äº•çœŒ"},{value:"19",label:"å±±æ¢¨çœŒ"},{value:"20",label:"é•·é‡çœŒ"},{value:"21",label:"å²é˜œçœŒ"},{value:"22",label:"é™å²¡çœŒ"},{value:"23",label:"æ„›çŸ¥çœŒ"},{value:"24",label:"ä¸‰é‡çœŒ"},{value:"25",label:"æ»‹è³€çœŒ"},{value:"26",label:"äº¬éƒ½åºœ"},{value:"27",label:"å¤§é˜ªåºœ"},{value:"28",label:"å…µåº«çœŒ"},{value:"29",label:"å¥ˆè‰¯çœŒ"},{value:"30",label:"å’Œæ­Œå±±çœŒ"},{value:"31",label:"é³¥å–çœŒ"},{value:"32",label:"å³¶æ ¹çœŒ"},{value:"33",label:"å²¡å±±çœŒ"},{value:"34",label:"åºƒå³¶çœŒ"},{value:"35",label:"å±±å£çœŒ"},{value:"36",label:"å¾³å³¶çœŒ"},{value:"37",label:"é¦™å·çœŒ"},{value:"38",label:"æ„›åª›çœŒ"},{value:"39",label:"é«˜çŸ¥çœŒ"},{value:"40",label:"ç¦å²¡çœŒ"},{value:"41",label:"ä½è³€çœŒ"},{value:"42",label:"é•·å´çœŒ"},{value:"43",label:"ç†Šæœ¬çœŒ"},{value:"44",label:"å¤§åˆ†çœŒ"},{value:"45",label:"å®®å´çœŒ"},{value:"46",label:"é¹¿å…å³¶çœŒ"},{value:"47",label:"æ²–ç¸„çœŒ"}],fa=[{value:"1",label:"~300ä¸‡å††"},{value:"2",label:"300~500ä¸‡å††"},{value:"3",label:"500~700ä¸‡å††"},{value:"4",label:"700~1000ä¸‡å††"},{value:"5",label:"1000ä¸‡å††~"}],ba=[{value:"1",label:"1äºº"},{value:"2",label:"2äºº"},{value:"3",label:"3äºº"},{value:"4",label:"4äºº"},{value:"5",label:"5äººä»¥ä¸Š"}];function va({profile:t,onSave:c,isLoading:i}){const{t:d}=B("common"),[m,g]=f.useState("2"),[p,y]=f.useState("13"),[a,r]=f.useState("3");f.useEffect(()=>{t&&(g(String(t.family_size)),y(t.prefecture),r(t.annual_income_bracket))},[t]);const s=n=>{n.preventDefault(),c({family_size:parseInt(m),prefecture:p,annual_income_bracket:a})},l=t?m!==String(t.family_size)||p!==t.prefecture||a!==t.annual_income_bracket:!0;return e.jsxs("form",{onSubmit:s,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(je,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"}),d("benchmark.familySize","Family size")]}),e.jsx(ue,{value:m,onChange:n=>g(n.target.value),options:ba,disabled:i})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(Pt,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"}),d("benchmark.prefecture","Prefecture")]}),e.jsx(ue,{value:p,onChange:n=>y(n.target.value),options:ya,disabled:i})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:[e.jsx(Ne,{className:"w-4 h-4 text-primary-600 dark:text-primary-400"}),d("benchmark.annualIncome","Annual income bracket")]}),e.jsx(ue,{value:a,onChange:n=>r(n.target.value),options:fa,disabled:i})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsx(R,{type:"submit",disabled:!l||i,className:k("min-w-[120px]",!l&&"opacity-50 cursor-not-allowed"),children:i?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),d("common.saving","Saving...")]}):d("common.save","Save")})})]})}async function ja(){return(await I.post("/api/export/ios/link")).data}async function Na(){const t=await I.get("/api/export/ios",{responseType:"blob"}),c=t.headers["content-disposition"];let i=`smartmoney-export-${new Date().toISOString().slice(0,10)}.json`;if(c){const p=c.match(/filename="?([^";\n]+)"?/);p!=null&&p[1]&&(i=p[1])}const d=new Blob([t.data],{type:"application/json"}),m=window.URL.createObjectURL(d),g=document.createElement("a");g.href=m,g.download=i,document.body.appendChild(g),g.click(),document.body.removeChild(g),window.URL.revokeObjectURL(m)}var ka=Object.defineProperty,me=Object.getOwnPropertySymbols,Oe=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable,Pe=(t,c,i)=>c in t?ka(t,c,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[c]=i,fe=(t,c)=>{for(var i in c||(c={}))Oe.call(c,i)&&Pe(t,i,c[i]);if(me)for(var i of me(c))ze.call(c,i)&&Pe(t,i,c[i]);return t},be=(t,c)=>{var i={};for(var d in t)Oe.call(t,d)&&c.indexOf(d)<0&&(i[d]=t[d]);if(t!=null&&me)for(var d of me(t))c.indexOf(d)<0&&ze.call(t,d)&&(i[d]=t[d]);return i};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var te;(t=>{const c=class w{constructor(a,r,s,l){if(this.version=a,this.errorCorrectionLevel=r,this.modules=[],this.isFunction=[],a<w.MIN_VERSION||a>w.MAX_VERSION)throw new RangeError("Version value out of range");if(l<-1||l>7)throw new RangeError("Mask value out of range");this.size=a*4+17;let n=[];for(let o=0;o<this.size;o++)n.push(!1);for(let o=0;o<this.size;o++)this.modules.push(n.slice()),this.isFunction.push(n.slice());this.drawFunctionPatterns();const u=this.addEccAndInterleave(s);if(this.drawCodewords(u),l==-1){let o=1e9;for(let x=0;x<8;x++){this.applyMask(x),this.drawFormatBits(x);const h=this.getPenaltyScore();h<o&&(l=x,o=h),this.applyMask(x)}}m(0<=l&&l<=7),this.mask=l,this.applyMask(l),this.drawFormatBits(l),this.isFunction=[]}static encodeText(a,r){const s=t.QrSegment.makeSegments(a);return w.encodeSegments(s,r)}static encodeBinary(a,r){const s=t.QrSegment.makeBytes(a);return w.encodeSegments([s],r)}static encodeSegments(a,r,s=1,l=40,n=-1,u=!0){if(!(w.MIN_VERSION<=s&&s<=l&&l<=w.MAX_VERSION)||n<-1||n>7)throw new RangeError("Invalid value");let o,x;for(o=s;;o++){const b=w.getNumDataCodewords(o,r)*8,C=p.getTotalBits(a,o);if(C<=b){x=C;break}if(o>=l)throw new RangeError("Data too long")}for(const b of[w.Ecc.MEDIUM,w.Ecc.QUARTILE,w.Ecc.HIGH])u&&x<=w.getNumDataCodewords(o,b)*8&&(r=b);let h=[];for(const b of a){i(b.mode.modeBits,4,h),i(b.numChars,b.mode.numCharCountBits(o),h);for(const C of b.getData())h.push(C)}m(h.length==x);const E=w.getNumDataCodewords(o,r)*8;m(h.length<=E),i(0,Math.min(4,E-h.length),h),i(0,(8-h.length%8)%8,h),m(h.length%8==0);for(let b=236;h.length<E;b^=253)i(b,8,h);let N=[];for(;N.length*8<h.length;)N.push(0);return h.forEach((b,C)=>N[C>>>3]|=b<<7-(C&7)),new w(o,r,N,n)}getModule(a,r){return 0<=a&&a<this.size&&0<=r&&r<this.size&&this.modules[r][a]}getModules(){return this.modules}drawFunctionPatterns(){for(let s=0;s<this.size;s++)this.setFunctionModule(6,s,s%2==0),this.setFunctionModule(s,6,s%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const a=this.getAlignmentPatternPositions(),r=a.length;for(let s=0;s<r;s++)for(let l=0;l<r;l++)s==0&&l==0||s==0&&l==r-1||s==r-1&&l==0||this.drawAlignmentPattern(a[s],a[l]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(a){const r=this.errorCorrectionLevel.formatBits<<3|a;let s=r;for(let n=0;n<10;n++)s=s<<1^(s>>>9)*1335;const l=(r<<10|s)^21522;m(l>>>15==0);for(let n=0;n<=5;n++)this.setFunctionModule(8,n,d(l,n));this.setFunctionModule(8,7,d(l,6)),this.setFunctionModule(8,8,d(l,7)),this.setFunctionModule(7,8,d(l,8));for(let n=9;n<15;n++)this.setFunctionModule(14-n,8,d(l,n));for(let n=0;n<8;n++)this.setFunctionModule(this.size-1-n,8,d(l,n));for(let n=8;n<15;n++)this.setFunctionModule(8,this.size-15+n,d(l,n));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let a=this.version;for(let s=0;s<12;s++)a=a<<1^(a>>>11)*7973;const r=this.version<<12|a;m(r>>>18==0);for(let s=0;s<18;s++){const l=d(r,s),n=this.size-11+s%3,u=Math.floor(s/3);this.setFunctionModule(n,u,l),this.setFunctionModule(u,n,l)}}drawFinderPattern(a,r){for(let s=-4;s<=4;s++)for(let l=-4;l<=4;l++){const n=Math.max(Math.abs(l),Math.abs(s)),u=a+l,o=r+s;0<=u&&u<this.size&&0<=o&&o<this.size&&this.setFunctionModule(u,o,n!=2&&n!=4)}}drawAlignmentPattern(a,r){for(let s=-2;s<=2;s++)for(let l=-2;l<=2;l++)this.setFunctionModule(a+l,r+s,Math.max(Math.abs(l),Math.abs(s))!=1)}setFunctionModule(a,r,s){this.modules[r][a]=s,this.isFunction[r][a]=!0}addEccAndInterleave(a){const r=this.version,s=this.errorCorrectionLevel;if(a.length!=w.getNumDataCodewords(r,s))throw new RangeError("Invalid argument");const l=w.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][r],n=w.ECC_CODEWORDS_PER_BLOCK[s.ordinal][r],u=Math.floor(w.getNumRawDataModules(r)/8),o=l-u%l,x=Math.floor(u/l);let h=[];const E=w.reedSolomonComputeDivisor(n);for(let b=0,C=0;b<l;b++){let _=a.slice(C,C+x-n+(b<o?0:1));C+=_.length;const S=w.reedSolomonComputeRemainder(_,E);b<o&&_.push(0),h.push(_.concat(S))}let N=[];for(let b=0;b<h[0].length;b++)h.forEach((C,_)=>{(b!=x-n||_>=o)&&N.push(C[b])});return m(N.length==u),N}drawCodewords(a){if(a.length!=Math.floor(w.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let r=0;for(let s=this.size-1;s>=1;s-=2){s==6&&(s=5);for(let l=0;l<this.size;l++)for(let n=0;n<2;n++){const u=s-n,x=(s+1&2)==0?this.size-1-l:l;!this.isFunction[x][u]&&r<a.length*8&&(this.modules[x][u]=d(a[r>>>3],7-(r&7)),r++)}}m(r==a.length*8)}applyMask(a){if(a<0||a>7)throw new RangeError("Mask value out of range");for(let r=0;r<this.size;r++)for(let s=0;s<this.size;s++){let l;switch(a){case 0:l=(s+r)%2==0;break;case 1:l=r%2==0;break;case 2:l=s%3==0;break;case 3:l=(s+r)%3==0;break;case 4:l=(Math.floor(s/3)+Math.floor(r/2))%2==0;break;case 5:l=s*r%2+s*r%3==0;break;case 6:l=(s*r%2+s*r%3)%2==0;break;case 7:l=((s+r)%2+s*r%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[r][s]&&l&&(this.modules[r][s]=!this.modules[r][s])}}getPenaltyScore(){let a=0;for(let n=0;n<this.size;n++){let u=!1,o=0,x=[0,0,0,0,0,0,0];for(let h=0;h<this.size;h++)this.modules[n][h]==u?(o++,o==5?a+=w.PENALTY_N1:o>5&&a++):(this.finderPenaltyAddHistory(o,x),u||(a+=this.finderPenaltyCountPatterns(x)*w.PENALTY_N3),u=this.modules[n][h],o=1);a+=this.finderPenaltyTerminateAndCount(u,o,x)*w.PENALTY_N3}for(let n=0;n<this.size;n++){let u=!1,o=0,x=[0,0,0,0,0,0,0];for(let h=0;h<this.size;h++)this.modules[h][n]==u?(o++,o==5?a+=w.PENALTY_N1:o>5&&a++):(this.finderPenaltyAddHistory(o,x),u||(a+=this.finderPenaltyCountPatterns(x)*w.PENALTY_N3),u=this.modules[h][n],o=1);a+=this.finderPenaltyTerminateAndCount(u,o,x)*w.PENALTY_N3}for(let n=0;n<this.size-1;n++)for(let u=0;u<this.size-1;u++){const o=this.modules[n][u];o==this.modules[n][u+1]&&o==this.modules[n+1][u]&&o==this.modules[n+1][u+1]&&(a+=w.PENALTY_N2)}let r=0;for(const n of this.modules)r=n.reduce((u,o)=>u+(o?1:0),r);const s=this.size*this.size,l=Math.ceil(Math.abs(r*20-s*10)/s)-1;return m(0<=l&&l<=9),a+=l*w.PENALTY_N4,m(0<=a&&a<=2568888),a}getAlignmentPatternPositions(){if(this.version==1)return[];{const a=Math.floor(this.version/7)+2,r=this.version==32?26:Math.ceil((this.version*4+4)/(a*2-2))*2;let s=[6];for(let l=this.size-7;s.length<a;l-=r)s.splice(1,0,l);return s}}static getNumRawDataModules(a){if(a<w.MIN_VERSION||a>w.MAX_VERSION)throw new RangeError("Version number out of range");let r=(16*a+128)*a+64;if(a>=2){const s=Math.floor(a/7)+2;r-=(25*s-10)*s-55,a>=7&&(r-=36)}return m(208<=r&&r<=29648),r}static getNumDataCodewords(a,r){return Math.floor(w.getNumRawDataModules(a)/8)-w.ECC_CODEWORDS_PER_BLOCK[r.ordinal][a]*w.NUM_ERROR_CORRECTION_BLOCKS[r.ordinal][a]}static reedSolomonComputeDivisor(a){if(a<1||a>255)throw new RangeError("Degree out of range");let r=[];for(let l=0;l<a-1;l++)r.push(0);r.push(1);let s=1;for(let l=0;l<a;l++){for(let n=0;n<r.length;n++)r[n]=w.reedSolomonMultiply(r[n],s),n+1<r.length&&(r[n]^=r[n+1]);s=w.reedSolomonMultiply(s,2)}return r}static reedSolomonComputeRemainder(a,r){let s=r.map(l=>0);for(const l of a){const n=l^s.shift();s.push(0),r.forEach((u,o)=>s[o]^=w.reedSolomonMultiply(u,n))}return s}static reedSolomonMultiply(a,r){if(a>>>8||r>>>8)throw new RangeError("Byte out of range");let s=0;for(let l=7;l>=0;l--)s=s<<1^(s>>>7)*285,s^=(r>>>l&1)*a;return m(s>>>8==0),s}finderPenaltyCountPatterns(a){const r=a[1];m(r<=this.size*3);const s=r>0&&a[2]==r&&a[3]==r*3&&a[4]==r&&a[5]==r;return(s&&a[0]>=r*4&&a[6]>=r?1:0)+(s&&a[6]>=r*4&&a[0]>=r?1:0)}finderPenaltyTerminateAndCount(a,r,s){return a&&(this.finderPenaltyAddHistory(r,s),r=0),r+=this.size,this.finderPenaltyAddHistory(r,s),this.finderPenaltyCountPatterns(s)}finderPenaltyAddHistory(a,r){r[0]==0&&(a+=this.size),r.pop(),r.unshift(a)}};c.MIN_VERSION=1,c.MAX_VERSION=40,c.PENALTY_N1=3,c.PENALTY_N2=3,c.PENALTY_N3=40,c.PENALTY_N4=10,c.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],c.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=c;function i(y,a,r){if(a<0||a>31||y>>>a)throw new RangeError("Value out of range");for(let s=a-1;s>=0;s--)r.push(y>>>s&1)}function d(y,a){return(y>>>a&1)!=0}function m(y){if(!y)throw new Error("Assertion error")}const g=class P{constructor(a,r,s){if(this.mode=a,this.numChars=r,this.bitData=s,r<0)throw new RangeError("Invalid argument");this.bitData=s.slice()}static makeBytes(a){let r=[];for(const s of a)i(s,8,r);return new P(P.Mode.BYTE,a.length,r)}static makeNumeric(a){if(!P.isNumeric(a))throw new RangeError("String contains non-numeric characters");let r=[];for(let s=0;s<a.length;){const l=Math.min(a.length-s,3);i(parseInt(a.substring(s,s+l),10),l*3+1,r),s+=l}return new P(P.Mode.NUMERIC,a.length,r)}static makeAlphanumeric(a){if(!P.isAlphanumeric(a))throw new RangeError("String contains unencodable characters in alphanumeric mode");let r=[],s;for(s=0;s+2<=a.length;s+=2){let l=P.ALPHANUMERIC_CHARSET.indexOf(a.charAt(s))*45;l+=P.ALPHANUMERIC_CHARSET.indexOf(a.charAt(s+1)),i(l,11,r)}return s<a.length&&i(P.ALPHANUMERIC_CHARSET.indexOf(a.charAt(s)),6,r),new P(P.Mode.ALPHANUMERIC,a.length,r)}static makeSegments(a){return a==""?[]:P.isNumeric(a)?[P.makeNumeric(a)]:P.isAlphanumeric(a)?[P.makeAlphanumeric(a)]:[P.makeBytes(P.toUtf8ByteArray(a))]}static makeEci(a){let r=[];if(a<0)throw new RangeError("ECI assignment value out of range");if(a<128)i(a,8,r);else if(a<16384)i(2,2,r),i(a,14,r);else if(a<1e6)i(6,3,r),i(a,21,r);else throw new RangeError("ECI assignment value out of range");return new P(P.Mode.ECI,0,r)}static isNumeric(a){return P.NUMERIC_REGEX.test(a)}static isAlphanumeric(a){return P.ALPHANUMERIC_REGEX.test(a)}getData(){return this.bitData.slice()}static getTotalBits(a,r){let s=0;for(const l of a){const n=l.mode.numCharCountBits(r);if(l.numChars>=1<<n)return 1/0;s+=4+n+l.bitData.length}return s}static toUtf8ByteArray(a){a=encodeURI(a);let r=[];for(let s=0;s<a.length;s++)a.charAt(s)!="%"?r.push(a.charCodeAt(s)):(r.push(parseInt(a.substring(s+1,s+3),16)),s+=2);return r}};g.NUMERIC_REGEX=/^[0-9]*$/,g.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,g.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let p=g;t.QrSegment=g})(te||(te={}));(t=>{(c=>{const i=class{constructor(m,g){this.ordinal=m,this.formatBits=g}};i.LOW=new i(0,1),i.MEDIUM=new i(1,0),i.QUARTILE=new i(2,3),i.HIGH=new i(3,2),c.Ecc=i})(t.QrCode||(t.QrCode={}))})(te||(te={}));(t=>{(c=>{const i=class{constructor(m,g){this.modeBits=m,this.numBitsCharCount=g}numCharCountBits(m){return this.numBitsCharCount[Math.floor((m+7)/17)]}};i.NUMERIC=new i(1,[10,12,14]),i.ALPHANUMERIC=new i(2,[9,11,13]),i.BYTE=new i(4,[8,16,16]),i.KANJI=new i(8,[8,10,12]),i.ECI=new i(7,[0,0,0]),c.Mode=i})(t.QrSegment||(t.QrSegment={}))})(te||(te={}));var re=te;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Ca={L:re.QrCode.Ecc.LOW,M:re.QrCode.Ecc.MEDIUM,Q:re.QrCode.Ecc.QUARTILE,H:re.QrCode.Ecc.HIGH},Ke=128,Be="L",qe="#FFFFFF",Qe="#000000",Ue=!1,He=1,wa=4,Sa=0,Ea=.1;function We(t,c=0){const i=[];return t.forEach(function(d,m){let g=null;d.forEach(function(p,y){if(!p&&g!==null){i.push(`M${g+c} ${m+c}h${y-g}v1H${g+c}z`),g=null;return}if(y===d.length-1){if(!p)return;g===null?i.push(`M${y+c},${m+c} h1v1H${y+c}z`):i.push(`M${g+c},${m+c} h${y+1-g}v1H${g+c}z`);return}p&&g===null&&(g=y)})}),i.join("")}function $e(t,c){return t.slice().map((i,d)=>d<c.y||d>=c.y+c.h?i:i.map((m,g)=>g<c.x||g>=c.x+c.w?m:!1))}function _a(t,c,i,d){if(d==null)return null;const m=t.length+i*2,g=Math.floor(c*Ea),p=m/c,y=(d.width||g)*p,a=(d.height||g)*p,r=d.x==null?t.length/2-y/2:d.x*p,s=d.y==null?t.length/2-a/2:d.y*p,l=d.opacity==null?1:d.opacity;let n=null;if(d.excavate){let o=Math.floor(r),x=Math.floor(s),h=Math.ceil(y+r-o),E=Math.ceil(a+s-x);n={x:o,y:x,w:h,h:E}}const u=d.crossOrigin;return{x:r,y:s,h:a,w:y,excavation:n,opacity:l,crossOrigin:u}}function Ma(t,c){return c!=null?Math.max(Math.floor(c),0):t?wa:Sa}function Ge({value:t,level:c,minVersion:i,includeMargin:d,marginSize:m,imageSettings:g,size:p,boostLevel:y}){let a=A.useMemo(()=>{const o=(Array.isArray(t)?t:[t]).reduce((x,h)=>(x.push(...re.QrSegment.makeSegments(h)),x),[]);return re.QrCode.encodeSegments(o,Ca[c],i,void 0,void 0,y)},[t,c,i,y]);const{cells:r,margin:s,numCells:l,calculatedImageSettings:n}=A.useMemo(()=>{let u=a.getModules();const o=Ma(d,m),x=u.length+o*2,h=_a(u,p,o,g);return{cells:u,margin:o,numCells:x,calculatedImageSettings:h}},[a,p,g,d,m]);return{qrcode:a,margin:s,cells:r,numCells:l,calculatedImageSettings:n}}var Pa=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Ra=A.forwardRef(function(c,i){const d=c,{value:m,size:g=Ke,level:p=Be,bgColor:y=qe,fgColor:a=Qe,includeMargin:r=Ue,minVersion:s=He,boostLevel:l,marginSize:n,imageSettings:u}=d,x=be(d,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:h}=x,E=be(x,["style"]),N=u==null?void 0:u.src,b=A.useRef(null),C=A.useRef(null),_=A.useCallback(L=>{b.current=L,typeof i=="function"?i(L):i&&(i.current=L)},[i]),[S,z]=A.useState(!1),{margin:O,cells:H,numCells:F,calculatedImageSettings:v}=Ge({value:m,level:p,minVersion:s,boostLevel:l,includeMargin:r,marginSize:n,imageSettings:u,size:g});A.useEffect(()=>{if(b.current!=null){const L=b.current,T=L.getContext("2d");if(!T)return;let Y=H;const W=C.current,V=v!=null&&W!==null&&W.complete&&W.naturalHeight!==0&&W.naturalWidth!==0;V&&v.excavation!=null&&(Y=$e(H,v.excavation));const ee=window.devicePixelRatio||1;L.height=L.width=g*ee;const X=g/F*ee;T.scale(X,X),T.fillStyle=y,T.fillRect(0,0,F,F),T.fillStyle=a,Pa?T.fill(new Path2D(We(Y,O))):H.forEach(function(j,q){j.forEach(function(ie,he){ie&&T.fillRect(he+O,q+O,1,1)})}),v&&(T.globalAlpha=v.opacity),V&&T.drawImage(W,v.x+O,v.y+O,v.w,v.h)}}),A.useEffect(()=>{z(!1)},[N]);const K=fe({height:g,width:g},h);let G=null;return N!=null&&(G=A.createElement("img",{src:N,key:N,style:{display:"none"},onLoad:()=>{z(!0)},ref:C,crossOrigin:v==null?void 0:v.crossOrigin})),A.createElement(A.Fragment,null,A.createElement("canvas",fe({style:K,height:g,width:g,ref:_,role:"img"},E)),G)});Ra.displayName="QRCodeCanvas";var Ye=A.forwardRef(function(c,i){const d=c,{value:m,size:g=Ke,level:p=Be,bgColor:y=qe,fgColor:a=Qe,includeMargin:r=Ue,minVersion:s=He,boostLevel:l,title:n,marginSize:u,imageSettings:o}=d,x=be(d,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:h,cells:E,numCells:N,calculatedImageSettings:b}=Ge({value:m,level:p,minVersion:s,boostLevel:l,includeMargin:r,marginSize:u,imageSettings:o,size:g});let C=E,_=null;o!=null&&b!=null&&(b.excavation!=null&&(C=$e(E,b.excavation)),_=A.createElement("image",{href:o.src,height:b.h,width:b.w,x:b.x+h,y:b.y+h,preserveAspectRatio:"none",opacity:b.opacity,crossOrigin:b.crossOrigin}));const S=We(C,h);return A.createElement("svg",fe({height:g,width:g,viewBox:`0 0 ${N} ${N}`,ref:i,role:"img"},x),!!n&&A.createElement("title",null,n),A.createElement("path",{fill:y,d:`M0,0 h${N}v${N}H0z`,shapeRendering:"crispEdges"}),A.createElement("path",{fill:a,d:S,shapeRendering:"crispEdges"}),_)});Ye.displayName="QRCodeSVG";const Aa=[{id:"appearance",labelKey:"settings.sections.appearance",icon:De},{id:"general",labelKey:"settings.sections.general",icon:ge},{id:"household",labelKey:"settings.sections.household",icon:je},{id:"budget",labelKey:"settings.sections.budget",icon:Ne},{id:"categories",labelKey:"settings.sections.categories",icon:ye},{id:"sources",labelKey:"settings.sections.sources",icon:ot},{id:"recurring",labelKey:"settings.sections.recurring",icon:Kt},{id:"notifications",labelKey:"settings.sections.notifications",icon:Fe},{id:"crypto",labelKey:"settings.sections.crypto",icon:Te},{id:"anomaly",labelKey:"anomaly.title",icon:Ce},{id:"export",labelKey:"settings.sections.export",icon:we}];function Ia(){var Se,Ee;const{t}=B("common"),c=ne(),[i,d]=f.useState("appearance"),[m,g]=f.useState(!1),[p,y]=f.useState(!1),[a,r]=f.useState(!1),[s,l]=f.useState(null),[n,u]=f.useState(null),[o,x]=f.useState(!1),[h,E]=f.useState(!1),[N,b]=f.useState(""),[C,_]=f.useState(!1),{data:S,isLoading:z}=Z({queryKey:["settings"],queryFn:dt}),{data:O}=Z({queryKey:["household-profile"],queryFn:At}),H=D({mutationFn:Rt,onSuccess:()=>{c.invalidateQueries({queryKey:["household-profile"]}),c.invalidateQueries({queryKey:["benchmark-comparison"]}),se.success(t("settings.profileSaved","Household profile saved successfully"))},onError:M=>{console.error("Failed to save household profile:",M),se.error(t("settings.profileSaveError","Failed to save household profile"))}}),[F,v]=f.useState("JPY"),[K,G]=f.useState(25),[L,T]=f.useState(!1),[Y,W]=f.useState(!0),[V,ee]=f.useState(1e6);f.useEffect(()=>{S&&(v(S.currency),G(S.base_date),T(S.budget_carry_over),W(S.budget_email_alerts),ee(S.large_transaction_threshold))},[S]),f.useEffect(()=>{if(S){const M=F!==S.currency||K!==S.base_date||L!==S.budget_carry_over||Y!==S.budget_email_alerts||V!==S.large_transaction_threshold;g(M)}},[F,K,L,Y,V,S]);const X=D({mutationFn:lt,onSuccess:()=>{c.invalidateQueries({queryKey:["settings"]}),c.invalidateQueries({queryKey:["dashboard-summary"]}),c.invalidateQueries({queryKey:["transactions"]}),c.invalidateQueries({queryKey:["analytics"]}),g(!1)},onError:M=>{console.error("Failed to save settings:",M)}}),j=()=>{X.mutate({currency:F,base_date:K,budget_carry_over:L,budget_email_alerts:Y,large_transaction_threshold:V})},q=async()=>{y(!0),r(!1);try{await Na(),r(!0),setTimeout(()=>r(!1),3e3)}catch{se.error(t("settings.export.error"))}finally{y(!1)}},ie=async()=>{x(!0),l(null),E(!1),_(!1);try{const M=await ja();l(M.url),u(new Date(M.expiresAt))}catch{se.error(t("settings.export.generateFailed","Failed to generate link"))}finally{x(!1)}},he=async()=>{if(s)try{await navigator.clipboard.writeText(s),E(!0),setTimeout(()=>E(!1),2e3)}catch{se.error(t("settings.export.copyFailed","Failed to copy link"))}};if(f.useEffect(()=>{if(!n)return;const M=setInterval(()=>{const le=new Date,oe=n.getTime()-le.getTime();if(oe<=0){b(""),_(!0),u(null),se.info(t("settings.export.linkExpired")),clearInterval(M);return}const Ve=Math.floor(oe/6e4),Xe=Math.floor(oe%6e4/1e3);b(t("settings.export.linkExpires",{minutes:Ve,seconds:Xe}))},1e3);return()=>clearInterval(M)},[n,t]),z)return e.jsx("div",{className:"flex justify-center py-12",children:e.jsx($,{size:"lg"})});const xe={JPY:t("settings.currencyJPY"),USD:t("settings.currencyUSD"),VND:t("settings.currencyVND")};return e.jsxs("div",{className:"min-h-screen pb-32",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-4",children:[e.jsxs("h1",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5 text-primary-600"}),t("settings.title")]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:t("settings.subtitle")})]}),e.jsx("div",{className:"border-t border-gray-100 dark:border-gray-800",children:e.jsx("div",{className:"max-w-2xl mx-auto px-4",children:e.jsx("div",{className:"flex gap-1 overflow-x-auto py-2 scrollbar-hide -mb-2",children:Aa.map(M=>{const le=M.icon,oe=i===M.id;return e.jsxs("button",{onClick:()=>d(M.id),className:k("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-all",oe?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"),children:[e.jsx(le,{className:"w-3.5 h-3.5"}),t(M.labelKey)]},M.id)})})})})]}),e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-4 space-y-4",children:[e.jsx("div",{className:k("space-y-4",i!=="appearance"&&"hidden"),children:e.jsx(ce,{icon:De,title:t("appearance.title","Appearance"),description:t("appearance.subtitle","Theme, colors, and display preferences"),children:e.jsx(pa,{})})}),e.jsx("div",{className:k("space-y-4",i!=="general"&&"hidden"),children:e.jsx(ce,{icon:ge,title:t("settings.general"),description:t("settings.generalDescription","Currency and basic preferences"),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(ue,{label:t("settings.currency"),value:F,onChange:M=>v(M.target.value),options:[{value:"JPY",label:xe.JPY},{value:"USD",label:xe.USD},{value:"VND",label:xe.VND}]}),e.jsx(Q,{type:"number",label:t("settings.payday"),value:K,onChange:M=>G(parseInt(M.target.value,10)),min:1,max:31}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 -mt-2",children:t("settings.paydayDescription")})]})})}),e.jsx("div",{className:k("space-y-4",i!=="household"&&"hidden"),children:e.jsx(ce,{icon:je,title:t("settings.householdProfile","Household Profile"),description:t("settings.householdProfileDescription","Family size, prefecture, and income bracket for spending benchmarks"),children:e.jsx(va,{profile:O||null,onSave:M=>H.mutate(M),isLoading:H.isPending})})}),e.jsx("div",{className:k("space-y-4",i!=="budget"&&"hidden"),children:e.jsx(ce,{icon:Ne,title:t("settings.budgetSettings"),description:t("settings.budgetDescription","Budget behavior and alerts"),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Re,{label:t("settings.budgetCarryOver"),description:t("settings.budgetCarryOverDescription"),checked:L,onChange:T}),e.jsx(Re,{label:t("settings.budgetEmailAlerts"),description:t("settings.budgetEmailAlertsDescription"),checked:Y,onChange:W}),e.jsxs("div",{className:"pt-2",children:[e.jsx("label",{className:"font-medium text-gray-900 dark:text-white block mb-2",children:t("settings.largeTransactionThreshold")}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:t("settings.largeTransactionThresholdDescription")}),e.jsx(Q,{type:"number",value:V,onChange:M=>ee(parseInt(M.target.value,10)||0),min:0,step:1e5}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:t("settings.largeTransactionThresholdHint")})]})]})})}),e.jsx("div",{className:k("space-y-4",i!=="categories"&&"hidden"),children:e.jsx(na,{})}),e.jsx("div",{className:k("space-y-4",i!=="sources"&&"hidden"),children:e.jsxs(ke,{title:t("settings.paymentSourceManagement"),badge:((Se=S==null?void 0:S.sources)==null?void 0:Se.length)||0,children:[e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:((Ee=S==null?void 0:S.sources)==null?void 0:Ee.map((M,le)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:M}),e.jsx("button",{className:"text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 text-sm",children:t("settings.delete")})]},le)))||e.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-center py-4",children:t("settings.noSources")})}),e.jsx("div",{className:"mt-4",children:e.jsx(R,{variant:"outline",children:t("settings.addSource")})})]})}),e.jsx("div",{className:k("space-y-4",i!=="recurring"&&"hidden"),children:e.jsx(bt,{})}),e.jsx("div",{className:k("space-y-4",i!=="notifications"&&"hidden"),children:e.jsx(ua,{})}),e.jsx("div",{className:k("space-y-4",i!=="crypto"&&"hidden"),children:e.jsx(ia,{})}),e.jsx("div",{className:k("space-y-4",i!=="anomaly"&&"hidden"),children:e.jsx(la,{})}),e.jsx("div",{className:k("space-y-4",i!=="export"&&"hidden"),children:e.jsx(ce,{icon:we,title:t("settings.export.title"),description:t("settings.export.description"),children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t("settings.export.instructions")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{onClick:q,disabled:p,className:"flex-1",size:"lg",children:p?e.jsxs(e.Fragment,{children:[e.jsx($,{size:"sm",className:"mr-2"}),t("settings.export.exporting")]}):e.jsxs(e.Fragment,{children:[e.jsx(It,{className:"w-4 h-4 mr-2"}),t("settings.export.button")]})}),e.jsx(R,{onClick:ie,disabled:o,variant:"outline",className:"flex-1",size:"lg",children:o?e.jsxs(e.Fragment,{children:[e.jsx($,{size:"sm",className:"mr-2"}),t("settings.export.generatingLink")]}):e.jsxs(e.Fragment,{children:[e.jsx(Lt,{className:"w-4 h-4 mr-2"}),t("settings.export.generateLink")]})})]}),a&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 dark:text-green-400",children:[e.jsx(de,{className:"w-4 h-4"}),t("settings.export.success")]}),s&&!C&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-green-600 dark:text-green-400",children:[e.jsx(ct,{className:"w-4 h-4"}),t("settings.export.linkGenerated")]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:s,className:"flex-1 px-3 py-2 text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-gray-100 select-all",onClick:M=>M.target.select()}),e.jsx(R,{onClick:he,variant:"outline",size:"sm",children:h?e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"w-4 h-4 mr-1"}),t("settings.export.linkCopied")]}):e.jsxs(e.Fragment,{children:[e.jsx(Mt,{className:"w-4 h-4 mr-1"}),t("settings.export.copyLink")]})})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:"p-3 bg-white rounded-lg",children:e.jsx(Ye,{value:s,size:180})}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t("settings.export.scanQR")})]}),N&&e.jsx("p",{className:"text-xs text-center text-amber-600 dark:text-amber-400",children:N})]}),C&&e.jsx("div",{className:"mt-4 p-4 bg-red-50 dark:bg-red-900/20 rounded-lg",children:e.jsx("p",{className:"text-sm text-center text-red-600 dark:text-red-400",children:t("settings.export.linkExpired")})})]})})}),e.jsx(ea,{})]}),m&&typeof document<"u"&&ve.createPortal(e.jsx("div",{className:"fixed bottom-20 left-0 right-0 p-4 bg-white/90 dark:bg-gray-900/90 backdrop-blur-lg border-t border-gray-200 dark:border-gray-700 z-40",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(R,{onClick:j,disabled:X.isPending,className:"w-full",size:"lg",children:X.isPending?e.jsxs(e.Fragment,{children:[e.jsx($,{size:"sm",className:"mr-2"}),t("saving")]}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),t("settings.saveSettings")]})})})}),document.body)]})}function ce({icon:t,title:c,description:i,children:d,className:m}){return e.jsxs(U,{className:k("",m),children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-primary-100 dark:bg-primary-900/30 rounded-lg",children:e.jsx(t,{className:"w-5 h-5 text-primary-600 dark:text-primary-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:c}),i&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:i})]})]}),d]})}function Re({label:t,description:c,checked:i,onChange:d}){return e.jsxs("div",{className:"flex items-start justify-between py-1",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("label",{className:"font-medium text-gray-900 dark:text-white block",children:t}),c&&e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-0.5",children:c})]}),e.jsx("button",{onClick:()=>d(!i),className:k("relative inline-flex h-7 w-12 items-center rounded-full transition-colors flex-shrink-0",i?"bg-primary-600":"bg-gray-300 dark:bg-gray-600"),children:e.jsx("span",{className:k("inline-block h-5 w-5 transform rounded-full bg-white transition-transform shadow-sm",i?"translate-x-6":"translate-x-1")})})]})}const rs=Je("/settings")({component:Ia});export{rs as Route};

import{l as h,u as b,J as N,r as k,D as _,a4 as u,j as r,C as g,F as y,R as x,m as n,q as w,T as R,ad as S,s as C}from"./index-DwQJXgIW.js";import{a as q,u as D,b as T}from"./recurring-service-Dt1R-JAR.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],M=h("pause",L);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Y=h("play",P),A={JPY:"Â¥"},E=["recurring.days.monday","recurring.days.tuesday","recurring.days.wednesday","recurring.days.thursday","recurring.days.friday","recurring.days.saturday","recurring.days.sunday"];function $(){const{t:a}=b("common"),c=N(),[i,d]=k.useState(null),{data:s,isLoading:m}=_({queryKey:["recurring-transactions"],queryFn:()=>T()}),p=u({mutationFn:q,onSuccess:()=>{c.invalidateQueries({queryKey:["recurring-transactions"]}),d(null)}}),l=u({mutationFn:({id:e,is_active:t})=>D(e,{is_active:t}),onSuccess:()=>{c.invalidateQueries({queryKey:["recurring-transactions"]})}}),f=e=>{confirm(a("confirmDelete","Are you sure you want to delete this?"))&&(d(e),p.mutate(e))},j=e=>{l.mutate({id:e.id,is_active:!e.is_active})},v=e=>{switch(e.frequency){case"weekly":const t=E[e.day_of_week??0];return`${a("recurring.weekly")} - ${a(t)}`;case"monthly":return`${a("recurring.monthly")} - ${a("recurring.dayOfMonthValue",{day:e.day_of_month??1})}`;case"yearly":return a("recurring.yearly");case"custom":return a("recurring.everyNDays",{n:e.interval_days??7});default:return e.frequency}},o=e=>e?new Date(e).toLocaleDateString(C()):"-";return m?r.jsxs(g,{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-6",children:a("recurring.title")}),r.jsx("div",{className:"flex justify-center py-8",children:r.jsx(y,{size:"md"})})]}):r.jsxs(g,{children:[r.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[r.jsx(x,{className:"w-5 h-5 text-blue-500"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a("recurring.title")})]}),s&&s.length>0?r.jsx("div",{className:"space-y-3",children:s.map(e=>r.jsx("div",{className:n("p-4 rounded-lg border transition-colors",e.is_active?"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700":"bg-gray-50 dark:bg-gray-900 border-gray-200 dark:border-gray-800 opacity-60"),children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:e.description}),r.jsx("span",{className:n("px-2 py-0.5 text-xs rounded-full",e.is_active?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400"),children:e.is_active?a("recurring.active"):a("recurring.inactive")})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 mt-1 text-sm text-gray-500 dark:text-gray-400",children:[r.jsxs("span",{className:"font-numbers",children:[e.is_income?"+":"-",A.JPY,Math.abs(e.amount).toLocaleString()]}),r.jsx("span",{children:e.category}),r.jsx("span",{children:v(e)})]}),r.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-gray-400 dark:text-gray-500",children:[r.jsx(w,{className:"w-3 h-3"}),r.jsxs("span",{children:[a("recurring.nextRun"),": ",o(e.next_run_date)]}),e.last_run_date&&r.jsxs("span",{className:"ml-3",children:[a("recurring.lastRun"),": ",o(e.last_run_date)]})]})]}),r.jsxs("div",{className:"flex items-center gap-1 ml-4",children:[r.jsx("button",{onClick:()=>j(e),disabled:l.isPending,className:n("p-2 rounded-lg transition-colors",e.is_active?"hover:bg-yellow-100 dark:hover:bg-yellow-900/30 text-yellow-600":"hover:bg-green-100 dark:hover:bg-green-900/30 text-green-600"),title:e.is_active?a("recurring.inactive"):a("recurring.active"),children:e.is_active?r.jsx(M,{className:"w-4 h-4"}):r.jsx(Y,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>f(e.id),disabled:i===e.id,className:"p-2 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/30 text-red-600 transition-colors",title:a("button.delete"),children:i===e.id?r.jsx(y,{size:"sm"}):r.jsx(R,{className:"w-4 h-4"})})]})]})},e.id))}):r.jsx(S,{compact:!0,icon:r.jsx(x,{}),title:a("emptyState.recurring.title","No recurring transactions"),description:a("emptyState.recurring.description","Set up automated tracking for regular expenses")})]})}export{Y as P,$ as R};
